<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="author" content="thoughtbot">
  <meta name="author" content="Jason Morrison">
  <meta name="author" content="Chad Pytel">
  <meta name="author" content="Nick Quaranto">
  <meta name="author" content="Harold Giménez">
  <meta name="author" content="Joshua Clayton">
  <meta name="author" content="Gabe Berke-Williams">
  <meta name="author" content="Chad Mazzola">
  <title>Backbone.js on Rails</title>
  <style type="text/css">code{white-space: pre;}</style>
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
</head>
<body>
<header>
<h1 class="title">Backbone.js on Rails</h1>
<h2 class="author">thoughtbot</h2>
<h2 class="author">Jason Morrison</h2>
<h2 class="author">Chad Pytel</h2>
<h2 class="author">Nick Quaranto</h2>
<h2 class="author">Harold Giménez</h2>
<h2 class="author">Joshua Clayton</h2>
<h2 class="author">Gabe Berke-Williams</h2>
<h2 class="author">Chad Mazzola</h2>
</header>
<nav id="TOC">
<ul>
<li><a href="#introduction">Introduction</a><ul>
<li><a href="#the-shift-to-client-side-web-applications">The shift to client-side web applications</a></li>
<li><a href="#goals-for-this-book">Goals for this book</a></li>
<li><a href="#alternatives-to-backbone">Alternatives to Backbone</a></li>
<li><a href="#the-example-application">The example application</a><ul>
<li><a href="#framework-and-library-choice-in-the-example-application">Framework and library choice in the example application</a></li>
</ul></li>
<li><a href="#conventions-used-in-this-book">Conventions used in this book</a></li>
</ul></li>
<li><a href="#getting-up-to-speed">Getting up to speed</a><ul>
<li><a href="#backbone-online-resources">Backbone online resources</a></li>
<li><a href="#javascript-resources">JavaScript resources</a></li>
</ul></li>
<li><a href="#organization">Organization</a><ul>
<li><a href="#backbone-and-mvc">Backbone and MVC</a></li>
<li><a href="#what-goes-where">What goes where</a></li>
<li><a href="#namespacing-your-application">Namespacing your application</a></li>
<li><a href="#mixins">Mixins</a></li>
</ul></li>
<li><a href="#rails-integration">Rails Integration</a><ul>
<li><a href="#organizing-your-backbone-code-in-a-rails-app">Organizing your Backbone code in a Rails app</a></li>
<li><a href="#rails-3.0-and-prior">Rails 3.0 and prior</a><ul>
<li><a href="#jammit-and-a-jst-naming-gotcha">Jammit and a JST naming gotcha</a></li>
</ul></li>
<li><a href="#rails-3.1-and-above">Rails 3.1 and above</a></li>
<li><a href="#an-overview-of-the-stack-connecting-rails-and-backbone">An overview of the stack: connecting Rails and Backbone</a><ul>
<li><a href="#setting-up-models">Setting up models</a></li>
<li><a href="#setting-up-rails-controllers">Setting up Rails controllers</a></li>
<li><a href="#setting-up-views">Setting Up Views</a></li>
</ul></li>
<li><a href="#customizing-your-rails-generated-json">Customizing your Rails-generated JSON</a><ul>
<li><a href="#activerecordbase.include_root_in_json">ActiveRecord::Base.include_root_in_json</a></li>
</ul></li>
<li><a href="#converting-an-existing-pageview-area-to-use-backbone">Converting an existing page/view area to use Backbone</a><ul>
<li><a href="#breaking-out-the-taskview">Breaking out the TaskView</a></li>
</ul></li>
<li><a href="#using-rails-url-helpers-from-backbone">Using Rails URL helpers from Backbone</a></li>
</ul></li>
<li><a href="#routers-views-and-templates">Routers, Views, and Templates</a><ul>
<li><a href="#view-explanation">View explanation</a><ul>
<li><a href="#initialization">Initialization</a></li>
<li><a href="#the-views-element">The View's element</a></li>
<li><a href="#customizing-the-views-element">Customizing the View's Element</a></li>
<li><a href="#rendering">Rendering</a></li>
<li><a href="#events">Events</a></li>
</ul></li>
<li><a href="#templating-strategy">Templating strategy</a></li>
<li><a href="#choosing-a-strategy">Choosing a strategy</a><ul>
<li><a href="#adding-backbone-to-existing-rails-views">Adding Backbone to existing Rails views</a></li>
<li><a href="#writing-new-backbone-functionality-from-scratch">Writing new Backbone functionality from scratch</a></li>
</ul></li>
<li><a href="#routers">Routers</a><ul>
<li><a href="#example-router">Example router</a></li>
<li><a href="#the-routes-hash">The routes hash</a></li>
<li><a href="#initializing-a-router">Initializing a router</a></li>
</ul></li>
<li><a href="#event-binding">Event binding</a><ul>
<li><a href="#binding-to-dom-events-within-the-view-element">Binding to DOM events within the view element</a></li>
<li><a href="#events-observed-by-your-view">Events observed by your view</a></li>
<li><a href="#events-your-view-publishes">Events your view publishes</a></li>
</ul></li>
<li><a href="#cleaning-up-unbinding">Cleaning up: unbinding</a><ul>
<li><a href="#why-unbind-events">Why unbind events?</a></li>
<li><a href="#unbinding-dom-events">Unbinding DOM events</a></li>
<li><a href="#backbones-listentto-and-stoplistening">Backbone's <code>listentTo</code> and <code>stopListening</code></a></li>
<li><a href="#unbinding-model-and-collection-events">Unbinding model and collection events</a></li>
<li><a href="#keep-track-of-on-calls-to-unbind-more-easily">Keep track of <code>on()</code> calls to unbind more easily</a></li>
<li><a href="#unbinding-view-triggered-events">Unbinding view-triggered events</a></li>
<li><a href="#establish-a-convention-for-consistent-and-correct-unbinding">Establish a convention for consistent and correct unbinding</a></li>
</ul></li>
<li><a href="#swapping-router">Swapping router</a><ul>
<li><a href="#swappingrouter-and-backbone-internals">SwappingRouter and Backbone internals</a></li>
</ul></li>
<li><a href="#composite-views">Composite views</a><ul>
<li><a href="#refactoring-from-a-large-view">Refactoring from a large view</a></li>
<li><a href="#cleaning-up-views-properly">Cleaning up views properly</a></li>
</ul></li>
<li><a href="#forms">Forms</a><ul>
<li><a href="#building-markup">Building markup</a></li>
<li><a href="#serializing-forms">Serializing forms</a></li>
<li><a href="#a-backbone-forms-library">A Backbone forms library</a></li>
<li><a href="#display-server-errors">Display server errors</a></li>
</ul></li>
<li><a href="#internationalization">Internationalization</a></li>
</ul></li>
<li><a href="#models-and-collections">Models and collections</a><ul>
<li><a href="#filters-and-sorting">Filters and sorting</a></li>
<li><a href="#modifying-collections-in-place">Modifying collections in-place</a></li>
<li><a href="#filtering">Filtering</a></li>
<li><a href="#propagating-collection-changes">Propagating collection changes</a><ul>
<li><a href="#a-note-on-event-bindings-and-reference-leaks">A note on event bindings and reference leaks</a></li>
</ul></li>
<li><a href="#sorting">Sorting</a></li>
<li><a href="#validations">Validations</a></li>
<li><a href="#model-relationships">Model relationships</a></li>
<li><a href="#backbone-relational-plugin">Backbone-relational plugin</a></li>
<li><a href="#relations-in-the-task-app">Relations in the task app</a></li>
<li><a href="#deciding-how-to-deliver-data-to-the-client">Deciding how to deliver data to the client</a></li>
<li><a href="#designing-the-http-json-api">Designing the HTTP JSON API</a></li>
<li><a href="#implementing-the-api-presenting-the-json">Implementing the API: presenting the JSON</a></li>
<li><a href="#parsing-the-json-and-instantiating-client-side-models">Parsing the JSON and instantiating client-side models</a></li>
<li><a href="#when-to-fetch-deferred-data">When to fetch deferred data</a></li>
<li><a href="#complex-nested-models">Complex nested models</a></li>
<li><a href="#composite-models">Composite models</a></li>
<li><a href="#accepts_nested_attributes_for"><code>accepts_nested_attributes_for</code></a></li>
<li><a href="#example-for-accepts_nested_attributes_for">Example for <code>accepts_nested_attributes_for</code></a></li>
<li><a href="#duplicating-business-logic-across-the-client-and-server">Duplicating business logic across the client and server</a><ul>
<li><a href="#an-example-model-validations">An example: model validations</a></li>
<li><a href="#kinds-of-logic-you-duplicate">Kinds of logic you duplicate</a></li>
<li><a href="#validations-1">Validations</a></li>
<li><a href="#querying">Querying</a></li>
<li><a href="#callbacks">Callbacks</a></li>
<li><a href="#algorithms">Algorithms</a></li>
</ul></li>
<li><a href="#synchronizing-between-clients">Synchronizing between clients</a><ul>
<li><a href="#the-moving-parts">The moving parts</a></li>
<li><a href="#putting-it-together-a-look-at-the-life-cycle-of-a-change">Putting it together: A look at the life cycle of a change</a></li>
<li><a href="#implementation-step-1-faye-server">Implementation: Step 1, Faye server</a></li>
<li><a href="#implementing-it-step-2-activerecord-observers">Implementing it: Step 2, ActiveRecord observers</a></li>
<li><a href="#implementing-it-step-3-in-browser-subscribers">Implementing it: Step 3, In-browser subscribers</a></li>
<li><a href="#testing-synchronization">Testing synchronization</a></li>
<li><a href="#further-reading">Further reading</a></li>
</ul></li>
<li><a href="#uploading-attachments">Uploading attachments</a><ul>
<li><a href="#saving-files-along-with-attributes">Saving files along with attributes</a></li>
<li><a href="#separating-file-upload-and-model-persistence">Separating file upload and model persistence</a></li>
<li><a href="#example-step-1-upload-interface">Example, Step 1: Upload interface</a></li>
<li><a href="#example-step-2-accept-and-persist-uploads-in-rails">Example, Step 2: Accept and persist uploads in Rails</a></li>
<li><a href="#example-step-3-display-uploaded-files">Example, Step 3: Display Uploaded Files</a></li>
</ul></li>
</ul></li>
<li><a href="#testing">Testing</a><ul>
<li><a href="#full-stack-integration-testing">Full-stack integration testing</a><ul>
<li><a href="#introduction-1">Introduction</a></li>
<li><a href="#capybara">Capybara</a></li>
<li><a href="#cucumber">Cucumber</a></li>
<li><a href="#drivers">Drivers</a></li>
</ul></li>
<li><a href="#isolated-unit-testing">Isolated unit testing</a><ul>
<li><a href="#isolation-testing-in-javascript">Isolation testing in JavaScript</a></li>
<li><a href="#what-to-test">What to test?</a></li>
<li><a href="#helpful-tools">Helpful Tools</a></li>
</ul></li>
<li><a href="#example-test-driving-a-task-application">Example: Test-driving a task application</a><ul>
<li><a href="#setup">Setup</a></li>
<li><a href="#step-by-step">Step by step</a></li>
</ul></li>
</ul></li>
<li><a href="#security">Security</a><ul>
<li><a href="#encoding-data-when-bootstrapping-json-data">Encoding data when bootstrapping JSON data</a></li>
</ul></li>
<li><a href="#application-structure">Application Structure</a><ul>
<li><a href="#structuring-larger-backbone-applications">Structuring larger Backbone applications</a></li>
</ul></li>
</ul>
</nav>
<p></p>
<section id="introduction" class="level1">
<h1><a href="#introduction">Introduction</a></h1>
<section id="the-shift-to-client-side-web-applications" class="level2">
<h2><a href="#the-shift-to-client-side-web-applications">The shift to client-side web applications</a></h2>
<p>Modern web applications have become increasingly rich, shifting their complexity onto the client side. While there are very well-understood approaches embodied in mature frameworks to organize server-side code, frameworks for organizing your client-side code are newer and generally still emerging. Backbone is one such library that provides a set of structures to help you organize your JavaScript code.</p>
<p>Libraries like jQuery have done a great deal to help abstract inconsistencies across browsers and provide a high-level API for making AJAX requests and performing DOM manipulation, but larger and richer client-side applications that lack decoupled and modular organizational structures often fall victim to the same few kinds of technical debt.</p>
<p>These apps are often highly asynchronous and the &quot;path of least resistance&quot; implementation is often to have deeply nested callbacks to describe asynchronous behavior, with nested Ajax calls and success/failure conditional concerns going several layers deep.</p>
<p>Rich client-side applications almost always involve a layer of state and logic on the client side. One way to implement this is to store domain objects or business logic state in the DOM. However, storing state in the DOM, stashing your application's data in hidden <code>&lt;div&gt;</code> elements that you clone, graft, and toggle into and out of view, or reading and writing to lengthy sets of HTML <code>data-*</code> attributes can quickly get cumbersome and confusing.</p>
<p>A third common feature in rich client-side apps is the presentation of multiple views on a single domain object. Consider a web conferencing application with multiple views on the members of your contact list - each contact is rendered in brief inside a list view, and in more specificity in a detail view. Additionally, your conference call history includes information about the people who participated. Each time an individual contact's information changes, this information needs to cascade to all the view representations.</p>
<p>This often leads to a tight coupling of persistence and presentation: invoking <code>$.ajax</code> to save a user's update and then updating several specific DOM elements upon success.</p>
<p>By separating business logic, persistence, and presentation concerns, and providing a decoupled, event-driven way to cascade changes through a system of observers, each module of code is more well-encapsulated and expresses a cohesive set of responsibilities without being coupled to outside concerns. Your application code becomes easier to test, modify, and extend, and you can better manage its complexity while its feature set grows.</p>
<p>Granted, you can thoughtfully organize your code in a clean, coherent manner without using an external library. However, using a library like Backbone helps you get started more quickly, reduces the number of decisions to make, and provides a common vocabulary for your team members or open source contributors.</p>
<p>If you're coming from a Rails background, you understand that a large part of Rails' value is expressing and implementing highly-opinionated conventions that guide development decisions. Backbone doesn't do this. Instead of trying to serve as &quot;the one way,&quot; or an opinionated framework like Rails, Backbone provides a set of structures that help you organize your application by building your own framework with its own set of conventions.</p>
</section>
<section id="goals-for-this-book" class="level2">
<h2><a href="#goals-for-this-book">Goals for this book</a></h2>
<p>This book aims to cover topics that are of interest when integrating Backbone into a Rails application. The primary Backbone documentation is quite good, and concisely readable. While we'll touch on introductory topics when they are critical to understand the points at hand, this book does not aim to provide an introduction to Backbone, and generally assumes the reader can lean on the Backbone documentation to explain the details of some concepts.</p>
<p>This book also does not aim to provide a comprehensive mapping of all possible solutions to problem domains, but rather to describe the best approaches we have found for solving problems and organizing applications using both Rails and Backbone.</p>
</section>
<section id="alternatives-to-backbone" class="level2">
<h2><a href="#alternatives-to-backbone">Alternatives to Backbone</a></h2>
<p>Web applications are pushing an increasing amount of responsibility to the client. The user experience can be quite enjoyable, but deeply nesting callbacks and relying on the DOM for app state are not. Fortunately, there is a host of new JavaScript client-side frameworks blossoming, and you have no shortage of options.</p>
<p>Knockout and Angular support declarative view-bindings and the Model-View-View Model (MVVM) pattern. Cappuccino and SproutCore deliver a rich library of UI controls for building desktop-like applications. JavaScriptMVC provides quite a bit of structure, including dependency management and build tools. Spine is perhaps the most similar to Backbone, but takes an opinionated stance to emphasize completely asynchronous client-server interactions for a faster user experience. Ember, originally a SproutCore rewrite, provides a host of conventions including two-way bindings, computed properties, and auto-updating templates.</p>
<p>Backbone favors a pared-down and flexible approach. The code you write ends up feeling very much like plain JavaScript. Although you will need to write some of your own conventions, Backbone is built to be easy to change: the source is small, well annotated, and modularly designed. It is small and flexible enough to smoothly introduce into an existing application, but provides enough convention and structure to help you organize your JavaScript. Additionally, a growing community of users brings with it a rich ecosystem of plugins, blog articles, and support.</p>
</section>
<section id="the-example-application" class="level2">
<h2><a href="#the-example-application">The example application</a></h2>
<p>The example application is a classic todo item manager. This is a popular example, and for good reason: The concepts and domain are familiar, and room is left to explore interesting implementations like deferred loading and file attachment.</p>
<p>While the example application is based on the content of the book, it represents the <em>finished</em> state of a lot of concepts discussed in the book. So, while we show some concepts in the book and break them down, the example application may then use a plugin that encapsulates that idea or is more officially supported. The book is not meant to be a walk through of the contents of <code>example_app</code>. Instead, <code>example_app</code> is intended to be a standalone reference in and of itself, while being related to the book.</p>
<p>We did this intentionally so that the book can be a standalone reference rather than being a sequential read that must be understood in sequence.</p>
<section id="framework-and-library-choice-in-the-example-application" class="level3">
<h3><a href="#framework-and-library-choice-in-the-example-application">Framework and library choice in the example application</a></h3>
<p>The application uses Rails 3.2.13 and Ruby 1.9.3. We provide a <code>Gemfile</code> and a <code>.ruby-version</code> file in the root of the example app that help define these versions, and the other dependencies of the app.</p>
<p>The included JavaScript libraries are non-minified for readability. This is a general good practice, and the Rails asset pipeline will properly package the assets for production.</p>
<p>While Rails provides the ability to write in CoffeeScript, we have decided to make all of the example code normal JavaScript so as to reduce the number of new things introduced at once.</p>
<p>The example application comes with a full test suite. The README in the <code>example_app</code> root directory has instructions for bootstrapping the app and running all the tests.</p>
</section>
</section>
<section id="conventions-used-in-this-book" class="level2">
<h2><a href="#conventions-used-in-this-book">Conventions used in this book</a></h2>
<p>In code samples throughout the book, we include filenames where helpful to give a sense of typical application structure. These filenames do not always correspond to a file in the example application. When they are included in the example application, sometimes the inline examples differ from the example application to illustrate a particular point.</p>
<p></p>
</section>
</section>
<section id="getting-up-to-speed" class="level1">
<h1><a href="#getting-up-to-speed">Getting up to speed</a></h1>
<section id="backbone-online-resources" class="level2">
<h2><a href="#backbone-online-resources">Backbone online resources</a></h2>
<p>This book is not an introduction, and assumes you have some knowledge of Javascript and of Backbone. Fortunately, there is solid documentation available to get you up to speed on Backbone.</p>
<p>The online documentation for Backbone is very readable:</p>
<p><a href="http://documentcloud.github.com/backbone/">http://documentcloud.github.com/backbone/</a></p>
<p>The GitHub wiki for Backbone links to a large number of tutorials and examples:</p>
<p><a href="https://github.com/documentcloud/backbone/wiki/Tutorials%2C-blog-posts-and-example-sites">https://github.com/documentcloud/backbone/wiki/Tutorials%2C-blog-posts-and-example-sites</a></p>
<p>PeepCode has produced a three-part series on getting up to speed on Backbone:</p>
<p><a href="http://peepcode.com/products/backbone-js">http://peepcode.com/products/backbone-js</a></p>
<p>Finally, Nick Gauthier and Chris Strom have published an ebook with several real-world examples they have extracted from production code:</p>
<p><a href="http://recipeswithbackbone.com/">http://recipeswithbackbone.com/</a></p>
</section>
<section id="javascript-resources" class="level2">
<h2><a href="#javascript-resources">JavaScript resources</a></h2>
<p><em>JavaScript: The Good Parts</em> by Douglas Crockford is highly recommended for any JavaScript developer.</p>
<p><em>Test-Driven JavaScript Development</em> by Christian Johansen teaches not only the ins and outs of how to test-drive your code, but also covers good fundamental JavaScript development practices and takes a deep dive on language fundamentals.</p>
<p>Finally, <em>JavaScript Web Applications</em> by Alex MacCaw provides broad and thorough coverage on developing well-organized client side applications.</p>
<p></p>
</section>
</section>
<section id="organization" class="level1">
<h1><a href="#organization">Organization</a></h1>
<section id="backbone-and-mvc" class="level2">
<h2><a href="#backbone-and-mvc">Backbone and MVC</a></h2>
<p>Model–View–Controller (MVC) is a software architectural pattern used in many applications to isolate domain or business logic (the application logic for the user) from the user interface (input and presentation).</p>
<figure>
<img src="data:image/png;base64,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" alt="Model-View-Controller concept" /><figcaption>Model-View-Controller concept</figcaption>
</figure>
<p>In the above diagram, a solid line represents a direct association and a dashed line represents an indirect association, such as one mediated by an observer.</p>
<p>As a user of Rails, you're likely already familiar with the concept of MVC and the benefits that the separation of concerns can provide. However, Rails itself is, technically, not traditional MVC, but a pattern called <a href="http://en.wikipedia.org/wiki/Model2">Model2</a>. A traditional MVC is event-based, and views are bound directly to models as observers, updating themselves when the model changes.</p>
<p>Given that Javascript has events, and that much of the interactions between the different components of Backbone in the browser are not limited to request/response, Backbone can be structured as an actual MVC architecture.</p>
<p>That said, technically speaking, Backbone is <em>not</em> MVC, and Backbone acknowledged this when it renamed &quot;Controllers&quot; to &quot;Routers&quot; in version 0.5.0.</p>
<p>What is Backbone then, if not MVC? Classically, views handled the presentation of information, and controllers would take the user input and decide what to do with it. In Backbone, these two concerns are merged into view classes, which are responsible for presentation as well as both establishing and responding to UI event bindings.</p>
</section>
<section id="what-goes-where" class="level2">
<h2><a href="#what-goes-where">What goes where</a></h2>
<p>Part of the initial learning curve of Backbone can be figuring out what goes where, and mapping it to expectations set by working with Rails. In Rails we have Models, Views, Controllers, and Routers. In Backbone, we have Models, Collections, Views, Templates, and Routers.</p>
<p>It's important to note that, although Rails and Backbone share several concept names, several of which have significant overlap, you shouldn't try to map your understanding of one directly onto the other. That said, it's valuable to draw similarities to help ease the learning curve.</p>
<p>The models in Backbone and Rails are fairly analogous - each represent objects in your domain, and both mix the concerns of domain logic with persistence. In Rails, the persistence is usually made to a database, and in Backbone.js it's generally made to a remote HTTP JSON API.</p>
<p>Backbone collections are just ordered sets of models. Because it lacks controllers, Backbone routers and views work together to pick up the functionality provided by Rails controllers. Finally, in Rails, when we say &quot;views,&quot; we actually mean &quot;templates,&quot; as Rails does not provide for view classes out of the box. In Backbone, however, you have a separation between the view class and the HTML templates that they use.</p>
<p>Once you introduce Backbone into your application, you grow the layers in your stack by four levels. This can be daunting at first, and frankly, at times it can be difficult to keep straight everything that's going on in your application. Ultimately, though, the additional organization and functionality of Backbone outweighs the costs - let's break it down.</p>
<p>| Rails | |------------| | Model | | Controller | | View |</p>
<p>| Backbone | |----------------------| | Model and Collection | | Router | | View | | Template |</p>
<p>In a typical Rails and Backbone application, the initial interaction between the layers will be as follows:</p>
<ul>
<li>A request from a user comes in; the <strong>Rails router</strong> identifies what should handle the request, based on the URL</li>
<li>The <strong>Rails controller action</strong> to handle the request is called; some initial processing may be performed</li>
<li>The <strong>Rails view template</strong> is rendered and returned to the user's browser</li>
<li>The <strong>Rails view template</strong> will include <strong>Backbone initialization</strong>; usually this is populating some <em>Backbone collections</em> as sets of <strong>Backbone models</strong> with JSON data provided by the <strong>Rails view</strong></li>
<li>The <strong>Backbone router</strong> determines which of its methods should handle the display, based on the URL</li>
<li>The <strong>Backbone router</strong> calls that method; some initial processing may be performed, and one or more <strong>Backbone views</strong> are rendered</li>
<li>The <strong>Backbone view</strong> reads <strong>templates</strong> and uses <strong>Backbone</strong> models to render itself onto the page</li>
</ul>
<p>At this point, the user will see your application in their browser and be able to interact with it. The user interacting with elements on the page will trigger actions to be taken at any level of the above sequence: <strong>Backbone model</strong>, <strong>Backbone views</strong>, <strong>Backbone routers</strong>, or requests to the remote server.</p>
<p>Requests to the remote server may be any one of the following:</p>
<ul>
<li>Normal requests that don't hit Backbone and trigger a full page reload</li>
<li>Normal Ajax requests, not using Backbone at all</li>
<li>Ajax requests from the <strong>Backbone model</strong> or <strong>Backbone collection</strong>, communicating with Rails via JSON</li>
</ul>
<p>Generally speaking, by introducing Backbone into our application we'll reduce the first two types of requests, moving the bulk of client/server interaction to requests encapsulated inside domain objects like Backbone models.</p>
</section>
<section id="namespacing-your-application" class="level2">
<h2><a href="#namespacing-your-application">Namespacing your application</a></h2>
<p>You will want to create an object in JavaScript in which your Backbone application will reside. This variable will serve as a namespace for your Backbone application. Namespacing all of the JavaScript is desirable to avoid potential collisions in naming. For example, it's possible that a JavaScript library you want to use might also create a task variable. If you haven't namespaced your task model, this would conflict.</p>
<p>This variable includes a place to hold models, collections, views, and routes, and an <code>initialize</code> function which will be called to initialize the application.</p>
<p>Typically, initializing your application will involve creating a router and starting Backbone history to route the initial URL fragment. This app variable will look like the following:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/example_app.js</span>
<span class="kw">var</span> ExampleApp = {
  <span class="dt">Models</span>: {},
  <span class="dt">Collections</span>: {},
  <span class="dt">Views</span>: {},
  <span class="dt">Routers</span>: {},
  <span class="dt">initialize</span>: <span class="kw">function</span>() {
    <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Routers</span>.<span class="fu">Tasks</span>();
    <span class="ot">Backbone</span>.<span class="ot">history</span>.<span class="fu">start</span>();
  }
};</code></pre>
<p>You can find a more fully fleshed-out version of this file in the example app in <code>app/assets/javascripts/example_app.js</code>.</p>
</section>
<section id="mixins" class="level2">
<h2><a href="#mixins">Mixins</a></h2>
<p>Backbone provides a basic mechanism for inheritance. Sometimes, you'll want to build a collection of related, reusable behavior and include that in several classes that already inherit from a Backbone base class. In these cases, you'll want to use a <a href="http://en.wikipedia.org/wiki/Mixin">mixin</a>.</p>
<p>Backbone includes <a href="http://documentcloud.github.com/backbone/#Events">Backbone.Events</a> as an example of a mixin.</p>
<p>Here, we create a mixin named <code>Observer</code> that contains behavior for binding to events in a fashion that can be cleaned up later:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/observer.js</span>
<span class="kw">var</span> Observer = {
  <span class="dt">bindTo</span>: <span class="kw">function</span>(source, event, callback) {
    <span class="ot">source</span>.<span class="fu">on</span>(event, callback, <span class="kw">this</span>);
    <span class="kw">this</span>.<span class="fu">bindings</span> = <span class="kw">this</span>.<span class="fu">bindings</span> || [];
    <span class="kw">this</span>.<span class="ot">bindings</span>.<span class="fu">push</span>({ <span class="dt">source</span>: source, <span class="dt">event</span>: event, <span class="dt">callback</span>: callback });
  },

  <span class="dt">unbindFromAll</span>: <span class="kw">function</span>() {
    <span class="ot">_</span>.<span class="fu">each</span>(<span class="kw">this</span>.<span class="fu">bindings</span>, <span class="kw">function</span>(binding) {
      <span class="ot">binding</span>.<span class="ot">source</span>.<span class="fu">off</span>(<span class="ot">binding</span>.<span class="fu">event</span>, <span class="ot">binding</span>.<span class="fu">callback</span>);
    });
    <span class="kw">this</span>.<span class="fu">bindings</span> = [];
  }
};</code></pre>
<p>We can mix <code>Observer</code> into a class by using Underscore.js' <code>_.extend</code> on the prototype of that class:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/some_collection_view.js</span>
SomeCollectionView = <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">extend</span>({
  <span class="dt">initialize</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="fu">bindTo</span>(<span class="kw">this</span>.<span class="fu">collection</span>, <span class="st">&quot;change&quot;</span>, <span class="kw">this</span>.<span class="fu">render</span>);
  },

  <span class="dt">leave</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="fu">unbindFromAll</span>(); <span class="co">// calling a method defined in the mixin</span>
    <span class="kw">this</span>.<span class="fu">remove</span>();
  }
});

<span class="ot">_</span>.<span class="fu">extend</span>(<span class="ot">SomeCollectionView</span>.<span class="fu">prototype</span>, Observer);</code></pre>
<p></p>
</section>
</section>
<section id="rails-integration" class="level1">
<h1><a href="#rails-integration">Rails Integration</a></h1>
<section id="organizing-your-backbone-code-in-a-rails-app" class="level2">
<h2><a href="#organizing-your-backbone-code-in-a-rails-app">Organizing your Backbone code in a Rails app</a></h2>
<p>When using Backbone in a Rails app, you'll have two kinds of Backbone-related assets: classes and templates.</p>
</section>
<section id="rails-3.0-and-prior" class="level2">
<h2><a href="#rails-3.0-and-prior">Rails 3.0 and prior</a></h2>
<p>With Rails 3.0 and prior, store your Backbone classes in <code>public/javascripts</code>:</p>
<pre><code>public/
  javascripts/
    jquery.js
    jquery-ui.js
    collections/
      users.js
      todos.js
    models/
      user.js
      todo.js
    routers/
      users_router.js
      todos_router.js
    views/
      users/
        users_index.js
        users_new.js
        users_edit.js
      todos/
        todos_index.js</code></pre>
<p>If you are using templates, we prefer storing them in <code>app/templates</code> to keep them separated from the server views:</p>
<pre><code>app/
  views/
    pages/
      home.html.erb
      terms.html.erb
      privacy.html.erb
      about.html.erb
  templates/
    users/
      index.jst
      new.jst
      edit.jst
    todos/
      index.jst
      show.jst</code></pre>
<p>On Rails 3.0 and prior apps, we use Jammit for packaging assets and precompiling templates:</p>
<p><a href="http://documentcloud.github.com/jammit/">http://documentcloud.github.com/jammit/</a></p>
<p><a href="http://documentcloud.github.com/jammit/#jst">http://documentcloud.github.com/jammit/#jst</a></p>
<p>Jammit will make your templates available in a top-level JST object. For example, to access the above todos/index.jst template, you would refer to it as:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript">JST[<span class="st">'todos/index'</span>]</code></pre>
<p>Variables can be passed to the templates by passing a Hash to the template, as shown below.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript">JST[<span class="st">'todos/index'</span>]({ <span class="dt">model</span>: <span class="kw">this</span>.<span class="fu">model</span> })</code></pre>
<section id="jammit-and-a-jst-naming-gotcha" class="level3">
<h3><a href="#jammit-and-a-jst-naming-gotcha">Jammit and a JST naming gotcha</a></h3>
<p>One issue with Jammit that we've encountered and worked around is that the JST template path can change when adding new templates. Let's say you place templates in <code>app/templates</code>. You work for a while on the &quot;Tasks&quot; feature, placing templates under <code>app/templates/tasks</code>. So, <code>window.JST</code> looks something like:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">window</span>.<span class="fu">JST</span> == {
  <span class="st">&quot;form&quot;</span>:  <span class="st">&quot;html for template...&quot;</span>,
  <span class="st">&quot;show&quot;</span>:  <span class="st">&quot;html for template...&quot;</span>,
  <span class="st">&quot;index&quot;</span>: <span class="st">&quot;html for template...&quot;</span>,
};</code></pre>
<p>Now, you add another directory under <code>app/templates</code>, say <code>app/templates/user</code>. Now, templates with colliding names in JST references are prefixed with their parent directory name so they are unambiguous:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">window</span>.<span class="fu">JST</span> == {
  <span class="st">&quot;form&quot;</span>:        <span class="st">&quot;html...&quot;</span>, <span class="co">// from tasks/form.jst.ejs</span>
  <span class="st">&quot;tasks/show&quot;</span>:  <span class="st">&quot;html...&quot;</span>,
  <span class="st">&quot;tasks/index&quot;</span>: <span class="st">&quot;html...&quot;</span>,
  <span class="st">&quot;new&quot;</span>:         <span class="st">&quot;html...&quot;</span>, <span class="co">// from users/new.jst.ejs</span>
  <span class="st">&quot;users/show&quot;</span>:  <span class="st">&quot;html...&quot;</span>,
  <span class="st">&quot;users/index&quot;</span>: <span class="st">&quot;html...&quot;</span>,
};</code></pre>
<p>This breaks existing JST references. You can work around this issue by applying the following monkeypatch to Jammit, in <code>config/initializers/jammit.rb</code>:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="dt">Jammit</span>::<span class="dt">Compressor</span>.class_eval <span class="kw">do</span>
  <span class="kw">private</span>
  <span class="kw">def</span> find_base_path(path)
    <span class="dt">File</span>.expand_path(<span class="dt">Rails</span>.root.join(<span class="st">'app'</span>,<span class="st">'templates'</span>))
  <span class="kw">end</span>
<span class="kw">end</span></code></pre>
<p>As applications are moving to Rails 3.1 or above, they're also moving to Sprockets for the asset packager. Until then, many apps are using Jammit for asset packaging. We have an open issue and workaround:</p>
<p><a href="https://github.com/documentcloud/jammit/issues/192">https://github.com/documentcloud/jammit/issues/192</a></p>
</section>
</section>
<section id="rails-3.1-and-above" class="level2">
<h2><a href="#rails-3.1-and-above">Rails 3.1 and above</a></h2>
<p>Rails 3.1 introduced the <a href="http://guides.rubyonrails.org/asset_pipeline.html">asset pipeline</a>, which uses the <a href="http://getsprockets.org">Sprockets library</a> for preprocessing and packaging assets.</p>
<p>To take advantage of the built-in asset pipeline, organize your Backbone templates and classes in paths available to it: classes go in <code>app/assets/javascripts/</code>, and templates go alongside, in <code>app/assets/templates/</code>:</p>
<pre><code>app/
  assets/
    javascripts/
      collections/
        todos.js
      models/
        todo.js
      routers/
        todos_router.js
      views/
        todos/
          todos_index.js
    templates/
      todos/
        index.jst.ejs
        show.jst.ejs</code></pre>
<p>In Rails 3.1 and above, jQuery is provided by the <code>jquery-rails</code> gem, and no longer needs to be included in your directory structure.</p>
<p>Using Sprockets' preprocessors, we can use templates as before. Here, we're using the EJS template preprocessor to provide the same functionality as Underscore.js' templates. It compiles the <code>*.jst</code> files and makes them available on the client side via the <code>window.JST</code> object. Identifying the <code>.ejs</code> extension and invoking EJS to compile the templates is managed by Sprockets, and requires the <code>ejs</code> gem to be included in the application Gemfile.</p>
<blockquote>
<p>Underscore.js templates: <a href="http://documentcloud.github.com/underscore/#template">http://documentcloud.github.com/underscore/#template</a></p>
<p>EJS gem: <a href="https://github.com/sstephenson/ruby-ejs">https://github.com/sstephenson/ruby-ejs</a></p>
<p>Sprockets support for EJS: <a href="https://github.com/sstephenson/sprockets/blob/master/lib/sprockets/ejs_template.rb">https://github.com/sstephenson/sprockets/blob/master/lib/sprockets/ejs_template.rb</a></p>
</blockquote>
<p>To make the <code>*.jst</code> files available and create the <code>window.JST</code> object, require them in your application.js Sprockets manifest:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/application.js</span>

<span class="co">// other application requires</span>
<span class="co">//= require_tree ../templates</span>
<span class="co">//= require_tree .</span></code></pre>
<p>Load order for Backbone and your Backbone app is very important. jQuery and Underscore must be loaded before Backbone. Then your models must be loaded before your collections (because your collections will reference your models) and then your routers and views must be loaded.</p>
<p>Fortunately, Sprockets can handle this load order for us. When all is said and done, your application.js Sprockets manifest will look as shown below:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"># app/assets/javascripts/<span class="ot">application</span>.<span class="fu">js</span>
<span class="co">//= require jquery</span>
<span class="co">//= require jquery_ujs</span>
<span class="co">//= require jquery-ui-1.8.18.custom.min</span>
<span class="co">//</span>
<span class="co">//= require underscore</span>
<span class="co">//= require json2</span>
<span class="co">//= require backbone</span>
<span class="co">//= require backbone-support</span>
<span class="co">//</span>
<span class="co">//= require backbone-forms.js</span>
<span class="co">//= require jquery-ui-editors.js</span>
<span class="co">//= require uploader.js</span>
<span class="co">//</span>
<span class="co">//= require vendor/visualsearch.js</span>
<span class="co">//</span>
<span class="co">//= require example_app</span>
<span class="co">//</span>
<span class="co">//= require_tree ./models</span>
<span class="co">//= require_tree ./collections</span>
<span class="co">//= require_tree ./views</span>
<span class="co">//= require_tree ./routers</span>
<span class="co">//= require_tree ../templates</span>
<span class="co">//= require_tree .</span></code></pre>
<p>The above is taken from the example application included with this book. You can view it at <code>example_app/app/assets/javascripts/application.js</code>.</p>
</section>
<section id="an-overview-of-the-stack-connecting-rails-and-backbone" class="level2">
<h2><a href="#an-overview-of-the-stack-connecting-rails-and-backbone">An overview of the stack: connecting Rails and Backbone</a></h2>
<p>By default, Backbone communicates with your Rails application via JSON HTTP requests. If you've ever made a JSON API for your Rails app, then for the most part, this will be very familiar. If you have not made a JSON API for your Rails application before, lucky you! It's pretty straightforward.</p>
<p>This section will briefly touch on each of the major parts of an application using both Rails and Backbone. We'll go into more detail in later chapters, but this should give you the big picture of how the pieces fit together.</p>
<section id="setting-up-models" class="level3">
<h3><a href="#setting-up-models">Setting up models</a></h3>
<p>In our example application, we have a Task model, exposed via a JSON API at <code>/tasks</code>. The simplest Backbone representation of this model would be as shown below:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/models/task.js</span>
<span class="kw">var</span> Task = <span class="ot">Backbone</span>.<span class="ot">Model</span>.<span class="fu">extend</span>({
  <span class="dt">urlRoot</span>: <span class="st">'/tasks'</span>
});</code></pre>
<p>The <code>urlRoot</code> property above describes a base for the server-side JSON API that houses this resource. Collection-level requests will occur at that root URL, and requests relating to instances of this model will be found at <code>/tasks/:id</code>.</p>
<p>It's important to understand that there is no need to have a one-to-one mapping between Rails models and Backbone models. Backbone models instead correspond with RESTful resources. Since your Backbone code is in the presentation tier, it's likely that some of your Backbone models may end up providing only a subset of the information present in the Rails models, or they may aggregate information from multiple Rails models into a composite resource.</p>
<p>In Rails, it's possible to access individual tasks, as well as all tasks (and query all tasks) through the same <code>Task</code> model. In Backbone, models only represent the singular representation of a <code>Task</code>. Backbone splits out the plural representation of <code>Tasks</code> into <code>Collections</code>.</p>
<p>The simplest Backbone collection to represent our <code>Tasks</code> would be the following.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/collections/tasks.js</span>
<span class="ot">ExampleApp</span>.<span class="ot">Collections</span>.<span class="fu">Tasks</span> = <span class="ot">Backbone</span>.<span class="ot">Collection</span>.<span class="fu">extend</span>({
  <span class="dt">model</span>: Task
});</code></pre>
<p>If we specify the URL for <code>Tasks</code> in our collection instead, then models within the collection will use the collection's URL to construct their own URLs, and the <code>urlRoot</code> no longer needs to be specified in the model. If we make that change, then our collection and model will be as follows.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/collections/tasks.js</span>
<span class="ot">ExampleApp</span>.<span class="ot">Collections</span>.<span class="fu">Tasks</span> = <span class="ot">Backbone</span>.<span class="ot">Collection</span>.<span class="fu">extend</span>({
  <span class="dt">model</span>: Task,
  <span class="dt">url</span>: <span class="st">'/tasks'</span>
});

<span class="co">// app/assets/javascripts/models/task.js</span>
<span class="kw">var</span> Task = <span class="ot">Backbone</span>.<span class="ot">Model</span>.<span class="fu">extend</span>({});</code></pre>
<p>Notice in the above model definitions that there is no specification of the attributes on the model. As in ActiveRecord, Backbone models get their attributes from the data used to populate them at runtime. In this case, this schema and data are JSON responses from the Rails server.</p>
<p>The default JSON representation of an ActiveRecord model is an object that includes all the model's attributes. It does not include the data for any related models or any methods on the model, but it does include the ids of any <code>belongs_to</code> relations as those are stored in a <code>relation_name_id</code> attribute on the model.</p>
<p>The JSON representation of your ActiveRecord models will be retrieved by calling <code>to_json</code> on them, which returns a string of JSON. Customize the output of <code>to_json</code> by overriding the <code>as_json</code> method in your model, which returns a Ruby data structure like a Hash or Array which will be serialized into the JSON string. We'll touch on this more later in the section, &quot;Customizing your Rails-generated JSON.&quot;</p>
</section>
<section id="setting-up-rails-controllers" class="level3">
<h3><a href="#setting-up-rails-controllers">Setting up Rails controllers</a></h3>
<p>The Backbone models and collections will talk to your Rails controllers. The most basic pattern is one Rails controller providing one family of RESTful resource to one Backbone model.</p>
<p>By default, Backbone models communicate in the normal RESTful way that Rails controllers understand, using the proper verbs to support the standard RESTful Rails controller actions: index, show, create, update, and destroy. Backbone does not make any use of the new action.</p>
<p>Therefore, it's just up to us to write a <em>normal</em> RESTful controller. The newest and most succinct way to structure these is to use the <code>respond_with</code> method, introduced in Rails 3.0.</p>
<p>When using <code>respond_with</code>, declare supported formats with <code>respond_to</code>. Inside individual actions, you then specify the resource or resources to be delivered using <code>respond_with</code>:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="co"># app/controllers/tasks_controller.rb</span>
<span class="kw">class</span> <span class="dt">TasksController</span> &lt; <span class="dt">ApplicationController</span>
  respond_to <span class="st">:html</span>, <span class="st">:json</span>

  <span class="kw">def</span> index
    respond_with(<span class="ot">@tasks</span> = <span class="dt">Task</span>.all)
  <span class="kw">end</span>
<span class="kw">end</span></code></pre>
<p>In the above example tasks controller, the <code>respond_to</code> line declares that this controller should respond to requests for both the HTML and JSON formats. Then, in the index action, the <code>respond_with</code> call will build a response according to the requested content type (which may be HTML or JSON in this case) and provided resource, <code>@tasks</code>.</p>
<section id="validations-and-your-http-api" class="level4">
<h4><a href="#validations-and-your-http-api">Validations and your HTTP API</a></h4>
<p>If a Backbone model has a <code>validate</code> method defined, it will be validated on the client side, before its attributes are set. If validation fails, no changes to the model will occur, and the &quot;invalid&quot; event will be fired. Your <code>validate</code> method will be passed the attributes that are about to be updated. You can signal that validation passed by returning nothing from your <code>validate</code> method. You signify that validation has failed by returning something from the method. What you return can be as simple as a string, or a more complex object that describes the error in all its gory detail.</p>
<p>The amount of validation you include on the client side is essentially a tradeoff between interface performance and code duplication. It's important for the server to make the last call on validation.</p>
<p>So, your Backbone applications will likely rely on at least some server-side validation logic. Invalid requests return non-2xx HTTP responses, which are handled by error callbacks in Backbone:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">task</span>.<span class="fu">save</span>({ <span class="dt">title</span>: <span class="st">&quot;New Task title&quot;</span> }, {
  <span class="dt">error</span>: <span class="kw">function</span>() {
    <span class="co">// handle error from server</span>
  }
});</code></pre>
<p>The error callback will be triggered if your server returns a non-2xx response. Therefore, you'll want your controller to return a non-2xx HTTP response code if validations fail.</p>
<p>A controller that does this would appear as shown in the following example:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="co"># app/controllers/tasks_controller.rb</span>
<span class="kw">class</span> <span class="dt">TasksController</span> &lt; <span class="dt">ApplicationController</span>
  respond_to <span class="st">:json</span>

  <span class="kw">def</span> create
    <span class="ot">@task</span> = <span class="dt">Task</span>.new(params[<span class="st">:task</span>])
    <span class="kw">if</span> <span class="ot">@task</span>.save
      respond_with(<span class="ot">@task</span>)
    <span class="kw">else</span>
      respond_with(<span class="ot">@task</span>, <span class="st">:status</span> =&gt; <span class="st">:unprocessable_entity</span>)
    <span class="kw">end</span>
  <span class="kw">end</span>
<span class="kw">end</span></code></pre>
<p>The default Rails responders will respond with an unprocessable entity (422) status code when there are validation errors, so the action above can be refactored:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="co"># app/controllers/tasks_controller.rb</span>
<span class="kw">class</span> <span class="dt">TasksController</span> &lt; <span class="dt">ApplicationController</span>
  respond_to <span class="st">:json</span>
  <span class="kw">def</span> create
    <span class="ot">@task</span> = <span class="dt">Task</span>.new(params[<span class="st">:task</span>])
    <span class="ot">@task</span>.save
    respond_with <span class="ot">@task</span>
  <span class="kw">end</span>
<span class="kw">end</span></code></pre>
<p>Your error callback will receive both the model as it was attempted to be saved and the response from the server. You can take that response and handle the errors returned by the above controller in whatever way is fit for your application.</p>
<p>A few different aspects of validations that we saw here are covered in other sections of this book. For more information about validations, see the &quot;Validations&quot; section of the &quot;Models and Collections&quot; chapter. For more information about reducing redundancy between client and server validations, see the &quot;Duplicating business logic across the client and server&quot; section of the &quot;Models and Collections&quot; chapter. For more information about handling and displaying errors on the client side, see the &quot;Forms&quot; section of the &quot;Routers, Views and Templates&quot; chapter.</p>
</section>
</section>
<section id="setting-up-views" class="level3">
<h3><a href="#setting-up-views">Setting Up Views</a></h3>
<p>Most Backbone applications will be a single-page app, or &quot;SPA.&quot; This means that your Rails application handles two jobs: First, it renders a single page which hosts your Backbone application and, optionally, an initial data set for it to use. From there, ongoing interaction with your Rails application occurs via HTTP JSON APIs.</p>
<p>For our example application, this host page will be located at <code>Tasks#index</code>, which is also routed to the root route.</p>
<p>You will want to create an object in JavaScript for your Backbone application. Generally, we use this object as a top-level namespace for other Backbone classes, as well as a place to hold initialization code. For more information on this namespacing see the &quot;Namespacing your application&quot; section of the Organization chapter.</p>
<p>This application object will look like the following:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/example_app.js</span>
<span class="kw">var</span> ExampleApp = {
  <span class="dt">Models</span>: {},
  <span class="dt">Collections</span>: {},
  <span class="dt">Views</span>: {},
  <span class="dt">Routers</span>: {},
  <span class="dt">initialize</span>: <span class="kw">function</span>(data) {
    <span class="kw">this</span>.<span class="fu">tasks</span> = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Collections</span>.<span class="fu">Tasks</span>(<span class="ot">data</span>.<span class="fu">tasks</span>);
    <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Routers</span>.<span class="fu">Tasks</span>();
    <span class="ot">Backbone</span>.<span class="ot">history</span>.<span class="fu">start</span>();
  }
};</code></pre>
<p>You can find this file in the example app in <code>app/assets/javascripts/example_app.js</code>.</p>
<p>IMPORTANT: You must instantiate a Backbone router before calling <code>Backbone.history.start()</code> otherwise <code>Backbone.history</code> will be <code>undefined</code>.</p>
<p>Then, inside <code>app/views/tasks/index.html.erb</code> you will call the <code>initialize</code> method. You will often bootstrap data into the Backbone application to provide initial state. In our example, the tasks have already been provided to the Rails view in an <code>@tasks</code> instance variable:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript">&lt;!-- app/views/tasks/<span class="ot">index</span>.<span class="ot">html</span>.<span class="fu">erb</span> --&gt;
&lt;%= content_for :javascript <span class="kw">do</span> -%&gt;
  &lt;%= javascript_tag <span class="kw">do</span> %&gt;
    <span class="ot">ExampleApp</span>.<span class="fu">initialize</span>({ <span class="dt">tasks</span>: &lt;%== @<span class="ot">tasks</span>.<span class="fu">to_json</span> %&gt; });
  &lt;% end %&gt;
&lt;% end -%&gt;</code></pre>
<p>The above example uses ERB to pass the JSON for the tasks to the <code>initialize</code> method, but we should be mindful of the XSS risks that dumping user-generated content here poses. See the &quot;Encoding data when bootstrapping JSON data&quot; section in the &quot;Security&quot; chapter for a more secure approach.</p>
<p>Finally, you must have a Router in place that knows what to do. We'll cover routers in more detail in the &quot;Routers, Views and Templates&quot; chapter.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/routers/tasks.js</span>
<span class="ot">ExampleApp</span>.<span class="ot">Routers</span>.<span class="fu">Tasks</span> = <span class="ot">Backbone</span>.<span class="ot">Router</span>.<span class="fu">extend</span>({
  <span class="dt">routes</span>: {
    <span class="st">&quot;&quot;</span>: <span class="st">&quot;index&quot;</span>
  },

  <span class="dt">index</span>: <span class="kw">function</span>() {
    <span class="co">// We've reached the end of Rails integration - it's all Backbone from here!</span>

    <span class="fu">alert</span>(<span class="st">'Hello, world!  This is a Backbone router action.'</span>);

    <span class="co">// Normally you would continue down the stack, instantiating a</span>
    <span class="co">// Backbone.View class, calling render() on it, and inserting its element</span>
    <span class="co">// into the DOM.</span>

    <span class="co">// We'll pick back up here in the &quot;Converting Views&quot; section.</span>
  }
});</code></pre>
<p>The example router above is the last piece needed to complete our initial Backbone infrastructure. When a user visits <code>/tasks</code>, the <code>index.html.erb</code> Rails view will be rendered, which properly initializes Backbone and its dependencies and the Backbone models, collections, routers, and views.</p>
</section>
</section>
<section id="customizing-your-rails-generated-json" class="level2">
<h2><a href="#customizing-your-rails-generated-json">Customizing your Rails-generated JSON</a></h2>
<p>There are a few common things you'll do in your Rails app when working with Backbone.</p>
<p>First, it's likely that you'll want to switch from including all attributes, which is the default, to delivering some subset.</p>
<p>This can be done by specifying explicitly only the attributes that are to be included (whitelisting), or specifying the attributes that should <em>not</em> be included (blacklisting). Which one you choose will depend on how many attributes your model has and how paranoid you are about something important appearing in the JSON when it shouldn't be there.</p>
<p>If you're concerned about sensitive data unintentionally being included in the JSON when it shouldn't be, then you'll want to whitelist attributes into the JSON with the <code>:only</code> option:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="co"># app/models/some_model.rb</span>
<span class="kw">def</span> as_json(options = {})
  <span class="dv">super</span>(options.merge(<span class="st">:only</span> =&gt; [ <span class="st">:id</span>, <span class="st">:title</span> ]))
<span class="kw">end</span></code></pre>
<p>The above <code>as_json</code> override will make it so that the JSON will <em>only</em> include the id and title attributes, even if there are many other attributes on the model.</p>
<p>If instead you want to include all attributes by default and just exclude a few, you accomplish this with the <code>:except</code> option:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="co"># app/models/some_model.rb</span>
<span class="kw">def</span> as_json(options = {})
  <span class="dv">super</span>(options.merge(<span class="st">:except</span> =&gt; [ <span class="st">:encrypted_password</span> ]))
<span class="kw">end</span></code></pre>
<p>Another common customization you will want to do in the JSON is include the output of methods (say, calculated values) on your model. This is accomplished with the <code>:methods</code> option, as shown in the following example:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="co"># app/models/some_model.rb</span>
<span class="kw">def</span> as_json(options = {})
  <span class="dv">super</span>(options.merge(<span class="st">:methods</span> =&gt; [ <span class="st">:calculated_value</span> ]))
<span class="kw">end</span></code></pre>
<p>The final thing you'll most commonly do with your JSON is include related objects. If the <code>Task</code> model <code>has_many :comments</code>, include all of the JSON for comments in the JSON for a Task with the <code>:include</code> option:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="co"># app/models/some_model.rb</span>
<span class="kw">def</span> as_json(options = {})
  <span class="dv">super</span>(options.merge(<span class="st">:include</span> =&gt; [ <span class="st">:comments</span> ]))
<span class="kw">end</span></code></pre>
<p>As you may have guessed, you can then customize the JSON for the comments by overriding the <code>as_json</code> method on the <code>Comment</code> model.</p>
<p>While this is the most common set of <code>as_json</code> options you'll use when working with Backbone, it certainly isn't all of them. The official, complete documentation for the <code>as_json</code> method can be found here: <a href="http://apidock.com/rails/ActiveModel/Serializers/JSON/as_json">http://apidock.com/rails/ActiveModel/Serializers/JSON/as_json</a></p>
<section id="activerecordbase.include_root_in_json" class="level3">
<h3><a href="#activerecordbase.include_root_in_json">ActiveRecord::Base.include_root_in_json</a></h3>
<p>Depending on the versions, Backbone and Rails may have different expectations about the format of JSON structures; specifically, whether or not a root key is present. When generating JSON from Rails, this is controlled by the ActiveRecord setting <code>ActiveRecord::Base.include_root_in_json</code>.</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby">  &gt; <span class="dt">ActiveRecord</span>::<span class="dt">Base</span>.include_root_in_json = <span class="dv">false</span>
  &gt; <span class="dt">Task</span>.last.as_json
 =&gt; {<span class="st">&quot;id&quot;</span>=&gt;<span class="dv">4</span>, <span class="st">&quot;title&quot;</span>=&gt;<span class="st">&quot;Enjoy a three mile swim&quot;</span>}

  &gt; <span class="dt">ActiveRecord</span>::<span class="dt">Base</span>.include_root_in_json = <span class="dv">true</span>
  &gt; <span class="dt">Task</span>.last.as_json
 =&gt; {<span class="st">&quot;task&quot;</span>=&gt;{<span class="st">&quot;id&quot;</span>=&gt;<span class="dv">4</span>, <span class="st">&quot;title&quot;</span>=&gt;<span class="st">&quot;Enjoy a three mile swim&quot;</span>}}</code></pre>
<p>In Rails 3.0, <code>ActiveRecord::Base.include_root_in_json</code> is set to &quot;true.&quot; Starting with 3.1, it defaults to &quot;false.&quot; This reversal was made to simplify the JSON returned by default in Rails application, but it is a fairly big change from the default behavior of Rails 3.0.</p>
<p>Practically speaking, this change is a good one, but take particular note if you're upgrading an existing Rails 3.0 application to Rails 3.1 or above and you already have a published API; you may need to expose a new version of your API.</p>
<p>From the Backbone side, the default behavior expects no root node. This behavior is defined in a few places: <code>Backbone.Collection.prototype.parse</code>, <code>Backbone.Model.prototype.parse</code>, and <code>Backbone.Model.prototype.toJSON</code>:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// backbone.js</span>

<span class="ot">_</span>.<span class="fu">extend</span>(<span class="ot">Backbone</span>.<span class="ot">Collection</span>.<span class="fu">prototype</span>, <span class="ot">Backbone</span>.<span class="fu">Events</span>, {
  <span class="co">// http://documentcloud.github.com/backbone/#Collection-parse</span>
  <span class="dt">parse </span>: <span class="kw">function</span>(resp, xhr) {
    <span class="kw">return</span> resp;
  },

  <span class="co">// snip...</span>
});

<span class="ot">_</span>.<span class="fu">extend</span>(<span class="ot">Backbone</span>.<span class="ot">Model</span>.<span class="fu">prototype</span>, <span class="ot">Backbone</span>.<span class="fu">Events</span>, {
  <span class="co">// http://documentcloud.github.com/backbone/#Model-toJSON</span>
  <span class="dt">toJSON </span>: <span class="kw">function</span>() {
    <span class="kw">return</span> <span class="ot">_</span>.<span class="fu">clone</span>(<span class="kw">this</span>.<span class="fu">attributes</span>);
  },

  <span class="co">// http://documentcloud.github.com/backbone/#Model-parse</span>
  <span class="dt">parse </span>: <span class="kw">function</span>(resp, xhr) {
    <span class="kw">return</span> resp;
  },

  <span class="co">// snip...</span>
});</code></pre>
<p>If you need to accept JSON with a root node, you can override <code>parse</code> in each of your models, or override the prototype's function. You'll need to override it on the appropriate collection(s), too.</p>
<p>If you need to send JSON back to a server that includes a root node, you can override <code>toJSON</code>, per model or across all models. When you do this, you'll need to explicitly specify the name of the root key. We use a convention of a <code>modelName</code> function on your model to provide this:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/backbone_overrides.js</span>
<span class="ot">Backbone</span>.<span class="ot">Model</span>.<span class="ot">prototype</span>.<span class="fu">toJSON</span> = <span class="kw">function</span>() {
  <span class="kw">var</span> hashWithRoot = {};
  hashWithRoot[<span class="kw">this</span>.<span class="fu">modelName</span>] = <span class="kw">this</span>.<span class="fu">attributes</span>;
  <span class="kw">return</span> <span class="ot">_</span>.<span class="fu">clone</span>(hashWithRoot);
};

<span class="co">// app/assets/javascripts/models/task.js</span>
<span class="kw">var</span> Task = <span class="ot">Backbone</span>.<span class="ot">Model</span>.<span class="fu">extend</span>({
  <span class="dt">modelName</span>: <span class="st">&quot;task&quot;</span>,

  <span class="co">// ...</span>
});</code></pre>
</section>
</section>
<section id="converting-an-existing-pageview-area-to-use-backbone" class="level2">
<h2><a href="#converting-an-existing-pageview-area-to-use-backbone">Converting an existing page/view area to use Backbone</a></h2>
<p>This section is meant to get you started understanding how Backbone views work by illustrating the conversion of a Rails view to a Backbone view.</p>
<p>Its important to note that a Rails view is not directly analogous to a Backbone view. In Rails, the term &quot;view&quot; usually refers to an HTML template, where Backbone views are classes that contain event handling and presentation logic.</p>
<p>Consider the following Rails view for a tasks index:</p>
<pre class="sourceCode rhtml"><code class="sourceCode rhtml"><span class="co">&lt;!-- app/views/tasks/index.html.erb --&gt;</span>
<span class="kw">&lt;h1&gt;</span>Tasks<span class="kw">&lt;/h1&gt;</span>

<span class="kw">&lt;table&gt;</span>
  <span class="kw">&lt;tr&gt;</span>
    <span class="kw">&lt;th&gt;</span>Title<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>Completed<span class="kw">&lt;/th&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>

  <span class="kw">&lt;%</span> <span class="ot">@tasks</span>.each <span class="kw">do</span> <span class="ch">|</span>task<span class="ch">|</span> <span class="kw">%&gt;</span>
    <span class="kw">&lt;tr&gt;</span>
      <span class="kw">&lt;td&gt;&lt;%=</span> task.title <span class="kw">%&gt;&lt;/td&gt;</span>
      <span class="kw">&lt;td&gt;&lt;%=</span> task.completed <span class="kw">%&gt;&lt;/td&gt;</span>
    <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;%</span> <span class="kw">end</span> <span class="kw">%&gt;</span>
<span class="kw">&lt;/table&gt;</span></code></pre>
<p>So far, we have the Backbone <code>Task</code> model and collection and the Rails <code>Task</code> model and controller discussed above, and we're bootstrapping the Backbone app with all the tasks. Next, we will create a Backbone view which will render a corresponding Backbone template.</p>
<p>A Backbone view is a class that is responsible for rendering the display of a logical element on the page. A view also binds to DOM events occurring within its DOM scope that trigger various behaviors.</p>
<p>We'll start with a basic view that achieves the same result as the Rails template above, rendering a collection of tasks:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/tasks_index.js</span>
<span class="ot">ExampleApp</span>.<span class="ot">Views</span>.<span class="fu">TasksIndex</span> = <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">extend</span>({
  <span class="dt">render</span>: <span class="kw">function</span> () {
    <span class="kw">this</span>.<span class="ot">$el</span>.<span class="fu">html</span>(JST[<span class="st">'tasks/index'</span>]({ <span class="dt">tasks</span>: <span class="kw">this</span>.<span class="fu">collection</span> }));
    <span class="kw">return</span> <span class="kw">this</span>;
  }
});</code></pre>
<p>The <code>render</code> method above renders the <code>tasks/index</code> JST template, passing the collection of tasks into the template.</p>
<p>Each Backbone view has an element that it stores in <code>this.$el</code>. This element can be populated with content, although it's a good practice for code outside the view to actually insert the view into the DOM.</p>
<p>We'll update the Backbone route to instantiate this view, passing in the collection for it to render. The router then renders the view, and inserts it into the DOM:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/routers/tasks.js</span>
<span class="ot">ExampleApp</span>.<span class="ot">Routers</span>.<span class="fu">Tasks</span> = <span class="ot">Backbone</span>.<span class="ot">Router</span>.<span class="fu">extend</span>({
  <span class="dt">routes</span>: {
    <span class="st">&quot;&quot;</span>: <span class="st">&quot;index&quot;</span>
  },

  <span class="dt">index</span>: <span class="kw">function</span>() {
    <span class="kw">var</span> view = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Views</span>.<span class="fu">TasksIndex</span>({ <span class="dt">collection</span>: <span class="ot">ExampleApp</span>.<span class="fu">tasks</span> });
    <span class="fu">$</span>(<span class="st">'body'</span>).<span class="fu">html</span>(<span class="ot">view</span>.<span class="fu">render</span>().<span class="fu">$el</span>);
  }
});</code></pre>
<p>Now that we have the Backbone view in place that renders the template, and it's being called by the router, we can focus on converting the above Rails view to a Backbone template.</p>
<p>Backbone depends on Underscore.js which, among many things, provides templating. The delimiter and basic concepts used for Underscore.js templates and ERB are the same. When converting an existing Rails application to Backbone, this similarity can help ease the transition.</p>
<p>The <code>tasks/index</code> JST template does two things:</p>
<ul>
<li>Loops over all of the tasks</li>
<li>For each task, it outputs the task title and completed attributes</li>
</ul>
<p>Underscore.js provides many iteration functions that will be familiar to Rails developers such as <code>_.each</code>, <code>_.map</code>, and <code>_.reject</code>. Backbone also proxies to Underscore.js to provide these iteration functions as methods on <code>Backbone.Collection</code>.</p>
<p>We'll use the <code>each</code> method to iterate through the <code>Tasks</code> collection that was passed to the view, as shown in the converted Underscore.js template below:</p>
<pre class="sourceCode rhtml"><code class="sourceCode rhtml"><span class="co">&lt;!-- app/assets/templates/tasks/index.jst.ejs --&gt;</span>
<span class="kw">&lt;h1&gt;</span>Tasks<span class="kw">&lt;/h1&gt;</span>

<span class="kw">&lt;table&gt;</span>
  <span class="kw">&lt;tr&gt;</span>
    <span class="kw">&lt;th&gt;</span>Title<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>Completed<span class="kw">&lt;/th&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>

  <span class="kw">&lt;%</span> tasks.each(function(model) <span class="ch">{</span> <span class="kw">%&gt;</span>
    <span class="kw">&lt;tr&gt;</span>
      <span class="kw">&lt;td&gt;&lt;%=</span> model.escape(<span class="st">'title'</span>) <span class="kw">%&gt;&lt;/td&gt;</span>
      <span class="kw">&lt;td&gt;&lt;%=</span> model.escape(<span class="st">'completed'</span>) <span class="kw">%&gt;&lt;/td&gt;</span>
    <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;%</span> <span class="ch">}</span>); <span class="kw">%&gt;</span>
<span class="kw">&lt;/table&gt;</span></code></pre>
<p>In Rails 3.0 and above, template output is HTML-escaped by default. In order to ensure that we have the same XSS protection as we did in our Rails template, we access and output the Backbone model attributes using the <code>escape</code> method instead of the normal <code>get</code> method.</p>
<section id="breaking-out-the-taskview" class="level3">
<h3><a href="#breaking-out-the-taskview">Breaking out the TaskView</a></h3>
<p>In Backbone, views are often bound to an underlying model, re-rendering themselves when the model data changes. Consider what happens when any task changes data with our approach above; the entire collection must be re-rendered. It's useful to break up these composite views into two separate classes, each with their own responsibility: a parent view that handles the aggregation, and a child view responsible for rendering each node of content.</p>
<p>With each of the <code>Task</code> models represented by an individual <code>TaskView</code>, changes to an individual model are broadcast to its corresponding <code>TaskView</code>, which re-renders only the markup for one task.</p>
<p>Continuing our example from above, a <code>TaskView</code> will be responsible for rendering just the individual table row for a <code>Task</code>:</p>
<pre class="sourceCode rhtml"><code class="sourceCode rhtml"><span class="co">&lt;!-- app/assets/templates/tasks/task.jst.ejs --&gt;</span>
<span class="kw">&lt;tr&gt;</span>
  <span class="kw">&lt;td&gt;&lt;%=</span> model.escape(<span class="st">'title'</span>) <span class="kw">%&gt;&lt;/td&gt;</span>
  <span class="kw">&lt;td&gt;&lt;%=</span> model.escape(<span class="st">'completed'</span>) <span class="kw">%&gt;&lt;/td&gt;</span>
<span class="kw">&lt;/tr&gt;</span></code></pre>
<p>And the Task index template will be changed to appear as shown below:</p>
<pre class="sourceCode rhtml"><code class="sourceCode rhtml"><span class="co">&lt;!-- app/assets/templates/tasks/index.jst.ejs --&gt;</span>
<span class="kw">&lt;h1&gt;</span>Tasks<span class="kw">&lt;/h1&gt;</span>

<span class="kw">&lt;table&gt;</span>
  <span class="kw">&lt;tr&gt;</span>
    <span class="kw">&lt;th&gt;</span>Title<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;th&gt;</span>Completed<span class="kw">&lt;/th&gt;</span>
  <span class="kw">&lt;/tr&gt;</span>

  <span class="co">&lt;!-- child content will be rendered here --&gt;</span>

<span class="kw">&lt;/table&gt;</span></code></pre>
<p>As you can see above in the index template, the individual tasks are no longer iterated over and rendered inside the table, but instead within the <code>TasksIndex</code> and <code>TaskView</code> views, respectively:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/task.js</span>
<span class="ot">ExampleApp</span>.<span class="ot">Views</span>.<span class="fu">TaskView</span> = <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">extend</span>({
  <span class="dt">render</span>: <span class="kw">function</span> () {
    <span class="kw">this</span>.<span class="ot">$el</span>.<span class="fu">html</span>(JST[<span class="st">'tasks/view'</span>]({ <span class="dt">model</span>: <span class="kw">this</span>.<span class="fu">model</span> }));
    <span class="kw">return</span> <span class="kw">this</span>;
  }
});</code></pre>
<p>The <code>TaskView</code> view above is very similar to the one we saw previously for the <code>TasksIndex</code> view. It is only responsible for rendering the contents of its own element, and the concern of assembling the view of the list is left to the parent view object:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/tasks_index.js</span>
<span class="ot">ExampleApp</span>.<span class="ot">Views</span>.<span class="fu">TasksIndex</span> = <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">extend</span>({
  <span class="dt">render</span>: <span class="kw">function</span> () {
    <span class="kw">var</span> self = <span class="kw">this</span>;

    <span class="kw">this</span>.<span class="ot">$el</span>.<span class="fu">html</span>(JST[<span class="st">'tasks/index'</span>]()); <span class="co">// Note that no collection is needed</span>
                                         <span class="co">// to build the container markup.</span>

    <span class="kw">this</span>.<span class="ot">collection</span>.<span class="fu">each</span>(<span class="kw">function</span>(task) {
      <span class="kw">var</span> taskView = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Views</span>.<span class="fu">TaskView</span>({ <span class="dt">model</span>: task });
      <span class="ot">self</span>.<span class="fu">$</span>(<span class="st">'table'</span>).<span class="fu">append</span>(<span class="ot">taskView</span>.<span class="fu">render</span>().<span class="fu">el</span>);
    });

    <span class="kw">return</span> <span class="kw">this</span>;
  }
});</code></pre>
<p>In the new <code>TasksIndex</code> view above, the <code>tasks</code> collection is iterated over. For each task, a new <code>TaskView</code> is instantiated, rendered, and then inserted into the <code>&lt;table&gt;</code> element.</p>
<p>If you look at the output of the <code>TasksIndex</code>, it will appear as follows:</p>
<pre class="sourceCode rhtml"><code class="sourceCode rhtml"><span class="co">&lt;!-- output HTML --&gt;</span>
<span class="kw">&lt;div&gt;</span>
  <span class="kw">&lt;h1&gt;</span>Tasks<span class="kw">&lt;/h1&gt;</span>

  <span class="kw">&lt;table&gt;</span>
    <span class="kw">&lt;tr&gt;</span>
      <span class="kw">&lt;th&gt;</span>Title<span class="kw">&lt;/th&gt;</span>
      <span class="kw">&lt;th&gt;</span>Completed<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;/tr&gt;</span>

    <span class="kw">&lt;div&gt;</span>
      <span class="kw">&lt;tr&gt;</span>
        <span class="kw">&lt;td&gt;</span>Task 1<span class="kw">&lt;/td&gt;</span>
        <span class="kw">&lt;td&gt;</span>true<span class="kw">&lt;/td&gt;</span>
      <span class="kw">&lt;/tr&gt;</span>
    <span class="kw">&lt;/div&gt;</span>
    <span class="kw">&lt;div&gt;</span>
      <span class="kw">&lt;tr&gt;</span>
        <span class="kw">&lt;td&gt;</span>Task 2<span class="kw">&lt;/td&gt;</span>
        <span class="kw">&lt;td&gt;</span>false<span class="kw">&lt;/td&gt;</span>
      <span class="kw">&lt;/tr&gt;</span>
    <span class="kw">&lt;/div&gt;</span>
  <span class="kw">&lt;/table&gt;</span>
<span class="kw">&lt;/div&gt;</span></code></pre>
<p>Unfortunately, we can see that there is a problem with the above rendered view: the surrounding div around each of the rendered tasks.</p>
<p>Each of the rendered tasks has a surrounding div because this is the element that each view has that is accessed via <code>this.el</code>, and what the view's content is inserted into. By default, this element is a div and therefore every view will be wrapped in an extra div. While sometimes this extra div doesn't really matter, as in the outermost div that wraps the entire index, other times this produces invalid markup.</p>
<p>Fortunately, Backbone provides us with a clean and simple mechanism for changing the element to something other than a div. In the case of the <code>TaskView</code>, we would like this element to be a tr, then the wrapping tr can be removed from the task view template.</p>
<p>The element to use is specified by the <code>tagName</code> member of the <code>TaskView</code>, as shown below:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/task_view.js</span>
<span class="ot">ExampleApp</span>.<span class="ot">Views</span>.<span class="fu">TaskView</span> = <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">extend</span>({
  <span class="dt">tagName</span>: <span class="st">&quot;tr&quot;</span>,

  <span class="dt">initialize</span>: <span class="kw">function</span>() {
  },

  <span class="dt">render</span>: <span class="kw">function</span> () {
    <span class="kw">this</span>.<span class="ot">$el</span>.<span class="fu">html</span>(JST[<span class="st">'tasks/view'</span>]({ <span class="dt">model</span>: <span class="kw">this</span>.<span class="fu">model</span> }));
    <span class="kw">return</span> <span class="kw">this</span>;
  }
});</code></pre>
<p>Given the above <code>tagName</code> customization, the task view template will appear as follows:</p>
<pre class="sourceCode rhtml"><code class="sourceCode rhtml">// app/assets/templates/tasks/view.jst.ejs
<span class="kw">&lt;td&gt;&lt;%=</span> model.escape(<span class="st">'title'</span>) <span class="kw">%&gt;&lt;/td&gt;</span>
<span class="kw">&lt;td&gt;&lt;%=</span> model.escape(<span class="st">'completed'</span>) <span class="kw">%&gt;&lt;/td&gt;</span></code></pre>
<p>And the resulting output of the <code>TasksIndex</code> will be much cleaner, as shown below:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="co">&lt;!-- output HTML --&gt;</span>
<span class="kw">&lt;div&gt;</span>
  <span class="kw">&lt;h1&gt;</span>Tasks<span class="kw">&lt;/h1&gt;</span>

  <span class="kw">&lt;table&gt;</span>
    <span class="kw">&lt;tr&gt;</span>
      <span class="kw">&lt;th&gt;</span>Title<span class="kw">&lt;/th&gt;</span>
      <span class="kw">&lt;th&gt;</span>Completed<span class="kw">&lt;/th&gt;</span>
    <span class="kw">&lt;/tr&gt;</span>

    <span class="kw">&lt;tr&gt;</span>
      <span class="kw">&lt;td&gt;</span>Task 1<span class="kw">&lt;/td&gt;</span>
      <span class="kw">&lt;td&gt;</span>true<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;/tr&gt;</span>
    <span class="kw">&lt;tr&gt;</span>
      <span class="kw">&lt;td&gt;</span>Task 2<span class="kw">&lt;/td&gt;</span>
      <span class="kw">&lt;td&gt;</span>false<span class="kw">&lt;/td&gt;</span>
    <span class="kw">&lt;/tr&gt;</span>
  <span class="kw">&lt;/table&gt;</span>
<span class="kw">&lt;/div&gt;</span></code></pre>
<p>We've now covered the basic building blocks of converting Rails views to Backbone and getting a functional system. The majority of Backbone programming you will do will likely be in the views and templates, and there is a lot more to them: event binding, different templating strategies, helpers, event unbinding, and more. Those topics are covered in the &quot;Routers, Views, and Templates&quot; chapter.</p>
</section>
</section>
<section id="using-rails-url-helpers-from-backbone" class="level2">
<h2><a href="#using-rails-url-helpers-from-backbone">Using Rails URL helpers from Backbone</a></h2>
<p>Often times you will have part of your application written in Rails, and part in Backbone. Maybe you are converting an existing Rails app to Backbone piecewise, or maybe there are portions of your app that just make more sense as normal HTTP page requests. Either way, you may eventually find that you want to link to a Rails URL from a Backbone view or template.</p>
<p>Let's imagine that you are converting the tasks application from a typical Rails app into the Backbone app we are working on. Say there is a page that displays the history for a task, and it is not yet converted to Backbone, but you want to link to it from the Backbone templates.</p>
<p>Let's say that the task history is visible at a URL of <code>/tasks/:id/history</code>. We will add this link as a fourth column in the template:</p>
<pre class="sourceCode rhtml"><code class="sourceCode rhtml"><span class="co">&lt;!-- app/assets/templates/tasks/item.jst.ejs --&gt;</span>
<span class="kw">&lt;td&gt;&lt;label&gt;</span>Task title<span class="kw">&lt;/label&gt;&lt;a</span><span class="ot"> class=</span><span class="st">&quot;task-link&quot;</span><span class="ot"> href=</span><span class="st">&quot;#&quot;</span><span class="kw">&gt;</span>details<span class="kw">&lt;/a&gt;&lt;/td&gt;</span>
<span class="kw">&lt;td</span><span class="ot"> class=</span><span class="st">&quot;assignees&quot;</span><span class="kw">&gt;</span>(Unassigned)<span class="kw">&lt;/td&gt;</span>
<span class="kw">&lt;td&gt;&lt;input</span><span class="ot"> type=</span><span class="st">&quot;checkbox&quot;</span><span class="kw">&gt;&lt;/td&gt;</span>
<span class="kw">&lt;td</span><span class="ot"> class=</span><span class="st">&quot;history&quot;</span><span class="kw">&gt;</span>
  <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;#&quot;</span><span class="kw">&gt;</span>Task History<span class="kw">&lt;/a&gt;</span>
<span class="kw">&lt;/td&gt;</span></code></pre>
<p>and populate it from the view:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/task_item.js</span>

<span class="ot">ExampleApp</span>.<span class="ot">Views</span>.<span class="fu">TaskItem</span> = <span class="ot">Support</span>.<span class="ot">CompositeView</span>.<span class="fu">extend</span>({
  <span class="co">// ...</span>
  <span class="dt">renderFormContents</span>: <span class="kw">function</span>() {
    <span class="co">// Existing code</span>
    <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'label'</span>).<span class="fu">attr</span>(<span class="st">&quot;for&quot;</span>, <span class="st">&quot;task_completed_&quot;</span> + <span class="kw">this</span>.<span class="ot">model</span>.<span class="fu">get</span>(<span class="st">'id'</span>));
    <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'label'</span>).<span class="fu">html</span>(<span class="kw">this</span>.<span class="ot">model</span>.<span class="fu">escape</span>(<span class="st">'title'</span>));
    <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'input'</span>).<span class="fu">attr</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;task_completed_&quot;</span> + <span class="kw">this</span>.<span class="ot">model</span>.<span class="fu">get</span>(<span class="st">'id'</span>));
    <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'input'</span>).<span class="fu">prop</span>(<span class="st">&quot;checked&quot;</span>, <span class="kw">this</span>.<span class="ot">model</span>.<span class="fu">isComplete</span>());
    <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'td.assignees'</span>).<span class="fu">html</span>(<span class="kw">this</span>.<span class="ot">model</span>.<span class="ot">assignedUsers</span>.<span class="fu">pluck</span>(<span class="st">'email'</span>).<span class="fu">join</span>(<span class="st">&quot;, &quot;</span>));
    <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'a'</span>).<span class="fu">attr</span>(<span class="st">&quot;href&quot;</span>, <span class="kw">this</span>.<span class="fu">taskUrl</span>());

    <span class="co">// New code</span>
    <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'td.history a'</span>).<span class="fu">attr</span>(<span class="st">&quot;href&quot;</span>, <span class="st">&quot;/tasks/&quot;</span> + <span class="kw">this</span>.<span class="ot">model</span>.<span class="fu">get</span>(<span class="st">'id'</span>) + <span class="st">&quot;/history&quot;</span>);
  },
  <span class="co">// ...</span>
});</code></pre>
<p>Now, the way we have constructed the URL in <code>renderFormContents</code> works, but it is fragile; it would break quietly if we changed the Rails routing structure. While an integration test would catch such a regression, this way of linking also unnecessarily duplicates the knowledge of how the URL is constructed.</p>
<p>A library named <a href="https://github.com/railsware/js-routes/">JsRoutes</a> will automatically build JavaScript functions that correspond to the Rails path helper functions available for your Rails routes.</p>
<p>Install the <code>js-routes</code> gem into your application, include the <code>js-routes</code> JavaScript via the asset pipeline, and you will have a global <code>Routes</code> object available in JavaScript that provides JavaScript functions similar to the Rails path helper methods. Let's replace our manual URL construction with one of these helpers:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/task_item.js</span>
renderFormContents: <span class="kw">function</span>() {
  <span class="co">// ...(existing code)...</span>

  <span class="co">// Old history link:</span>
  <span class="co">// this.$('td.history a').attr(&quot;href&quot;, &quot;/tasks/&quot; + this.model.get('id') + &quot;/history&quot;);</span>

  <span class="co">// New history link:</span>
  <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'td.history a'</span>).<span class="fu">attr</span>(<span class="st">&quot;href&quot;</span>, <span class="ot">Routes</span>.<span class="fu">task_history_path</span>(<span class="kw">this</span>.<span class="fu">model</span>));
}</code></pre>
<p>Since the <code>Routes</code> object is global, you can invoke these route helpers directly from templates as well:</p>
<pre class="sourceCode rhtml"><code class="sourceCode rhtml"><span class="co">&lt;!-- app/assets/templates/tasks/item.jst.ejs --&gt;</span>
<span class="kw">&lt;td&gt;&lt;label&gt;</span>Task title<span class="kw">&lt;/label&gt;&lt;a</span><span class="ot"> class=</span><span class="st">&quot;task-link&quot;</span><span class="ot"> href=</span><span class="st">&quot;#&quot;</span><span class="kw">&gt;</span>details<span class="kw">&lt;/a&gt;&lt;/td&gt;</span>
<span class="kw">&lt;td</span><span class="ot"> class=</span><span class="st">&quot;assignees&quot;</span><span class="kw">&gt;</span>(Unassigned)<span class="kw">&lt;/td&gt;</span>
<span class="kw">&lt;td&gt;&lt;input</span><span class="ot"> type=</span><span class="st">&quot;checkbox&quot;</span><span class="kw">&gt;&lt;/td&gt;</span>
<span class="kw">&lt;td</span><span class="ot"> class=</span><span class="st">&quot;history&quot;</span><span class="kw">&gt;</span>
  <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;</span><span class="kw">&lt;%=</span> <span class="dt">Routes</span>.task_history_path(this.task) <span class="kw">%&gt;</span><span class="st">&quot;</span><span class="kw">&gt;</span>Task History<span class="kw">&lt;/a&gt;</span>
<span class="kw">&lt;/td&gt;</span></code></pre>
<p>If you are using a templating library like <a href="http://handlebarsjs.com/">Handlebars.js</a> that supports helper functions, you could include the Routes object's helper functions into your view context directly to eliminate the need to prefix the calls with <code>Routes.</code>:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// somewhere at initialization time, assuming you are using Handlebars.js:</span>
<span class="ot">_</span>.<span class="fu">each</span>(Routes, <span class="kw">function</span>(helper, name) {
  <span class="ot">Handlebars</span>.<span class="fu">registerHelper</span>(name, helper);
});</code></pre>
<p></p>
</section>
</section>
<section id="routers-views-and-templates" class="level1">
<h1><a href="#routers-views-and-templates">Routers, Views, and Templates</a></h1>
<section id="view-explanation" class="level2">
<h2><a href="#view-explanation">View explanation</a></h2>
<p>A Backbone view is a class that is responsible for rendering the display of a logical element on the page. A view can also bind to events which may cause it to be re-rendered.</p>
<p>Again, it's important to note that a Rails view is not directly analogous to a Backbone view. A Rails view is more like a Backbone <em>template</em>, and Backbone views are often more like Rails <em>controllers</em>, in that they are responsible for deciding what should be rendered and how, and for rendering the actual template file. This can cause confusion with developers just starting with Backbone.</p>
<p>A basic Backbone view appears as follows.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/example_view.js</span>
<span class="ot">ExampleApp</span>.<span class="ot">Views</span>.<span class="fu">ExampleView</span> = <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">extend</span>({
  <span class="dt">tagName</span>: <span class="st">&quot;li&quot;</span>,
  <span class="dt">className</span>: <span class="st">&quot;example&quot;</span>,
  <span class="dt">id</span>: <span class="st">&quot;example_view&quot;</span>,

  <span class="dt">events</span>: {
    <span class="st">&quot;click a.save&quot;</span>: <span class="st">&quot;save&quot;</span>
  },

  <span class="dt">render</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="ot">$el</span>.<span class="fu">html</span>(JST[<span class="st">'example/view'</span>]({ <span class="dt">model</span>: <span class="kw">this</span>.<span class="fu">model</span> }));
    <span class="kw">return</span> <span class="kw">this</span>;
  },

  <span class="dt">save</span>: <span class="kw">function</span>() {
    <span class="co">// do something</span>
  }
};</code></pre>
<section id="initialization" class="level3">
<h3><a href="#initialization">Initialization</a></h3>
<p>Backbone views could also include an <code>initialize</code> function which will be called when the view is instantiated.</p>
<p>You only need to specify the initialize function if you wish to do something custom. For example, some views call the <code>render()</code> function upon instantiation. It's not necessary to immediately render that way, but it's relatively common to do so.</p>
<p>You create a new view by instantiating it with <code>new</code>. For example, <code>new ExampleView()</code>. It is possible to pass in a hash of options with <code>new ExampleView(options)</code>. Any options you pass into the constructor will be available as <code>this.options</code> from inside of the view.</p>
<p>There are a few special options that, when passed, will be assigned as properties of view. These are <code>model</code>, <code>collection</code>, <code>el</code>, <code>id</code>, <code>className</code>, and <code>tagName</code>. For example, if you create a new view and give it a model option using <code>new ExampleView({ model: someTask })</code>, then <code>someTask</code> will be available as <code>this.model</code> from inside of the view.</p>
</section>
<section id="the-views-element" class="level3">
<h3><a href="#the-views-element">The View's element</a></h3>
<p>Each Backbone view has an element which it stores in <code>this.el</code>. This element can be populated with content, but isn't on the page until placed there by you. Using this strategy it is then possible to render views outside of the current DOM at any time, and then later, in your code, insert the new elements all at once. In this way, high performance rendering of views can be achieved with as few reflows and repaints as possible.</p>
<p>A jQuery or Zepto object of the view's element is available in <code>this.$el</code>. This is useful, in that you don't need to repeatedly call <code>$(this.el)</code>. This jQuery or Zepto call is also cached, so it should be a performance improvement over repeatedly calling <code>$(this.el)</code>.</p>
<p>It is possible to create a view that references an element already in the DOM, instead of a new element. To do this, pass in the existing element as an option to the view constructor with <code>new ExampleView({ el: existingElement })</code>.</p>
<p>You can also set this after the fact with the <code>setElement()</code> function:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> view = <span class="kw">new</span> <span class="fu">ExampleView</span>();
<span class="ot">view</span>.<span class="fu">setElement</span>(existingElement);</code></pre>
</section>
<section id="customizing-the-views-element" class="level3">
<h3><a href="#customizing-the-views-element">Customizing the View's Element</a></h3>
<p>You can use <code>tagName</code>, <code>className</code>, and <code>id</code> to customize the new element created for the view. If no customization is done, the element is an empty <code>div</code>.</p>
<p><code>tagName</code>, <code>className</code>, and <code>id</code> can either be specified directly on the view or passed in as options at instantiation. Since <code>id</code> will usually correspond to the <code>id</code> of each model, it will likely be passed in as an option rather than declared statically in the view.</p>
<p><code>tagName</code> will change the element that is created from a <code>div</code> to something else that you specify. For example, setting <code>tagName: &quot;li&quot;</code> will result in the view's element being an <code>li</code> rather than a <code>div</code>.</p>
<p><code>className</code> will add an additional class to the element that is created for the view. For example, setting <code>className: &quot;example&quot;</code> in the view will result in that view's element having that additional class like <code>&lt;div class=&quot;example&quot;&gt;</code>.</p>
<p>In addition, as of Backbone 0.9.9, <code>className</code>, <code>tagName</code>, and <code>id</code> can now be defined as functions to allow them to be determined at runtime. An example use case for this would be defining the <code>id</code> of a view based on its model:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">ExampleApp</span>.<span class="ot">Views</span>.<span class="fu">TaskItem</span> = <span class="ot">Support</span>.<span class="ot">CompositeView</span>.<span class="fu">extend</span>({
  <span class="dt">tagName</span>: <span class="st">&quot;tr&quot;</span>,

  <span class="dt">id</span>: <span class="kw">function</span>() {
    <span class="kw">return</span> <span class="st">&quot;task_&quot;</span> + <span class="kw">this</span>.<span class="ot">model</span>.<span class="fu">id</span>;
  },</code></pre>
<p>Note that this dynamic definition is only used when creating the views <code>el</code>, and will not be invoked if <code>el</code> is passed in when creating the view, or during subsequent calls to render.</p>
</section>
<section id="rendering" class="level3">
<h3><a href="#rendering">Rendering</a></h3>
<p>The <code>render</code> function above renders the <code>example/view</code> template. Template rendering is covered in depth in the &quot;Templating strategy&quot; chapter. Suffice to say, nearly every view's render function will render some form of template. Once that template is rendered, other actions to modify the view may be taken.</p>
<p>In addition to rendering a template, typical responsibilities of the <code>render</code> function could include adding more classes or attributes to <code>this.el</code>, or firing or binding other events.</p>
<p>Backbone, when used with jQuery (or Zepto) provides a convenience function of <code>this.$</code> that can be used for selecting elements inside of the view. <code>this.$(selector)</code> is equivalent to the jQuery function call <code>$(selector, this.el)</code></p>
<p>A nice convention of the render function is to return <code>this</code> at the end of render to enable chained calls on the view - usually fetching the element. For example:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/some_view.js</span>
render: <span class="kw">function</span>() {
  <span class="kw">this</span>.<span class="ot">$el</span>.<span class="fu">html</span>(<span class="kw">this</span>.<span class="ot">childView</span>.<span class="fu">render</span>().<span class="fu">el</span>);
  <span class="kw">return</span> <span class="kw">this</span>;
}</code></pre>
</section>
<section id="events" class="level3">
<h3><a href="#events">Events</a></h3>
<p>The view's <code>events</code> hash specifies a mapping of the events and elements that should have events bound, and the functions that should be bound to those events. In the example above, the <code>click</code> event is being bound to the element(s) that match the selector <code>a.save</code> within the view's element. When that event fires, the <code>save</code> function will be called on the view.</p>
<p>When event bindings are declared with the <code>events</code> hash, the DOM events are bound with the <code>$.delegate()</code> function. Backbone also takes care of binding the event handlers' <code>this</code> to the view instance using <code>_.on()</code>.</p>
<p>Event binding is covered in great detail in the &quot;Event binding&quot; chapter.</p>
</section>
</section>
<section id="templating-strategy" class="level2">
<h2><a href="#templating-strategy">Templating strategy</a></h2>
<p>There's no shortage of templating options for JavaScript. They generally fall into three categories:</p>
<ul>
<li><em>HTML with JavaScript expressions interpolated.</em> Examples: <code>_.template</code>, EJS</li>
<li><em>HTML with other expressions interpolated, often logic-free.</em> Examples: Mustache, Handlebars, <code>jQuery.tmpl</code></li>
<li><em>Selector-based content declarations.</em> Examples: PURE, just using jQuery from view classes</li>
</ul>
<p>To quickly compare the different approaches, we will work with creating a template that renders the following HTML:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;ul</span><span class="ot"> class=</span><span class="st">&quot;tasks&quot;</span><span class="kw">&gt;</span>s
  <span class="kw">&lt;li&gt;&lt;span</span><span class="ot"> class=</span><span class="st">&quot;title&quot;</span><span class="kw">&gt;</span>Buy milk<span class="kw">&lt;/span&gt;</span> Get the good kind <span class="kw">&lt;/li&gt;</span>
  <span class="kw">&lt;li&gt;&lt;span</span><span class="ot"> class=</span><span class="st">&quot;title&quot;</span><span class="kw">&gt;</span>Buy cheese<span class="kw">&lt;/span&gt;</span> Sharp cheddar <span class="kw">&lt;/li&gt;</span>
  <span class="kw">&lt;li&gt;&lt;span</span><span class="ot"> class=</span><span class="st">&quot;title&quot;</span><span class="kw">&gt;</span>Eat cheeseburger<span class="kw">&lt;/span&gt;</span> Make with above cheese <span class="kw">&lt;/li&gt;</span>
<span class="kw">&lt;/ul&gt;</span></code></pre>
<p>Assuming we have a TasksCollection instance containing the three elements displayed in the above HTML snippet, let's look at how different templating libraries accomplish the same goal of rendering the above. Since you're already familiar with Underscore.js templates, let's start there.</p>
<p>An Underscore.js template may look like this:</p>
<pre class="sourceCode rhtml"><code class="sourceCode rhtml"><span class="kw">&lt;ul</span><span class="ot"> class=</span><span class="st">&quot;tasks&quot;</span><span class="kw">&gt;</span>
  <span class="kw">&lt;%</span> tasks.each(function(task) <span class="ch">{</span> <span class="kw">%&gt;</span>
    <span class="kw">&lt;li&gt;</span>
        <span class="kw">&lt;span</span><span class="ot"> class=</span><span class="st">&quot;title&quot;</span><span class="kw">&gt;</span> <span class="kw">&lt;%=</span> task.escape(<span class="st">&quot;title&quot;</span>) <span class="kw">%&gt;</span> <span class="kw">&lt;/span&gt;</span>
        <span class="kw">&lt;%=</span> task.escape(<span class="st">&quot;body&quot;</span>) <span class="kw">%&gt;</span>
    <span class="kw">&lt;/li&gt;</span>
  <span class="kw">&lt;%</span> <span class="ch">}</span>) <span class="kw">%&gt;</span>
<span class="kw">&lt;/ul&gt;</span></code></pre>
<p>Here, we interpolate a bit of JavaScript logic in order to iterate through the collection and render the desired markup. Also note that we must fetch escaped values from the task objects, as Underscore.js templates do not perform any escaping on their own.</p>
<p>This is probably the path of least resistance on a Rails Backbone app. Since Backbone depends on Underscore.js, it is already available in your app. As has already been shown in earlier chapters, its usage is very similar to ERB. It has the same <code>&lt;%=</code> and <code>%&gt;</code> syntax as ERB, and you can pass it an options object that is made available to the template when it's rendered.</p>
<p>While we've found Underscore.js' templating to be useful and sufficient to build large backbone applications, there are other templating libraries that are worth mentioning here because they either provide richer functionality or take a different approach to templating.</p>
<p>Handlebars is one such example. One major distinction of Handlebars is that it allows you to define and register helpers that can be used when rendering a template, providing a framework for writing helpers similar to those found in ActionView::Helpers, like <code>domID</code> or other generic rendering logic. It also allows you to write what are called &quot;block helpers,&quot; which are functions that are executed on a different, supplied context during rendering. Handlebars itself exploits this functionality by providing a few helpers out of the box. These helpers are <code>with</code>, <code>each</code>, <code>if</code> and <code>unless</code>, and simply provide control structures for rendering logic.</p>
<p>The above template would look like this in Handlebars:</p>
<pre class="sourceCode rhtml"><code class="sourceCode rhtml"><span class="kw">&lt;ul</span><span class="ot"> class=</span><span class="st">&quot;title&quot;</span><span class="kw">&gt;</span>
  {{#each tasks}}
    <span class="kw">&lt;li&gt;</span>
        <span class="kw">&lt;span</span><span class="ot"> class=</span><span class="st">&quot;title&quot;</span><span class="kw">&gt;</span> {{ this.get(&quot;title&quot;) }} <span class="kw">&lt;/span&gt;</span>
        {{ this.get(&quot;body&quot;) }} <span class="kw">%</span><span class="ch">&gt;</span>
    <span class="kw">&lt;/li&gt;</span>
  {{/each}}
<span class="kw">&lt;ul&gt;</span></code></pre>
<p>Of note:</p>
<ul>
<li>Use of <code>{{#each}}</code>, which iterates over the collection</li>
<li>Within the <code>{{#each}}</code> block, the JavaScript context is the task itself, so you access its properties via <code>this</code></li>
<li>There's no need to escape HTML output, as Handlebars escapes by default</li>
</ul>
<p>A similar library is Mustache.js. Mustache is a templating system that has been ported to a number of languages including JavaScript. The promise of Mustache is &quot;logic-less templates.&quot; Instead of requiring you to write logic in pure JavaScript, using <code>if</code>, for example, Mustache provides a set of tags that take on different meanings. They can render values or not render anything at all.</p>
<p>Like Handlebars, Mustache HTML escapes rendered values by default.</p>
<p>You can learn more about Handlebars at the <a href="http://www.handlebarsjs.com/">project's home on the web</a>, and Mustache at <a href="http://mustache.github.com/mustache.5.html">the project's man page</a> and <a href="https://github.com/janl/mustache.js">javascript implementation</a></p>
</section>
<section id="choosing-a-strategy" class="level2">
<h2><a href="#choosing-a-strategy">Choosing a strategy</a></h2>
<p>Like any technology choice, there are trade-offs to evaluate and external factors to consider when choosing a templating approach.</p>
<p>One of the common questions we've found ourselves asking is: Do I already have server-side templates written that I'd like to &quot;Backbone-ify,&quot; or am I writing new Backbone functionality from scratch? Both of these scenarios are described in more detail in the next two sections.</p>
<section id="adding-backbone-to-existing-rails-views" class="level3">
<h3><a href="#adding-backbone-to-existing-rails-views">Adding Backbone to existing Rails views</a></h3>
<p>If you are replacing existing Rails app pages with Backbone, you are already using a templating engine, and it's likely ERB. When making the switch to Backbone, change as few things as possible at a time, and stick with your existing templating approach.</p>
<p>If you're using ERB, give <code>_.template</code> a shot. It defaults to the same delimiters as ERB for interpolation and evaluation, <code>&lt;%= %&gt;</code> and <code>&lt;% %&gt;</code>, which can be a boon or can be confusing. If you'd like to change them, you can update <code>.templateSettings</code> - check the Underscore.js docs.</p>
<p>If you're using Haml, check out the <code>jquery-haml</code> and <code>haml-js</code> projects.</p>
<p>If you're using Mustache.rb or Handlebars.rb, you're likely aware that JavaScript implementations of these both exist, and that your existing templates can be moved over much like the ERB case.</p>
<p>Ultimately, you should choose a templating strategy that your entire team is comfortable with, while minimizing the cost of rewriting templates. Make sure that designers' considerations are taken into account, because it will affect how they work with that area of the app as well.</p>
</section>
<section id="writing-new-backbone-functionality-from-scratch" class="level3">
<h3><a href="#writing-new-backbone-functionality-from-scratch">Writing new Backbone functionality from scratch</a></h3>
<p>If you're not migrating from existing server-side view templates, you have more freedom of choice. Strongly consider the option of no templating at all, but rather using plain HTML templates, and then decorating the DOM from your view class.</p>
<p>You can build static HTML mockups of the application first, and pull these mockups directly in as templates, without modifying them.</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="co">&lt;!-- app/views/some/page.html.erb --&gt;</span>
<span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">&quot;song-player&quot;</span><span class="kw">&gt;</span>
  <span class="kw">&lt;nav&gt;</span>
    <span class="kw">&lt;a</span><span class="ot"> class=</span><span class="st">&quot;home&quot;</span><span class="ot">    href=</span><span class="st">&quot;#/&quot;</span><span class="kw">&gt;</span>Home<span class="kw">&lt;/a&gt;</span>
    <span class="kw">&lt;a</span><span class="ot"> class=</span><span class="st">&quot;profile&quot;</span><span class="ot"> href=</span><span class="st">&quot;/profile.html&quot;</span><span class="kw">&gt;</span>My Profile<span class="kw">&lt;/a&gt;</span>
  <span class="kw">&lt;/nav&gt;</span>
  <span class="kw">&lt;h2&gt;</span>Song title<span class="kw">&lt;/h2&gt;</span>

  <span class="kw">&lt;audio</span><span class="ot"> controls=</span><span class="st">&quot;controls&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;source</span><span class="ot"> src=</span><span class="st">&quot;/test.ogg&quot;</span><span class="ot"> type=</span><span class="st">&quot;audio/ogg&quot;</span> <span class="kw">/&gt;</span>
    Your browser does not support the audio element.
  <span class="kw">&lt;/audio&gt;</span>
<span class="kw">&lt;/div&gt;</span>
<span class="co">&lt;!-- snip --&gt;</span></code></pre>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/my_view.js</span>
MyView = <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">extend</span>({
  <span class="dt">render</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="fu">renderTemplate</span>();
    <span class="kw">this</span>.<span class="fu">fillTemplate</span>();
  },

  <span class="dt">renderTemplate</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="ot">$el</span>.<span class="fu">html</span>(JST[<span class="st">'songs/index'</span>]());
  },

  <span class="dt">fillTemplate</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'nav a.profile'</span>).<span class="fu">text</span>(<span class="ot">App</span>.<span class="fu">currentUser</span>().<span class="fu">fullName</span>());
    <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'h2'</span>).<span class="fu">html</span>(<span class="kw">this</span>.<span class="ot">model</span>.<span class="fu">escape</span>(<span class="st">'title'</span>));

    <span class="kw">var</span> audio = <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'audio'</span>);
    <span class="ot">audio</span>.<span class="fu">empty</span>();
    <span class="kw">this</span>.<span class="ot">model</span>.<span class="ot">formats</span>.<span class="fu">each</span>(<span class="kw">function</span>(format) {
      <span class="fu">$</span>(<span class="st">&quot;&lt;source&gt;&lt;/source&gt;&quot;</span>)
        .<span class="fu">attr</span>(<span class="st">&quot;src&quot;</span>,  <span class="ot">format</span>.<span class="fu">get</span>(<span class="st">'src'</span>))
        .<span class="fu">attr</span>(<span class="st">&quot;type&quot;</span>, <span class="ot">format</span>.<span class="fu">get</span>(<span class="st">'type'</span>))
        .<span class="fu">appendTo</span>(audio);
    });
  }
});</code></pre>
<p>You can see an example of this in the example application's <code>TaskItem</code> view class, at <code>app/assets/javascripts/views/task_item.js</code>.</p>
<p>The only disadvantage of this is that your view's <code>render()</code> functions become more coupled to the structure of the HTML. This means that a major change in the markup may break the rendering because the selectors used to replace parts of the DOM may no longer find the same elements, or may not find any elements at all.</p>
</section>
</section>
<section id="routers" class="level2">
<h2><a href="#routers">Routers</a></h2>
<p>Routers are an important part of the Backbone infrastructure. Backbone routers provide methods for routing application flow based on client-side URL fragments (<code>yourapp.com/tasks#fragment</code>).</p>
<p>Routes are meant to represent serializable, bookmarkable entry points into your Backbone application. This means that the pertinent application state is serialized into the route fragment and that, given a route, you can completely restore that application state. They serve as navigational checkpoints, and determine the granularity at which users navigate &quot;Back&quot; in your application.</p>
<p>As an aside, it's worth pointing out that there may well be many states in your application that you don't want represented by a route - modes in your application that users don't really care about returning exactly to, or where the cost of building the code that reconstructs the state is too expensive to justify it. For example, you may have a tabbed navigation, expandable information panes, modal dialog boxes, or resizable display ports that all go untracked by routes.</p>
<p>Anecdotally, one recent client application we developed has around 100 Backbone view classes, but fewer than twenty routes. Additionally, many of the view classes are displayed in parallel and have multiple internal states of their own, providing for much more than 100 different interface states.</p>
<section id="a-note-about-pushstate" class="level4">
<h4><a href="#a-note-about-pushstate">A note about <code>pushState</code></a></h4>
<p>Backbone now includes support for pushState, which can use real, full URLs instead of URL fragments for routing.</p>
<p>However, pushState support in Backbone is fully opt-in due to lack of browser support and that additional server-side work is required to support it.</p>
<p>pushState support is currently limited to the latest versions of Firefox, Chrome, Safari, and Mobile Safari. For a full listing of support and more information about the History API, of which pushState is a part, visit <a href="http://diveintohtml5.info/history.html#how">http://diveintohtml5.info/history.html#how</a>.</p>
<p>Thankfully, if you opt-in to pushState in Backbone, browsers that don't support pushState will continue to use hash-based URL fragments, and if a hash URL is visited by a pushState-capable browser, it will be transparently upgraded to the true URL.</p>
<p>In addition to browser support, another hurdle to seamless use of pushState is that because the URLs used are real URLs, your server must know how to render each of the URLs. For example, if your Backbone application has a route of +/tasks/1+, your server-side application must be able to respond to that page if the browser visits that URL directly.</p>
<p>For most applications, you can handle this by just rendering the content you would have for the root URL and letting Backbone handle the rest of the routing to the proper location. But for full search-engine crawlability, your server-side application will need to render the entire HTML of the requested page.</p>
<p>For the reasons and complications above, the examples in this book all currently use URL fragments and not pushState.</p>
</section>
<section id="example-router" class="level3">
<h3><a href="#example-router">Example router</a></h3>
<p>A typical Backbone router will appear as shown below:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/routers/example_router.js</span>
<span class="ot">ExampleApp</span>.<span class="ot">Routers</span>.<span class="fu">ExampleRouter</span> = <span class="ot">Backbone</span>.<span class="ot">Router</span>.<span class="fu">extend</span>({
  <span class="dt">routes</span>: {
    <span class="st">&quot;&quot;</span>         : <span class="st">&quot;index&quot;</span>
    <span class="st">&quot;show/:id&quot;</span> : <span class="st">&quot;show&quot;</span>
  },

  <span class="dt">index</span>: <span class="kw">function</span>() {
    <span class="co">// Instantiate and render the index view</span>
  }

  <span class="dt">show</span>: <span class="kw">function</span>(id) {
    <span class="co">// Instantiate and render the show view</span>
  }
});</code></pre>
</section>
<section id="the-routes-hash" class="level3">
<h3><a href="#the-routes-hash">The routes hash</a></h3>
<p>The basic router consists of a routes hash, which is a mapping between URL fragments and methods on the router. If the current URL fragment, or one that is being visited, matches one of the routes in the hash, its method will be called.</p>
<p>Like Rails routes, Backbone routes can contain parameter parts, as seen in the <code>show</code> route in the example above. In this route, the part of the fragment after <code>show/</code> will then be based as an argument to the <code>show</code> method.</p>
<p>Multiple parameters are possible, as well. For example, a route of <code>search/:query/p:page</code> will match a fragment of <code>search/completed/p2</code> passing <code>completed</code> and <code>2</code> to the action.</p>
<p>In the routes, <code>/</code> is the natural separator. For example, a route of <code>show/:id</code> will not match a fragment of <code>show/1/2</code>. To allow you to match fragments like this, Backbone provides the concept of splat parts, identified by <code>*</code> instead of <code>:</code>. For example, a route of <code>show/*id</code> would match the previous fragment, and <code>1/2</code> would be passed to the action as the <code>id</code> variable.</p>
<p>Routing occurs when the browser's URL changes. This can occur when a link is clicked, when a URL is entered into the browser's URL bar, or when the back button is clicked. In all of those cases, Backbone will look to see if the new URL fragment matches an existing route. If it does, the specified function will be called with any parameters extracted from the URL fragment.</p>
<p>In addition, an event with the name of &quot;route&quot; and the function will be triggered. For example, when the router's <code>show</code> function above is triggered, an event of <code>route:show</code> will be fired. This is so that other objects can listen to the router, and be notified when the router responds to certain routes.</p>
</section>
<section id="initializing-a-router" class="level3">
<h3><a href="#initializing-a-router">Initializing a router</a></h3>
<p>It is possible to specify an <code>initialize</code> function in a Router which will be called when the router is instantiated. Any arguments passed to the router's constructor will be passed to this <code>initialize</code> function.</p>
<p>Additionally, it is possible to pass the routes for a router via the constructor such as <code>new ExampleRouter({ routes: { &quot;&quot; : &quot;index&quot; }}</code>. But note that this will override any routes defined in the routes hash on the router itself.</p>
</section>
</section>
<section id="event-binding" class="level2">
<h2><a href="#event-binding">Event binding</a></h2>
<p>A big part of writing snappy rich client applications is building models and views that update in real-time with respect to one another. With Backbone, you accomplish this with events.</p>
<p>Client-side applications are asynchronous by nature. Events binding and triggering are at the heart of a Backbone application. Your application is written using event-driven programming where components emit and handle events, achieving non-blocking UIs.</p>
<p>With Backbone, it's very easy to write such applications. Backbone provides the <code>Backbone.Events</code> mixin, which can be included in any other class.</p>
<p>Here's a quick example of a very simple game engine, where things happen in the system and an event is triggered, which in turn invokes any event handlers that are bound to that event:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> gameEngine = {};
<span class="ot">_</span>.<span class="fu">extend</span>(gameEngine, <span class="ot">Backbone</span>.<span class="fu">Events</span>);

<span class="ot">gameEngine</span>.<span class="fu">on</span>(<span class="st">&quot;user_registered&quot;</span>, <span class="kw">function</span>(user) {
  <span class="ot">user</span>.<span class="fu">points</span> += <span class="dv">10</span>
});

<span class="ot">gameEngine</span>.<span class="fu">trigger</span>(<span class="st">&quot;user_registered&quot;</span>, <span class="ot">User</span>.<span class="fu">new</span>({ <span class="dt">points</span>: <span class="dv">0</span> }));</code></pre>
<p>In the example above, <code>on</code> subscribes the gameEngine to listen for the &quot;user_registered&quot; event, then <code>trigger</code> broadcasts that event to all subscribed listeners, which invokes the function that adds points to the user. Any arguments passed to <code>trigger</code> after the name of the event are in turn passed to the event handler. So in this case the output of <code>User.new()</code> is received as <code>user</code> in the handler.</p>
<p><code>Backbone.Views</code>, <code>Backbone.Model</code> and <code>Backbone.Collection</code> are all extended with <code>Backbone.Events</code>. There are some events that are triggered by Backbone at particularly convenient moments. These are common events to which many user interface flows need to react. For example, when a Backbone model's attributes are changed, that model will trigger the <code>change</code> event. It is still up to you to bind a handler on those events. (More on that later.)</p>
<p>As you can see from the example though, it is possible to bind and trigger arbitrary events on any object that extends <code>Backbone.Events</code>. Additionally, if an event handler should always trigger regardless of which event is fired, you can bind to the special <code>all</code> event.</p>
<p>There are three primary kinds of events that your views will bind to:</p>
<ul>
<li>DOM events within the view's <code>this.el</code> element</li>
<li>Events triggered by closely associated objects, such as the view's model or collection</li>
<li>Events your view itself publishes</li>
</ul>
<p>Event bindings declared on your view will need to be cleaned when your view is disposed of. Events that your view publishes will need to be handled a different way. Each of these three categories of events is discussed in more detail below.</p>
<section id="binding-to-dom-events-within-the-view-element" class="level3">
<h3><a href="#binding-to-dom-events-within-the-view-element">Binding to DOM events within the view element</a></h3>
<p>The primary function of a view class is to provide behavior for its markup's DOM elements. You can attach event listeners by hand if you like:</p>
<pre class="sourceCode rhtml"><code class="sourceCode rhtml"><span class="co">&lt;!-- app/assets/templates/soundboard.jst.ejs --&gt;</span>
<span class="kw">&lt;a</span><span class="ot"> class=</span><span class="st">&quot;sound&quot;</span><span class="kw">&gt;</span>Honk<span class="kw">&lt;/a&gt;</span>
<span class="kw">&lt;a</span><span class="ot"> class=</span><span class="st">&quot;sound&quot;</span><span class="kw">&gt;</span>Beep<span class="kw">&lt;/a&gt;</span></code></pre>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/sound_board.js</span>
<span class="kw">var</span> SoundBoard = <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">extend</span>({
  <span class="dt">render</span>: <span class="kw">function</span>() {
    <span class="fu">$</span>(<span class="kw">this</span>.<span class="fu">el</span>).<span class="fu">html</span>(JST[<span class="st">'soundboard'</span>]());
    <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">&quot;a.sound&quot;</span>).<span class="fu">bind</span>(<span class="st">&quot;click&quot;</span>, <span class="kw">this</span>.<span class="fu">playSound</span>);
  },

  <span class="dt">playSound</span>: <span class="kw">function</span>() {
    <span class="co">// play sound for this element</span>
  }
});</code></pre>
<p>But Backbone provides an easier and more declarative approach with the <code>events</code> hash:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/sound_board.js</span>
<span class="kw">var</span> SoundBoard = <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">extend</span>({
  <span class="dt">events</span>: {
    <span class="st">&quot;click a.sound&quot;</span>: <span class="st">&quot;playSound&quot;</span>
  },

  <span class="dt">render</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="ot">$el</span>.<span class="fu">html</span>(JST[<span class="st">'soundboard'</span>]());
  },

  <span class="dt">playSound</span>: <span class="kw">function</span>() {
    <span class="co">// play sound for this element</span>
  }
});</code></pre>
<p>Backbone will bind the events with the <a href="http://documentcloud.github.com/backbone/#View-delegateEvents"><code>Backbone.View.prototype.delegateEvents()</code></a> function. It binds DOM events with <code>$.on()</code>, whether you're using the <a href="http://api.jquery.com/on/">jQuery</a> or <a href="https://github.com/madrobby/zepto/blob/v1.0/src/event.js#L181-L184">Zepto</a> <code>.on()</code> function.</p>
<p>It also takes care of binding the event handlers' <code>this</code> to the view instance using <code>_.on()</code>.</p>
</section>
<section id="events-observed-by-your-view" class="level3">
<h3><a href="#events-observed-by-your-view">Events observed by your view</a></h3>
<p>In almost every view you write, the view will be bound to a <code>Backbone.Model</code> or a <code>Backbone.Collection</code>, most often with the convenience properties <code>this.model</code> or <code>this.collection</code>.</p>
<p>Consider a view that displays a collection of <code>Task</code> models. It will re-render itself when any model in the collection is changed or removed, or when a new model is added:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"># app/assets/javascripts/views/<span class="ot">tasks_index</span>.<span class="fu">js</span>
<span class="ot">ExampleApp</span>.<span class="ot">Views</span>.<span class="fu">TasksIndex</span> = <span class="ot">Support</span>.<span class="ot">CompositeView</span>.<span class="fu">extend</span>({
  <span class="dt">initialize</span>: <span class="kw">function</span>() {
    <span class="ot">_</span>.<span class="fu">bindAll</span>(<span class="kw">this</span>, <span class="st">&quot;render&quot;</span>);

    <span class="kw">this</span>.<span class="fu">taskSearch</span> = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="fu">TaskSearch</span>(<span class="kw">this</span>.<span class="fu">collection</span>);
    <span class="kw">this</span>.<span class="fu">bindTo</span>(<span class="kw">this</span>.<span class="ot">taskSearch</span>.<span class="fu">filteredCollection</span>, <span class="st">&quot;add&quot;</span>, <span class="kw">this</span>.<span class="fu">renderTasks</span>);
    <span class="kw">this</span>.<span class="fu">bindTo</span>(<span class="kw">this</span>.<span class="ot">taskSearch</span>.<span class="fu">filteredCollection</span>, <span class="st">&quot;remove&quot;</span>, <span class="kw">this</span>.<span class="fu">renderTasks</span>);
    <span class="kw">this</span>.<span class="fu">bindTo</span>(<span class="kw">this</span>.<span class="ot">taskSearch</span>.<span class="fu">filteredCollection</span>, <span class="st">&quot;reset&quot;</span>, <span class="kw">this</span>.<span class="fu">renderTasks</span>);
  },

  <span class="dt">render</span>: <span class="kw">function</span> () {
    <span class="kw">this</span>.<span class="fu">renderTemplate</span>();
    <span class="kw">this</span>.<span class="fu">attachVisualSearch</span>();
    <span class="kw">this</span>.<span class="fu">renderTasks</span>();
    <span class="kw">return</span> <span class="kw">this</span>;
  },

  <span class="dt">renderTemplate</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="ot">$el</span>.<span class="fu">html</span>(JST[<span class="st">'tasks/index'</span>]({ <span class="dt">tasks</span>: <span class="kw">this</span>.<span class="fu">collection</span> }));
  },

  <span class="dt">attachVisualSearch</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="ot">taskSearch</span>.<span class="fu">attach</span>(<span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'.visual-search'</span>));
  },

  <span class="dt">renderTasks</span>: <span class="kw">function</span>() {
    <span class="kw">var</span> self = <span class="kw">this</span>;
    <span class="ot">self</span>.<span class="fu">$</span>(<span class="st">'tbody'</span>).<span class="fu">empty</span>();

    <span class="kw">this</span>.<span class="ot">taskSearch</span>.<span class="ot">filteredCollection</span>.<span class="fu">each</span>(<span class="kw">function</span>(task) {
      <span class="kw">var</span> row = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Views</span>.<span class="fu">TaskItem</span>({ <span class="dt">model</span>: task });
      <span class="ot">self</span>.<span class="fu">renderChild</span>(row);
      <span class="ot">self</span>.<span class="fu">$</span>(<span class="st">'tbody'</span>).<span class="fu">append</span>(<span class="ot">row</span>.<span class="fu">el</span>);
    });
  }
});</code></pre>
<p>Note how we bind to the collection's <code>change</code>, <code>add</code> and <code>remove</code> events. The <code>add</code> and <code>remove</code> events are triggered when you either <code>add()</code> or <code>remove()</code> a model from that collection as expected. The <code>change</code> event requires special mention; it will trigger when any of the underlying models' <code>change</code> event triggers. Backbone just bubbles up that event to the containing collection for convenience.</p>
<p>While the most common view bindings will be to events from its associated models and collections, your view can bind to any events to which it wants to listen. The life-cycle for the binding and unbinding, and the handling of these events will be the same as those for models and collections.</p>
</section>
<section id="events-your-view-publishes" class="level3">
<h3><a href="#events-your-view-publishes">Events your view publishes</a></h3>
<p>With sufficiently complex views, you may encounter a situation where you want one view to change in response to another. This can be accomplished with events. Your view can trigger an event to which the other view has bindings.</p>
<p>Consider a simple example with a table of users and a toggle control that filters the users to a particular gender:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/gender_picker.js</span>
GenderPicker = <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">extend</span>({
  <span class="dt">render</span>: {
    <span class="co">// render template</span>
  },
  <span class="dt">events</span>: {
    <span class="st">&quot;click .show-male&quot;</span>:   <span class="st">&quot;showMale&quot;</span>,
    <span class="st">&quot;click .show-female&quot;</span>: <span class="st">&quot;showFemale&quot;</span>,
    <span class="st">&quot;click .show-both&quot;</span>:   <span class="st">&quot;showBoth&quot;</span>
  },

  <span class="dt">showMale</span>: <span class="kw">function</span>()   { <span class="kw">this</span>.<span class="fu">trigger</span>(<span class="st">&quot;changed&quot;</span>, <span class="st">&quot;male&quot;</span>);   },
  <span class="dt">showFemale</span>: <span class="kw">function</span>() { <span class="kw">this</span>.<span class="fu">trigger</span>(<span class="st">&quot;changed&quot;</span>, <span class="st">&quot;female&quot;</span>); },
  <span class="dt">showBoth</span>: <span class="kw">function</span>()   { <span class="kw">this</span>.<span class="fu">trigger</span>(<span class="st">&quot;changed&quot;</span>, <span class="st">&quot;both&quot;</span>);   }
});

UsersTable = <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">extend</span>({
  <span class="dt">initialize</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="fu">genderPicker</span> = <span class="kw">new</span> <span class="fu">GenderPicker</span>();
    <span class="kw">this</span>.<span class="ot">genderPicker</span>.<span class="fu">on</span>(<span class="st">&quot;changed&quot;</span>, <span class="kw">this</span>.<span class="fu">filterByGender</span>);
    <span class="kw">this</span>.<span class="fu">collectionToRender</span> = <span class="kw">this</span>.<span class="fu">collection</span>;
    <span class="kw">this</span>.<span class="fu">render</span>();
  },

  <span class="dt">render</span>: {
    <span class="kw">this</span>.<span class="ot">genderPicker</span>.<span class="fu">render</span>();
    <span class="kw">this</span>.<span class="ot">$el</span>.<span class="fu">html</span>(JST[<span class="st">'users'</span>]({ <span class="dt">users</span>: <span class="kw">this</span>.<span class="fu">collectionToRender</span> }));
  }

  <span class="dt">filterByGender</span>: <span class="kw">function</span>(gender) {
    <span class="kw">this</span>.<span class="fu">collectionToRender</span> = <span class="kw">this</span>.<span class="ot">collection</span>.<span class="fu">byGender</span>(gender);
    <span class="kw">this</span>.<span class="fu">render</span>();
  }
});</code></pre>
<p>In the above snippet, the <code>GenderPicker</code> is responsible for the filter control. When the appropriate elements are clicked, a custom <code>changed</code> event is triggered on itself. Note how it is also possible to pass arbitrary parameters to the <code>trigger()</code> function.</p>
<p>On the other hand, we have a <code>UsersTable</code> which is responsible for rendering a collection of users. It also observes this event via the call to <code>on()</code>, where it invokes the <code>filterByGender</code> function.</p>
<p>While your views will generally bind to events on models and collections, a situation like the above may arise where it is handy to trigger and bind to custom events at the view layer. However, it's always a good idea to consider whether you should, instead, be binding to events on the underlying components.</p>
<p></p>
</section>
</section>
<section id="cleaning-up-unbinding" class="level2">
<h2><a href="#cleaning-up-unbinding">Cleaning up: unbinding</a></h2>
<p>In the last section, we discussed three different kinds of event binding in your <code>Backbone.Views</code> classes: DOM events, model/collection events, and custom view events. Next, we'll discuss unbinding these events: why it's a good idea, and how to do it.</p>
<section id="why-unbind-events" class="level3">
<h3><a href="#why-unbind-events">Why unbind events?</a></h3>
<p>Consider two views in a todo app: an index view, which contains all the tasks that need to be done:</p>
<figure>
<img src="data:image/png;base64,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" alt="Tasks index view" /><figcaption>Tasks index view</figcaption>
</figure>
<p></p>
<p>...and a detail view that shows detail on one task:</p>
<figure>
<img src="data:image/png;base64,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" alt="Tasks detail view" /><figcaption>Tasks detail view</figcaption>
</figure>
<p></p>
<p>The interface switches between the two views.</p>
<p>Here's the source for the aggregate index view:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"># app/assets/javascripts/views/<span class="ot">tasks_index</span>.<span class="fu">js</span>
<span class="ot">ExampleApp</span>.<span class="ot">Views</span>.<span class="fu">TasksIndex</span> = <span class="ot">Support</span>.<span class="ot">CompositeView</span>.<span class="fu">extend</span>({
  <span class="dt">initialize</span>: <span class="kw">function</span>() {
    <span class="ot">_</span>.<span class="fu">bindAll</span>(<span class="kw">this</span>, <span class="st">&quot;render&quot;</span>);

    <span class="kw">this</span>.<span class="fu">taskSearch</span> = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="fu">TaskSearch</span>(<span class="kw">this</span>.<span class="fu">collection</span>);
    <span class="kw">this</span>.<span class="fu">bindTo</span>(<span class="kw">this</span>.<span class="ot">taskSearch</span>.<span class="fu">filteredCollection</span>, <span class="st">&quot;add&quot;</span>, <span class="kw">this</span>.<span class="fu">renderTasks</span>);
    <span class="kw">this</span>.<span class="fu">bindTo</span>(<span class="kw">this</span>.<span class="ot">taskSearch</span>.<span class="fu">filteredCollection</span>, <span class="st">&quot;remove&quot;</span>, <span class="kw">this</span>.<span class="fu">renderTasks</span>);
    <span class="kw">this</span>.<span class="fu">bindTo</span>(<span class="kw">this</span>.<span class="ot">taskSearch</span>.<span class="fu">filteredCollection</span>, <span class="st">&quot;reset&quot;</span>, <span class="kw">this</span>.<span class="fu">renderTasks</span>);
  },

  <span class="dt">render</span>: <span class="kw">function</span> () {
    <span class="kw">this</span>.<span class="fu">renderTemplate</span>();
    <span class="kw">this</span>.<span class="fu">attachVisualSearch</span>();
    <span class="kw">this</span>.<span class="fu">renderTasks</span>();
    <span class="kw">return</span> <span class="kw">this</span>;
  },

  <span class="dt">renderTemplate</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="ot">$el</span>.<span class="fu">html</span>(JST[<span class="st">'tasks/index'</span>]({ <span class="dt">tasks</span>: <span class="kw">this</span>.<span class="fu">collection</span> }));
  },

  <span class="dt">attachVisualSearch</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="ot">taskSearch</span>.<span class="fu">attach</span>(<span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'.visual-search'</span>));
  },

  <span class="dt">renderTasks</span>: <span class="kw">function</span>() {
    <span class="kw">var</span> self = <span class="kw">this</span>;
    <span class="ot">self</span>.<span class="fu">$</span>(<span class="st">'tbody'</span>).<span class="fu">empty</span>();

    <span class="kw">this</span>.<span class="ot">taskSearch</span>.<span class="ot">filteredCollection</span>.<span class="fu">each</span>(<span class="kw">function</span>(task) {
      <span class="kw">var</span> row = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Views</span>.<span class="fu">TaskItem</span>({ <span class="dt">model</span>: task });
      <span class="ot">self</span>.<span class="fu">renderChild</span>(row);
      <span class="ot">self</span>.<span class="fu">$</span>(<span class="st">'tbody'</span>).<span class="fu">append</span>(<span class="ot">row</span>.<span class="fu">el</span>);
    });
  }
});</code></pre>
<p>...and the source for the individual task detail view:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"># app/assets/javascripts/views/<span class="ot">task_detail</span>.<span class="fu">js</span>
<span class="fu">var</span> <span class="fu">TaskDetail</span> = <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">extend</span>({
  <span class="dt">template</span>: JST[<span class="st">'tasks/task_detail'</span>],
  <span class="dt">tagName</span>: <span class="st">'section'</span>,
  <span class="dt">id</span>: <span class="st">'task'</span>,

  <span class="dt">events</span>: {
    <span class="st">&quot;click .comments .form-inputs button&quot;</span>: <span class="st">&quot;createComment&quot;</span>
  },

  <span class="dt">initialize</span>: <span class="kw">function</span>() {
    <span class="ot">_</span>.<span class="fu">bindAll</span>(<span class="kw">this</span>, <span class="st">&quot;render&quot;</span>);

    <span class="kw">this</span>.<span class="ot">model</span>.<span class="fu">on</span>(<span class="st">&quot;change&quot;</span>, <span class="kw">this</span>.<span class="fu">render</span>);
    <span class="kw">this</span>.<span class="ot">model</span>.<span class="ot">comments</span>.<span class="fu">on</span>(<span class="st">&quot;change&quot;</span>, <span class="kw">this</span>.<span class="fu">render</span>);
    <span class="kw">this</span>.<span class="ot">model</span>.<span class="ot">comments</span>.<span class="fu">on</span>(<span class="st">&quot;add&quot;</span>,    <span class="kw">this</span>.<span class="fu">render</span>);
  },

  <span class="dt">render</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="ot">$el</span>.<span class="fu">html</span>(<span class="kw">this</span>.<span class="fu">template</span>({<span class="dt">task</span>: <span class="kw">this</span>.<span class="fu">model</span>}));
  },

  <span class="dt">createComment</span>: <span class="kw">function</span>() {
    <span class="kw">var</span> comment = <span class="kw">new</span> <span class="fu">Comment</span>({ <span class="dt">text</span>: <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'.new-comment-input'</span>).<span class="fu">val</span>() });
    <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'.new-comment-input'</span>).<span class="fu">val</span>(<span class="st">''</span>);
    <span class="kw">this</span>.<span class="ot">model</span>.<span class="ot">comments</span>.<span class="fu">create</span>(comment);
  }
});</code></pre>
<p>Each task on the index page links to the detail view for itself. When a user follows one of these links and navigates from the index page to the detail page, then interacts with the detail view to change a model, the <code>change</code> event on the <code>TaskApp.tasks</code> collection is fired. One consequence of this is that the index view, which is still bound and observing the <code>change</code> event, will re-render itself.</p>
<p>This is both a functional bug and a memory leak: not only will the index view re-render and disrupt the detail display momentarily, but navigating back and forth between the views without disposing of the previous view will keep creating more views and binding more events on the associated models or collections.</p>
<p>These can be extremely tricky to track down on a production application, especially if you are nesting child views. Sadly, there's no &quot;garbage collection&quot; for views in Backbone, so your application needs to manage this itself. Luckily, it's not too hard to keep track of and correctly maintain your bindings.</p>
<p>Let's take a look at how to unbind three kinds of events: DOM events, model and collection events, and events you trigger in your views.</p>
</section>
<section id="unbinding-dom-events" class="level3">
<h3><a href="#unbinding-dom-events">Unbinding DOM events</a></h3>
<p>DOM events are the simplest case - they more or less get cleaned up for you. When you call <code>this.remove()</code> in your view, it delegates to <code>jQuery.remove()</code> by invoking <code>$(this.el).remove()</code>. This means that jQuery takes care of cleaning up any events bound on DOM elements within your view, regardless of whether you bound them with the Backbone <code>events</code> hash or by hand; for example, with <code>$.bind()</code>, <code>$.delegate()</code>, <code>live()</code> or <code>$.on()</code>.</p>
</section>
<section id="backbones-listentto-and-stoplistening" class="level3">
<h3><a href="#backbones-listentto-and-stoplistening">Backbone's <code>listentTo</code> and <code>stopListening</code></a></h3>
<p>In Backbone 0.9.9, a handful of functions were added to the <code>Events</code> object within Backbone that make it easier to manage and clean up events. The core of them is the <code>listentTo</code> function which allows you to bind to events from the point of view of the observer, rather than the triggering object.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// Standard event binding approach using .on</span>
<span class="ot">taskModel</span>.<span class="fu">on</span>(<span class="st">'change'</span>, <span class="ot">taskView</span>.<span class="fu">render</span>)

<span class="co">// new listentTo function, called on the observing object</span>
<span class="ot">taskView</span>.<span class="fu">listentTo</span>(taskModel, <span class="st">'change'</span>, <span class="ot">taskView</span>.<span class="fu">render</span>)</code></pre>
<p>The benefit of using <code>listenTo</code> is that it allows the observing object to keep track of its callbacks and clean them up efficiently. Specifically, Backbone also provides a <code>stopListening</code> function that will remove all registered callbacks. This <code>stopListening</code> function is called automatically when the view's <code>remove</code> function is called.</p>
</section>
<section id="unbinding-model-and-collection-events" class="level3">
<h3><a href="#unbinding-model-and-collection-events">Unbinding model and collection events</a></h3>
<p>If your view binds to events on a model or collection with <code>on()</code>, you are responsible for unbinding these events. You do this with a simple call to <code>this.model.off()</code> or <code>this.collection.off()</code>; the <a href="http://documentcloud.github.com/backbone/#Events-off"><code>Backbone.Events.off()</code> function</a> removes all callbacks on that object.</p>
<p>When should you unbind these handlers? Whenever the view is going away. This means that any pieces of code that create new instances of this view become responsible for cleaning up after it's gone. That isn't a very cohesive approach, so it's best to include the cleanup responsibility on the view itself.</p>
<p>To do this, you'll write a <code>leave()</code> function on your view that wraps <code>remove()</code> and handles any additional event unbinding that's needed. As a convention, when you use this view elsewhere, you'll call <code>leave()</code> instead of <code>remove()</code> when you're done:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/some_collection_view.js</span>
<span class="kw">var</span> SomeCollectionView = <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">extend</span>({
  <span class="co">// snip...</span>

  <span class="dt">initialize</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="ot">collection</span>.<span class="fu">bind</span>(<span class="st">&quot;change&quot;</span>, <span class="kw">this</span>.<span class="fu">render</span>);
  },

  <span class="dt">leave</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="ot">collection</span>.<span class="fu">unbind</span>(<span class="st">&quot;change&quot;</span>, <span class="kw">this</span>.<span class="fu">render</span>);
    <span class="kw">this</span>.<span class="fu">remove</span>();
  }

  <span class="co">// snip...</span>
});</code></pre>
</section>
<section id="keep-track-of-on-calls-to-unbind-more-easily" class="level3">
<h3><a href="#keep-track-of-on-calls-to-unbind-more-easily">Keep track of <code>on()</code> calls to unbind more easily</a></h3>
<p>In the example above, unbinding the collection change event isn't too much hassle; since we're only observing one thing, we only have to unbind one thing. But even the addition of one line to <code>leave()</code> is easy to forget, and if you bind to multiple events, it only gets more verbose.</p>
<p>Let's add a step of indirection in event binding, so that we can automatically clean up all the events with one call. We'll add and use a <code>bindTo()</code> function that keeps track of all the event handlers we bind, and then issue a single call to <code>unbindFromAll()</code> to unbind them:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/some_collection_view.js</span>
<span class="kw">var</span> SomeCollectionView = <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">extend</span>({
  <span class="dt">initialize</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="fu">bindings</span> = [];
    <span class="kw">this</span>.<span class="fu">bindTo</span>(<span class="kw">this</span>.<span class="fu">collection</span>, <span class="st">&quot;change&quot;</span>, <span class="kw">this</span>.<span class="fu">render</span>);
  },

  <span class="dt">leave</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="fu">unbindFromAll</span>();
    <span class="kw">this</span>.<span class="fu">remove</span>();
  },

  <span class="dt">bindTo</span>: <span class="kw">function</span>(source, event, callback) {
    <span class="ot">source</span>.<span class="fu">on</span>(event, callback, <span class="kw">this</span>);
    <span class="kw">this</span>.<span class="ot">bindings</span>.<span class="fu">push</span>({ <span class="dt">source</span>: source, <span class="dt">event</span>: event, <span class="dt">callback</span>: callback });
  },

  <span class="dt">unbindFromAll</span>: <span class="kw">function</span>() {
    <span class="ot">_</span>.<span class="fu">each</span>(<span class="kw">this</span>.<span class="fu">bindings</span>, <span class="kw">function</span>(binding) {
      <span class="ot">binding</span>.<span class="ot">source</span>.<span class="fu">off</span>(<span class="ot">binding</span>.<span class="fu">event</span>, <span class="ot">binding</span>.<span class="fu">callback</span>);
    });
    <span class="kw">this</span>.<span class="fu">bindings</span> = [];
  }
});</code></pre>
<p>These functions, <code>bindTo()</code> and <code>unbindFromAll()</code>, can be extracted into a reusable mixin or superclass. Then, we just have to use <code>this.bindTo()</code> instead of <code>model.on()</code> and be assured that the handlers will be cleaned up during <code>leave()</code>.</p>
<p>Now, to clarify, Backbone does provide the facility to unbind from all callbacks for one object, with <code>this.model.off(null, null, this)</code>. There are two kinds of situations that make <code>bindTo</code> preferable.</p>
<p>The first case is when a view binds to events on more than one model/collection. Consider a <code>ReportHeader</code> view binds to events on its <code>user</code>, <code>report</code>, and <code>reportDetails</code> objects; unbinding would require three calls to <code>off</code>. Using <code>bindTo</code> allows the cleanup to happen with one call to <code>unbindFromAll</code>, without having to keep track of the various objects you've bound to.</p>
<p>The second is when you want to extract the cleanup to a base view class, like we will discuss shortly. This eliminates the need to repeat unbinding code across all view classes by extracting it up to the parent/base view class. In order to unbind, the base class must know the name of the object to unbind. You could make the assumption that it's always named <code>this.model</code>, but you'll sometimes want to bind to other things, say <code>this.collection</code>. Using <code>bindTo</code> means that the base class doesn't need to know what the child classes bind onto, and it can still cleanly unbind.</p>
</section>
<section id="unbinding-view-triggered-events" class="level3">
<h3><a href="#unbinding-view-triggered-events">Unbinding view-triggered events</a></h3>
<p>With the first two kinds of event binding that we discussed, DOM and model/collection, the view is the observer. The responsibility to clean up is on the observer, and here the responsibility consists of unbinding the event handler when the view is being removed.</p>
<p>But other times, our view classes will trigger (emit) events of their own. In this case, other objects are the observers, and are responsible for cleaning up the event binding when they are disposed. See &quot;Events your view publishes&quot; in the earlier &quot;Event binding&quot; section for more details.</p>
<p>Finally, when the view itself is disposed of with <code>leave()</code>, it should clean up any event handlers bound on <em>itself</em> for events that it triggers.</p>
<p>This is handled by invoking <code>Backbone.Events.off()</code>:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/filtering_view.js</span>
<span class="kw">var</span> FilteringView = <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">extend</span>({
  <span class="co">// snip...</span>

  <span class="dt">events</span>: {
    <span class="st">&quot;click a.filter&quot;</span>: <span class="st">&quot;changeFilter&quot;</span>
  },

  <span class="dt">changeFilter</span>: <span class="kw">function</span>() {
    <span class="kw">if</span> (<span class="fu">someLogic</span>()) {
      <span class="kw">this</span>.<span class="fu">trigger</span>(<span class="st">&quot;filtered&quot;</span>, { <span class="dt">some</span>: options });
    }
  },

  <span class="dt">leave</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="fu">off</span>(); <span class="co">// Clean up any event handlers bound on this view</span>
    <span class="kw">this</span>.<span class="fu">remove</span>();
  }

  <span class="co">// snip...</span>
});</code></pre>
</section>
<section id="establish-a-convention-for-consistent-and-correct-unbinding" class="level3">
<h3><a href="#establish-a-convention-for-consistent-and-correct-unbinding">Establish a convention for consistent and correct unbinding</a></h3>
<p>There's no built-in garbage collection for Backbone's event bindings, and forgetting to unbind can cause bugs and memory leaks. The solution is to make sure you unbind events and remove views when you leave them. Our approach to this is two-fold: write a set of reusable functions that manage cleaning up a view's bindings, and use these functions wherever views are instantiated - in <code>Router</code> instances, and in composite views. We'll take a look at these concrete, reusable approaches in the next two sections about <code>SwappingRouter</code> and <code>CompositeView</code>.</p>
</section>
</section>
<section id="swapping-router" class="level2">
<h2><a href="#swapping-router">Swapping router</a></h2>
<p>When switching from one view to another, we should clean up the previous view. Earlier, we discussed a convention of writing a <code>view.leave()</code>. Let's augment our view to include the ability to clean itself up by &quot;leaving&quot; the DOM:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/my_view.js</span>
<span class="kw">var</span> MyView = <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">extend</span>({
  <span class="co">// ...</span>

  <span class="dt">leave</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="fu">off</span>();
    <span class="kw">this</span>.<span class="fu">remove</span>();
  },

  <span class="co">// ...</span>
});</code></pre>
<p>The <code>off()</code> and <code>remove()</code> functions are provided by <code>Backbone.Events</code> and <code>Backbone.View</code> respectively. <code>Backbone.Events.off()</code> will remove all callbacks registered on the view, and <code>remove()</code> will remove the view's element from the DOM, equivalent to calling <code>this.$el.remove()</code>. In addition, <code>remove()</code> will also call <code>stopListening()</code> on the view to clean up any event callbacks defined using <code>listenTo</code>.</p>
<p>In simple cases, we replace one full page view with another full page (less any shared layout). We introduce a convention that all actions underneath one <code>Router</code> share the same root element, and define it as <code>el</code> on the router.</p>
<p>Now, a <code>SwappingRouter</code> can take advantage of the <code>leave()</code> function, and clean up any existing views before swapping to a new one. It swaps into a new view by rendering that view into its own <code>el</code>:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"># app/assets/javascripts/support/<span class="ot">swapping_router</span>.<span class="fu">js</span>
<span class="ot">Support</span>.<span class="fu">SwappingRouter</span> = <span class="kw">function</span>(options) {
  <span class="ot">Backbone</span>.<span class="ot">Router</span>.<span class="fu">apply</span>(<span class="kw">this</span>, [options]);
};

<span class="ot">_</span>.<span class="fu">extend</span>(<span class="ot">Support</span>.<span class="ot">SwappingRouter</span>.<span class="fu">prototype</span>, <span class="ot">Backbone</span>.<span class="ot">Router</span>.<span class="fu">prototype</span>, {
  <span class="dt">swap</span>: <span class="kw">function</span>(newView) {
    <span class="kw">if</span> (<span class="kw">this</span>.<span class="fu">currentView</span> &amp;&amp; <span class="kw">this</span>.<span class="ot">currentView</span>.<span class="fu">leave</span>) {
      <span class="kw">this</span>.<span class="ot">currentView</span>.<span class="fu">leave</span>();
    }

    <span class="kw">this</span>.<span class="fu">currentView</span> = newView;
    <span class="fu">$</span>(<span class="kw">this</span>.<span class="fu">el</span>).<span class="fu">empty</span>().<span class="fu">append</span>(<span class="kw">this</span>.<span class="ot">currentView</span>.<span class="fu">render</span>().<span class="fu">el</span>);
  }
});

<span class="ot">Support</span>.<span class="ot">SwappingRouter</span>.<span class="fu">extend</span> = <span class="ot">Backbone</span>.<span class="ot">Router</span>.<span class="fu">extend</span>;</code></pre>
<p>Now all you need to do in a route function is call <code>swap()</code>, passing in the new view that should be rendered. The <code>swap()</code> function's job is to call <code>leave()</code> on the current view, render the new view appending it to the router's <code>el</code>, and, finally, store what view is the current view, so that the next time <code>swap()</code> is invoked, it can be properly cleaned up as well.</p>
<section id="swappingrouter-and-backbone-internals" class="level3">
<h3><a href="#swappingrouter-and-backbone-internals">SwappingRouter and Backbone internals</a></h3>
<p>If the code for <code>SwappingRouter</code> seems a little confusing, don't fret: it is, thanks to JavaScript's object model! Sadly, it's not as simple to just drop the <code>swap</code> method into <code>Backbone.Router</code>, or call <code>Backbone.Router.extend</code> to mixin the function we need.</p>
<p>Our goal here is essentially to create a subclass of <code>Backbone.Router</code>, and to extend it without modifying the original class. This gives us a few benefits: first, <code>SwappingRouter</code> should work with Backbone upgrades. Second, it should be <em>obvious</em> and <em>intention-revealing</em> when a controller needs to swap views. If we simply mixed in a <code>swap</code> method and called it from a direct descendant of <code>Backbone.Router</code>, an unaware (and unlucky) programmer would need to go on a deep source dive in an attempt to figure out where that was coming from. With a subclass, the hunt can start at the file where it was defined.</p>
<p>The procedure used to create <code>SwappingRouter</code> is onerous, thanks to a mix of Backbone-isms and just how clunky inheritance is in JavaScript. Firstly, we need to define the constructor, which delegates to the <code>Backbone.Router</code> constructor with the use of <code>Function#apply</code>. The next block of code uses Underscore.js' <code>Object#extend</code> to create the set of functions and properties that will become <code>SwappingRouter</code>. The <code>extend</code> function takes a destination - in this case, the empty prototype for <code>SwappingRouter</code> - and copies the properties into the <code>Backbone.Router</code> prototype along with our new custom object that includes the <code>swap</code> function.</p>
<p>Finally, the subclass cake is topped off with some Backbone frosting, by setting <code>extend</code>, which is a self-propagating function that all Backbone public classes use. Let's take a quick look at this function, as seen in Backbone 0.5.3:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> extend = <span class="kw">function</span> (protoProps, classProps) {
  <span class="kw">var</span> child = <span class="fu">inherits</span>(<span class="kw">this</span>, protoProps, classProps);
  <span class="ot">child</span>.<span class="fu">extend</span> = <span class="kw">this</span>.<span class="fu">extend</span>;
  <span class="kw">return</span> child;
};

<span class="co">// Helper function to correctly set up the prototype chain, for subclasses.</span>
<span class="co">// Similar to `goog.inherits`, but uses a hash of prototype properties and</span>
<span class="co">// class properties to be extended.</span>
<span class="kw">var</span> inherits = <span class="kw">function</span>(parent, protoProps, staticProps) {
  <span class="co">// sparing our readers the internals of this function... for a deep dive</span>
  <span class="co">// into the dark realms of JavaScript's prototype system, read the source!</span>
}</code></pre>
<p>This is a function that calls <code>inherits</code> to make a new subclass. The comments reference <code>goog.inherits</code> from Google's Closure Library, which contains similar utility functions to allow more class-style inheritance.</p>
<p>The end result here is that whenever you make a custom controller internally in Backbone, you're making <em>another</em> subclass. The inheritance chain for <code>TasksRouter</code> would then look like:</p>
<figure>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPsAAAHiCAIAAAChvi0WAAAKd2lDQ1BJQ0MgUHJvZmlsZQAAeAHVlmdUFMkahqt7ciLNMAIShpxzBslxyDmJyjBDGMI4DkFFzCyu4IoiIgLKii5RwVUJsqiIKCosAgqYF2QRUK6LAVFAuT1wcD3n3v13/9w6p6qffuvrr6u76jvnBYDcxuLzk2AxAJJ5qYIAN0dGWHgEA/cE4IE0IAMzoMhip/Ad/Py8wD+2j4MAEk7e1xXm+sew/z4hzolJYQMA+SHT0ZwUdjLClxCeY/MFqQDA5xHu3ZzKRxi1C2GaAFkgwgVCjlvmKiFHL3PrUkxQgBMS0wsAnsxiCeIAID1FdEY6Ow7JQ1pA2IDH4fIAIOsgbMuOZ3EQFq5dJzl5o5CLENaI/i5P3HfMYkV/y8lixX3j5W9BnkRe7MxN4Sexti7d/C+H5KQ05H8tNQlkJPOSfIR7I+QJDsvZc4X5SUt7tqTH8IIDV3RetI/vCscKXANWmJ/q+B37Ba3oGfFOPisck+LyLU8Cy0O4Z0v5BWkBwSuckh7ossIZ8UGhK8yJcf6mx3JdmSs6N5X57V2JGz2/rQE4AS7ggRiQDFiAAdyBMwCpMVuQ/QPAaSN/q4AbF5/KcEBOXIwOg8lj6+kwjAwMDYXT/zdNWGvLi33/cKmGIDr+by0jEQD720gNuPythSJntqYaALrs35oKcp5peQC0dLHTBOnL+dDCCwYQgSigIZUsD5SBBtAFRkhFWwN74AI8gC8IAuFgPWCDeOQfC8BmkAl2g2yQCw6Bo6AYlIHToAqcAxdAE2gF18Et0AV6wQB4AobBGHgNpsFHMA9BEA6iQFRIGlKAVCFtyAiygGwhF8gLCoDCoSgoDuJBaVAmtBfKhfKhYugUVA39Cl2GrkN3oD7oETQCTULvoDkYBZNhGiwHq8H6sAXsAHvCQfA6OA7eBGfAWfBBuAguh8/CjfB1uAsegIfh1/AMCqBIKDpKEaWLskA5oXxREahYlAC1A5WDKkSVo+pQLahO1H3UMGoK9RmNRVPRDLQu2hrtjg5Gs9Gb0DvQB9DF6Cp0I7oDfR89gp5Gf8VQMLIYbYwVhokJw8RhNmOyMYWYCkwD5iZmADOG+YjFYulYdaw51h0bjk3AbsMewJ7A1mPbsH3YUewMDoeTxmnjbHC+OBYuFZeNO447i7uG68eN4T7hSXgFvBHeFR+B5+H34AvxNfir+H78OH6eIEZQJVgRfAkcwlZCHuEMoYVwjzBGmCeKE9WJNsQgYgJxN7GIWEe8SXxKfE8ikZRIliR/Epe0i1REOk+6TRohfSZLkLXITuRIchr5ILmS3EZ+RH5PoVDUKPaUCEoq5SClmnKD8pzySYQqoifCFOGI7BQpEWkU6Rd5I0oQVRV1EF0vmiFaKHpR9J7olBhBTE3MSYwltkOsROyy2JDYjDhV3FDcVzxZ/IB4jfgd8QkJnISahIsERyJL4rTEDYlRKoqqTHWisql7qWeoN6ljNCxNncakJdByaedoPbRpSQlJE8kQyS2SJZJXJIfpKLoanUlPoufRL9AH6XOr5FY5rIpZtX9V3ar+VbNSq6XspWKkcqTqpQak5qQZ0i7SidKHpZukn8mgZbRk/GU2y5yUuSkztZq22no1e3XO6gurH8vCslqyAbLbZE/LdsvOyMnLucnx5Y7L3ZCbkqfL28snyBfIX5WfVKAq2CpwFQoUrim8YkgyHBhJjCJGB2NaUVbRXTFN8ZRij+K8krpSsNIepXqlZ8pEZQvlWOUC5XblaRUFFW+VTJValceqBFUL1XjVY6qdqrNq6mqhavvUmtQm1KXUmeoZ6rXqTzUoGnYamzTKNR5oYjUtNBM1T2j2asFaplrxWiVa97RhbTNtrvYJ7T4djI6lDk+nXGdIl6zroJuuW6s7okfX89Lbo9ek90ZfRT9C/7B+p/5XA1ODJIMzBk8MJQw9DPcYthi+M9IyYhuVGD0wphi7Gu80bjZ+a6JtEmNy0uShKdXU23SfabvpFzNzM4FZndmkuYp5lHmp+ZAFzcLP4oDFbUuMpaPlTstWy89WZlapVhes/rLWtU60rrGeWKO+JmbNmTWjNko2LJtTNsO2DNso259th+0U7Vh25XYv7JXtOfYV9uMOmg4JDmcd3jgaOAocGxxnnayctju1OaOc3ZxznHtcJFyCXYpdnrsquca51rpOu5m6bXNrc8e4e7ofdh9iyjHZzGrmtIe5x3aPDk+yZ6BnsecLLy0vgVeLN+zt4X3E+6mPqg/Pp8kX+DJ9j/g+81P32+T3mz/W38+/xP9lgGFAZkBnIDVwQ2BN4Mcgx6C8oCfBGsFpwe0hoiGRIdUhs6HOofmhw2H6YdvDusJlwrnhzRG4iJCIioiZtS5rj64dizSNzI4cXKe+bsu6O+tl1ietv7JBdANrw8UoTFRoVE3UAsuXVc6aiWZGl0ZPs53Yx9ivOfacAs5kjE1Mfsx4rE1sfuxEnE3ckbjJeLv4wvgprhO3mPs2wT2hLGE20TexMnExKTSpPhmfHJV8mSfBS+R1bJTfuGVjH1+bn80f3mS16eimaYGnoCIFSlmX0pxKQ0xNd5pG2g9pI+m26SXpnzaHbL64RXwLb0v3Vq2t+7eOZ7hm/LINvY29rT1TMXN35sh2h+2ndkA7one071TembVzbJfbrqrdxN2Ju3/fY7Anf8+HvaF7W7LksnZljf7g9kNttki2IHton/W+sh/RP3J/7NlvvP/4/q85nJy7uQa5hbkLB9gH7v5k+FPRT4sHYw/25JnlnTyEPcQ7NHjY7nBVvnh+Rv7oEe8jjQWMgpyCD0c3HL1TaFJYdox4LO3YcJFXUfNxleOHji8UxxcPlDiW1JfKlu4vnT3BOdF/0v5kXZlcWW7Z3M/cnx+ecjvVWK5WXngaezr99MszIWc6f7H4pbpCpiK34kslr3K4KqCqo9q8urpGtiavFq5Nq508G3m295zzueY63bpT9fT63PPgfNr5V79G/Tp4wfNC+0WLi3WXVC+VNlAbchqhxq2N003xTcPN4c19lz0ut7dYtzT8pvdbZatia8kVySt5V4lXs64uXsu4NtPGb5u6Hnd9tH1D+5MbYTcedPh39Nz0vHn7luutG50Onddu29xuvWN15/Jdi7tNXWZdjd2m3Q2/m/7e0GPW03jP/F5zr2VvS9+avqv9dv3X7zvfv/WA+aBrwGegbzB48OFQ5NDwQ87DiUdJj94+Tn88/2TXU8zTnGdizwqfyz4v/0Pzj/phs+ErI84j3S8CXzwZZY++/jPlz4WxrJeUl4XjCuPVE0YTrZOuk72v1r4ae81/PT+V/S/xf5W+0Xhz6S/7v7qnw6bH3greLr478F76feUHkw/tM34zzz8mf5yfzfkk/anqs8XnzrnQufH5zQu4haIvml9avnp+fbqYvLjIZwlYS14AhYxwbCwA7yoBoIQDQEV8MVFk2QsvRUDL/h1hoY9f8vL/yct+eSneDIDTbQCEIt0D6aW7AFBFOhUA4GcPQJA9gI2Nv3VEFbaUWGOjJYBITYg1KVxcfI94Q5wmAF+GFhfnmxYXv1Qgnv0xAG0flz24MBorBkC+IgznSN1mli89/v3wb7FH6K+nLwgsAAAACXBIWXMAAAsTAAALEwEAmpwYAAAgAElEQVR4Ae1dCXhURbbOvi+ELBASsrAGE/YlKIuAgiKMOII6KuO4oIzoMAszbzafTx2fy3OY1QUGlVFEFFFAgUEFZJc1EPYlkJ2QfSd78v5OdSrF7b7N7e7b0Kk+/eVrTlWdOlX113+rTp26JO5tbW1u9CEEXAYBD5cZKQ2UEDAgQIwnHrgWAsR415pvGq2XAoLmDYsUOZQkBLo0Al4zF4v9pzVeRINk+REgxss/xzRCEQFivIgGyfIjQIyXf45phCICxHgRDZLlR4AYL/8c0whFBIjxIhoky4+AMh6vOuKIKNUiKiAEnAGBkiItvaA1XgtKpCMPAsR4eeaSRqIFAWK8FpRIRx4EiPHyzCWNRAsCxHgtKJGOPAgQ4+WZSxqJFgSI8VpQIh15ECDGyzOXNBItCBDjtaBEOvIgQIyXZy5pJFoQIMZrQYl05EGAGC/PXNJItCBAjNeCEunIgwAxXp65pJFoQYAYrwUl0pEHAWK8PHNJI9GCADFeC0qkIw8CxHh55pJGogUBYrwWlEhHHgSI8fLMJY1ECwLEeC0okY48CBDj5ZlLGokWBIjxWlAiHXkQIMbLM5c0Ei0IEOO1oEQ68iBAjJdnLmkkWhAgxmtBiXTkQUDz752UZ8haR5K1/lBDeS20Q/r2iJ6QpLUa6Tk3As7F+IaK2pIjWdoR8wn2jxzVR7u+VZpZXx6uyS5BlZjbU/RifF1RVdnJXEU3vPy8/SJDAnuFeQX4KoooqTsCzsX4mtzSI/+7TvsgQ/v3dBzjtXdDu2b5mXy1AXp4e8bNGD7w0Vu9g/y0GyRNaxFwLsZb23uZ9FubWrLWHcImMPql+67buJrrGusKK9Foa1Nzz3EDr1u7N7Ah52J89+Te0zf9VoSjtbH563uMf48z7q5hyc/eIZZ2afn2Txd6+vk0lNUUHcg4u3xHS30ThlO491zlhcLQvj2uz9DS39hQsPM02sJuSYy/Pphf1Yq7h7unj+pD6O7pYaGUGQJvcNz0CvDxCQ24yrS5BI4NrQ3NfhHBsGyu3MY8jWY9fb29A33xE9Q7HPLxv/2HtVd9sUiN8W2tbfUl1T7dAq6Jg41dV68GYJtq6/3Cg9VVlCXAwcvPx9PPW1lwQ9Oq9LqhvbK68bxvj1/ee670aFZTdT2r7OHr1fOWAf3nTgiOj1CYKzuRm/HJ3pLDmXAkUITHDKQP7hM15uUHFJqmyZbG5gN/+OTK5Qo8UamvPYijM9exx2xIoqU/wdLW0pr5xcG8rcdrckqx6bm5uwVEh4UPiUuaN9m3WyDvAITsrw5nfPo9BHd39ykrnuFFWMhP/WsrS05463F0vr6sZs/CfzdWXGGZVZlFW+e+CTlu+rD+D4/nFVsamrD/FO47X5tf5tbm5h3iH5bUK2XhnQE9u3EdCPt/t6omrxRCz/EDk3869fzHewp2nK66UDhk0QwYFDVvuCwJ408t3cInj2GKxfvSd6eKD2dOXDrPPzKEAw0X4sBzq91a23gOFk44ss3tTgXPVBNOvvl16dFscG7wwuki3e00W5VVzFtEMJTLEPB0HX7pi8pzBZ2ZbW5XLpXjBw/50EUzRG+kqaah7nJlp2aH1FzXxPPbWluRjW+eY0g2G5ON1XUdldxqckoOPv9ZbV4Zz2mqqis6cGHXgvdTX/lRt6RePL+uuIpZwyycX7kbDwkvcjZBEsb7hAT0vnMoFpjAmO5gc+H+jPQ/b4CAGbr4+X6sOhz3k299w+jebVBMyjPTAmO7IwRZfvZSba5hibL8wU6Ss+kodLAKRo3pKyrbY/ZKQcW5D3cyaxEjEkP6XLXeYyCM7h4+XkN+dVfU6L5YbtMXb0S3Mbojr3056f354iMt9sqCDMRG/+l+7HXlJ/OgFhDdLXnBNIPQy7h4t7W1HX39K0b38KFxg385A77iqSVbLm07iXbPfrAj9dUHTe2XHcvJ33IC+f5RIZ7+Pvq6i6bN2ZAjCeMnLnvSQ/DFe08bUrD9FFYjIAK3mOPSVNtQm1/Okr0mDmKrVFhyLH64jppQnVV87G+bUApSDnhkoqhmm9mLa/bDRUF/4DPAbzFYHpk44rkfipbztpwwbCntn5Rnp8XePhgifJKxrz8EJwQLc0tdIx62US/MEWtpkXES6HFzfzzDTBkhUSTFirmb0yvOXkKOu5fHsN/P8o8w7JMpP7vj8q4z8AaLD16sySsLiu0uVoGM3TI4IXLEf99r6kwqNG9UUs8T240aA9oV6c66wX0D7tkj38vfByslUzi/ak/2xiOtzQZX/pofRPEOvbCGHXNH/PEeuP5iFdvMnv9o94XV+y7vOcvonvDD0XAVRE8JTRR+f441hPUy5rYU3igOHj1vMQYTi/ZnwDHjRXoJRfsymKnQAdGM7kiie9gNWH65yVUa8v17hqb+30NOS3f0UJI1HiNprLyS+82xqozL9SU1CNcg6scmRvwGUxPvGQWeIRNb8/G/bjr7/nbc+yTcM8qve5CoeZXc5pa+eAPb3wf/fLppFMg2swY77u6NlbU4EeKDVdbUB4AnzXqCG1nEc8ReBSdGssAiVlz4+lAQS+2Xa3KNTdcXVh147lNusL7UCCwXeBGE7im9LSEpqt4gWRLGIzhwfsUuFntRINl29fKXNG+Ku5fnhU+/ZysrnpOMj/dc/Gxf0hOTE2ePQYhDUR3JqotFnHmZaw9EpfZTrPHQscHs5A+eBsuP/2Nz9peHYSFj5W6cDcIGxYgdgIvPkohIivmQfYUcqOnOePgnrMX60mr8KFpH0uyaYqrmbDkyMB7OCZZqIAsi9rlvLHjjGxZ48fMDORuPmMINnaTHJ2FdB+nztxxvvtIIHTwqOJPhnj9h1ijTKiF9o3pNvok1UZKWdf6jXQo/njVtrVnWEGphqUaIA57JkVfXI7IEH4n3Ae/bsCO16JuxUoRluJp/ZDCX9RLgvVRnGiJIwYlRyQs6j/7cvq+FXZErOZ8ggx/Pmd1/7vhBT04JHxofFBfhE2KMlJtbtd0CeoQOXnjnbasW9pmTyieF2+E5XOj3o1u6D+7NkudW7CpJy+RFomCtWdTFMj/oqduYEQQcT73zrWgwOC7CWFRQ3tp+uuWl8GSYDF8oABEqkw+7xGXZJUfMd5hXMj3PBHXcY6Ch7kPiIoYnKH6c2Vnn4zIVujzjEUTDTQcbGJZ2PkIeXzedS66D+86bfnp72E1GRwLHU16kELAzDP/dLK9AX0N+m1vaK+vNbvSslnazTB+RJbi/TEb0k59WkRMxIoHlY40v3HOWyfjGplSw6wxLoi4/uIsXnCzSAp2zH+xkEUNenQveQe0jcnMzxDprOzcNKCAMytQQDoLjx6t0daHLMx6et1+48dAJT6bkaFZlxuUTb36dtfYgmxu8j4n7EaOcU7Lvtx/n/OcocvCo4ANluOmslFPf7KT6Y1v4xXRW1FhRe+SVdewkgBx4+TabZQZTfn4nPxsg1s7ey0dR/MwRIf2MF1LH/76Zxc4bEYZ/ZR1O3lDAAo+IITOCb8N1RMcHPhIu5nY+tQwnHPEYIB5sgnob9xD4VKeXbcN5AHexzEDstCEIwzMZ1wW4FsClMt5xAJ7Fhy6e/tdWPEgdTXWlf2Xw43tPH3auHX2EU/b9eiWDHxdMFafzISNove3hN8f+eS6u5TGveLkAP8iH145IZXPHwuYbHoTTp+Wpi5mcjFAgWy9L03Mw5fDCUcVOs7CAtwwS7h2dueYAZPj0CA2xVx5A6KG/+cHB5z6tL67GIXvPzz/APsP7jEh58tNTEf9GLfaB4xHQKwzeEZJg58XP9kOIHN0H97L8vR3RzcOr/+c/3s0OCTkb0vAT0q/nxCVPoBaWkiGLZh58brXh1N7mhvA8flgr7LvXlGQx2VXkLr/GA+h+D41DeBE3/+zjFxmM28Tx/3wUx02WA0a21Bs8FsM9yy0DAnuHgytwDBh1sLjG3jFk3N9/ouXmMuVndyLkzMxiry86aLjkst8sjAx8ZCJ/Twux8OwNaawVvFV267vz42aOwJUnclif8biGD0/AMVdx1Eb+yP+ZjQGyuuhY7LTBuJ/y8Da/tMEPHP3yA+ItL3eQYAHxn4n/mjfw8UmKQyqSOCzhh7XStb7dsbOLPW7esEhMdsoRV119d+Y7jYQlEC9a4WqGX5Gga3APsAtj5pAv9hQOyRXDe+GVmPKAHt1E91dUs1Z2kFneDThjuKPFWAKju5kG77kauoELUfjfeAfYglqnfpvhlUy4NDju42kRSc91mmrqsdi7e3hAAQcVnu9EQonRO1V0yWvmYjFHHsaLoyLZFRHQxngZvBpXnF0as60IEONtRY7qdU0EiPFdc96o17YiQIy3FTmq1zURIMZ3zXmjXtuKADHeVuSoXtdEgBjfNeeNem0rAsR4W5Gjel0TAWJ815w36rWtCBDjbUWO6nVNBIjxXXPeqNe2IkCMtxU5qtc1ESDGd815o17bigAx3lbkqF7XRIAY3zXnjXptKwLEeFuRo3pdEwFifNecN+q1rQgQ421Fjup1TQSI8V1z3qjXtiJAjLcVOarXNREgxnfNeaNe24oAMd5W5Khe10SAGN815416bSsCxHhbkaN6XRMBYnzXnDfqta0IEONtRY7qdU0EiPFdc96o17YiQIy3FTmq1zURMP9Lls2MReXXWJrRpCxCwIkRoDXeiSeHuuYABIjxDgCVTDoxAsR4J54c6poDECDGOwBUMunECBDjnXhyqGsOQIAY7wBQyaQTI0CMd+LJoa45AAHlXz5zQBNkUhWBvLy82NhY1WIqcAACtMY7AFRtJpuammbNmoVvbeqkpQ8CxHh9cLTBytq1a9PS0vBtQ12qYjMCxHibobO34ttvvw0T7NteW1RfMwLkx2uGSlfFkydPpqSkMJMnTpxITk7W1TwZU0WA1nhVaBxaIC7touzQRsk4EKA1/gbQoLq6OiYmBt+s7eDg4Pz8fHzfgK64XpO0xt+AOf/www853dE85BUrVtyAfrhkk7TG34BphwcPP15sGH48vHkxh2QHIUBrvIOAVTW7Y8cOBd2hihzkq9ahAv0QIMbrh6U2S2rnVLV8bVZJSysC5NVoRUoXvYKCgvj4eLP3rN7e3tnZ2dHR0bo0REbUEKA1Xg0Zh+QvW7bMLN3RGPJR6pBWyaiAAK3xAhgOFpubmxMSEhCI5O1gRceqz5MIWWZlZXl5af7v9rwmCZoRoDVeM1R2K65fv16kO5i9bt06kd8ohY7d7ZABSwgQ4y2ho2+Z4myKFyfHjBmDb7EVhY5YRLIuCBDjdYHx2kbOnDmzbds2UW/BggVIsm+eDx1o8iQJuiNAjNcdUvMGFYt3UlLSlClToIpvyGIdhaZYRLL9CBDj7cfw2hZqa2vxZoGoJy7togwdaEJfVCZZRwSI8TqCqWpq5cqVlZWVvDgwMPCRRx7hScjI4UloQp8nSdAXAWK8vniat6ZwVObOnRsaGspVISOHJyEo9MUiku1EgBhvJ4DXrr5nz5709HRR7+mnnxaTkBU50EcthQ4ldUGAGK8LjJaMKBbscePGDR06VFEBOcgXMxW1xCKS7UGAGG8PeteuW1RUtGbNGlHvmWeeEZNcVpxfUQt1eSkJeiFAjNcLSfN23n333cbGRl4WFRU1e/ZsnhSFOXPmoJTnoBbq8iQJeiFAjNcLSTN2Wlpali5dKhbMmzfPx8dHzOEy8lHKkxBQFxbEHJLtR4AYbz+GqhY2btyYk5PDiz09PefPn8+TpgJKocPzURcWeJIEXRAgxusCo3kjb731llgwc+bMuLg4MUchoxQ6YqbCglhEsm0IEONtw+3atTIyMr799ltRT3E2FYu4rNCBBdjhpSTYjwAx3n4MzVt455132traeFn//v2nTp3Kk2oCdKDJS2EBdniSBPsRIMbbj6EZC3V1dcuXLxcLcMfk7u4u5piVoaO4jYIdWDOrTJk2IECMtwG0a1dZtWpVeXk51/P393/00Ud50rIATehzHdiBNZ4kwU4EiPF2Ami+uuLG9MEHHwwLCzOvapILTeiL2QprYhHJ1iJAjLcWsWvr79+///Dhw6Ke4jwqFpmVFfqwBptmNSnTWgSI8dYidm19xZKcmpo6cuTIa1cTNKCPWkIGvU0pgmGXTIy3Cz7TyqWlpatXrxbzFQu2WGRBVtSCTVi2oE9FGhEgxmsESqvae++9V19fz7XDw8MfeOABntQuoBbqcn3YhGWeJMFmBOj31dgMnZmKra2t/fr1y8zMNFNmd1ZiYiJuozw8aJGyC0qCzy74FJU3b97sILqjIViGfUWLlLQWAWK8tYhZ0nf0azCOtm9pbLKUkVej20xiDYZLA8dGN4smhuDSwLGBe2NSQhlaEaA1XitS19RbsmSJQ+mODsA+WrlmT0jBAgK0xlsAx4FFindsxHfOHNgqmXZzozWeWOBaCBDjXWu+abTEeOKAayFAjHet+abREuOJA66FADHeteabRkuMJw64FgLEeNeabxotMZ444FoIEONda75ptMR44oBrIUCMd635ptES44kDroUAMd615ptGS4wnDrgWAsR415pvGi0xnjjgWggQ411rvmm0xHjigGshQIx3rfmm0RLjiQOuhQAx3rXmm0ZLjCcOuBYCxHjXmm8aLTGeOOBaCBDjXWu+abTEeOKAayFAjHet+abREuOJA66FADHeteabRkuMJw64FgLEeNeabxotMZ444FoIEONda75ptMR44oBrIUCMd635ptES44kDroUAMd615ptGS4wnDrgWAsR415pvGi0xnjjgWggQ411rvmm0xHjigGshQIx3rfmm0RLjiQOuhQAx3rXmm0ZLjCcOuBYCxHjXmm8aLTGeOOBaCBDjXWu+abTEeOKAayFAjHet+abREuOJA66FADHeteabRuve1tYmotC8YZGYJJkQ6OoIeM1cLA6B1ngRDZLlR4AYL/8c0whFBIjxIhoky48AMV7+OaYRiggQ40U0SJYfAWK8/HNMIxQRIMaLaJAsPwJeWocYEaVVk/QIgRuCQEmRlmZpjdeCEunIgwAxXp65pJFoQYAYrwUl0pEHAWK8PHNJI9GCADFeC0qkIw8CxHh55pJGogUBYrwWlEhHHgSI8fLMJY1ECwLEeC0okY48CBDj5ZlLGokWBIjxWlAiHXkQIMbL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" alt="Router class inheritance" /><figcaption>Router class inheritance</figcaption>
</figure>
<p>Phew! Hopefully this adventure into Backbone and JavaScript internals has taught you that although it entails learning and employing more code, it can (and should) save time down the road for those maintaining your code.</p>
<p>You can find an example of a <code>SwappingRouter</code> on the example app under <code>app/assets/javascripts/routers/tasks.js</code>. Note how each action in that router uses <code>SwappingRouter.swap()</code> to invoke rendering of views, freeing itself from the complexities of cleaning them up.</p>
</section>
</section>
<section id="composite-views" class="level2">
<h2><a href="#composite-views">Composite views</a></h2>
<p>The <code>SwappingRouter</code> above calls <code>leave()</code> on the view it currently holds. This function is not part of Backbone itself, and is part of our extension library to help make views more modular and maintainable. This section goes over the Composite View pattern, the <code>CompositeView</code> class itself, and some concerns to keep in mind while creating your views.</p>
<section id="refactoring-from-a-large-view" class="level3">
<h3><a href="#refactoring-from-a-large-view">Refactoring from a large view</a></h3>
<p>One of the first refactorings you'll find yourself doing in a non-trivial Backbone app is splitting up large views into composable parts. Let's take another look at the <code>TaskDetail</code> source code from the beginning of this section:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"># app/assets/javascripts/views/<span class="ot">task_detail</span>.<span class="fu">js</span>
<span class="fu">var</span> <span class="fu">TaskDetail</span> = <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">extend</span>({
  <span class="dt">template</span>: JST[<span class="st">'tasks/task_detail'</span>],
  <span class="dt">tagName</span>: <span class="st">'section'</span>,
  <span class="dt">id</span>: <span class="st">'task'</span>,

  <span class="dt">events</span>: {
    <span class="st">&quot;click .comments .form-inputs button&quot;</span>: <span class="st">&quot;createComment&quot;</span>
  },

  <span class="dt">initialize</span>: <span class="kw">function</span>() {
    <span class="ot">_</span>.<span class="fu">bindAll</span>(<span class="kw">this</span>, <span class="st">&quot;render&quot;</span>);

    <span class="kw">this</span>.<span class="ot">model</span>.<span class="fu">on</span>(<span class="st">&quot;change&quot;</span>, <span class="kw">this</span>.<span class="fu">render</span>);
    <span class="kw">this</span>.<span class="ot">model</span>.<span class="ot">comments</span>.<span class="fu">on</span>(<span class="st">&quot;change&quot;</span>, <span class="kw">this</span>.<span class="fu">render</span>);
    <span class="kw">this</span>.<span class="ot">model</span>.<span class="ot">comments</span>.<span class="fu">on</span>(<span class="st">&quot;add&quot;</span>,    <span class="kw">this</span>.<span class="fu">render</span>);
  },

  <span class="dt">render</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="ot">$el</span>.<span class="fu">html</span>(<span class="kw">this</span>.<span class="fu">template</span>({<span class="dt">task</span>: <span class="kw">this</span>.<span class="fu">model</span>}));
  },

  <span class="dt">createComment</span>: <span class="kw">function</span>() {
    <span class="kw">var</span> comment = <span class="kw">new</span> <span class="fu">Comment</span>({ <span class="dt">text</span>: <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'.new-comment-input'</span>).<span class="fu">val</span>() });
    <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'.new-comment-input'</span>).<span class="fu">val</span>(<span class="st">''</span>);
    <span class="kw">this</span>.<span class="ot">model</span>.<span class="ot">comments</span>.<span class="fu">create</span>(comment);
  }
});</code></pre>
<p>The view class references a template, which renders out the HTML for this page:</p>
<pre><code># app/assets/templates/task_detail.jst.ejs
&lt;section class=&quot;task-details&quot;&gt;
  &lt;input type=&quot;checkbox&quot;&lt;%= task.isComplete() ? ' checked=&quot;checked&quot;' : '' %&gt; /&gt;
  &lt;h2&gt;&lt;%= task.escape(&quot;title&quot;) %&gt;&lt;/h2&gt;
&lt;/section&gt;

&lt;section class=&quot;comments&quot;&gt;
  &lt;ul&gt;
    &lt;% task.comments.each(function(comment) { %&gt;
      &lt;li&gt;
        &lt;h4&gt;&lt;%= comment.user.escape('name') %&gt;&lt;/h4&gt;
        &lt;p&gt;&lt;%= comment.escape('text') %&gt;&lt;/p&gt;
      &lt;/li&gt;
    &lt;% } %&gt;
  &lt;/ul&gt;

  &lt;div class=&quot;form-inputs&quot;&gt;
    &lt;label for=&quot;new-comment-input&quot;&gt;Add comment&lt;/label&gt;
    &lt;textarea id=&quot;new-comment-input&quot; cols=&quot;30&quot; rows=&quot;10&quot;&gt;&lt;/textarea&gt;
    &lt;button&gt;Add Comment&lt;/button&gt;
  &lt;/div&gt;
&lt;/section&gt;</code></pre>
<p>There are clearly several concerns going on here: rendering the task, rendering the comments that folks have left, and rendering the form to create new comments. Let's separate those concerns. A first approach might be to just break up the template files:</p>
<pre class="sourceCode rhtml"><code class="sourceCode rhtml"><span class="co">&lt;!-- app/assets/templates/tasks/show.jst.ejs --&gt;</span>
<span class="kw">&lt;section</span><span class="ot"> class=</span><span class="st">&quot;task-details&quot;</span><span class="kw">&gt;</span>
  <span class="kw">&lt;%=</span> <span class="dt">JST</span><span class="ch">[</span><span class="st">'tasks/details'</span><span class="ch">]</span>(<span class="ch">{</span> task: task <span class="ch">}</span>) <span class="kw">%&gt;</span>
<span class="kw">&lt;/section&gt;</span>

<span class="kw">&lt;section</span><span class="ot"> class=</span><span class="st">&quot;comments&quot;</span><span class="kw">&gt;</span>
  <span class="kw">&lt;%=</span> <span class="dt">JST</span><span class="ch">[</span><span class="st">'comments/list'</span><span class="ch">]</span>(<span class="ch">{</span> task: task <span class="ch">}</span>) <span class="kw">%&gt;</span>
<span class="kw">&lt;/section&gt;</span></code></pre>
<pre class="sourceCode rhtml"><code class="sourceCode rhtml"><span class="co">&lt;!-- app/assets/templates/tasks/details.jst.ejs --&gt;</span>
<span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&quot;checkbox&quot;</span><span class="kw">&lt;%=</span> task.isComplete()<span class="ch"> ? </span><span class="st">' checked=&quot;checked&quot;'</span><span class="ch"> : </span><span class="st">''</span> <span class="kw">%&gt;</span> <span class="kw">/&gt;</span>
<span class="kw">&lt;h2&gt;&lt;%=</span> task.escape(<span class="st">&quot;title&quot;</span>) <span class="kw">%&gt;&lt;/h2&gt;</span></code></pre>
<pre class="sourceCode rhtml"><code class="sourceCode rhtml"><span class="co">&lt;!-- app/assets/templates/comments/list.jst.ejs --&gt;</span>
<span class="kw">&lt;ul&gt;</span>
  <span class="kw">&lt;%</span> task.comments.each(function(comment) <span class="ch">{</span> <span class="kw">%&gt;</span>
    <span class="kw">&lt;%=</span> <span class="dt">JST</span><span class="ch">[</span><span class="st">'comments/item'</span><span class="ch">]</span>(<span class="ch">{</span> comment: comment <span class="ch">}</span>) <span class="kw">%&gt;</span>
  <span class="kw">&lt;%</span> <span class="ch">}</span> <span class="kw">%&gt;</span>
<span class="kw">&lt;/ul&gt;</span>

<span class="kw">&lt;%=</span> <span class="dt">JST</span><span class="ch">[</span><span class="st">'comments/new'</span><span class="ch">]</span>() <span class="kw">%&gt;</span></code></pre>
<pre class="sourceCode rhtml"><code class="sourceCode rhtml"><span class="co">&lt;!-- app/assets/templates/comments/item.jst.ejs --&gt;</span>
<span class="kw">&lt;h4&gt;&lt;%=</span> comment.user.escape(<span class="st">'name'</span>) <span class="kw">%&gt;&lt;/h4&gt;</span>
<span class="kw">&lt;p&gt;&lt;%=</span> comment.escape(<span class="st">'text'</span>) <span class="kw">%&gt;&lt;/p&gt;</span></code></pre>
<pre class="sourceCode rhtml"><code class="sourceCode rhtml"><span class="co">&lt;!-- app/assets/templates/comments/new.jst.ejs --&gt;</span>
<span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;form-inputs&quot;</span><span class="kw">&gt;</span>
  <span class="kw">&lt;label</span><span class="ot"> for=</span><span class="st">&quot;new-comment-input&quot;</span><span class="kw">&gt;</span>Add comment<span class="kw">&lt;/label&gt;</span>
  <span class="kw">&lt;textarea</span><span class="ot"> id=</span><span class="st">&quot;new-comment-input&quot;</span><span class="ot"> cols=</span><span class="st">&quot;30&quot;</span><span class="ot"> rows=</span><span class="st">&quot;10&quot;</span><span class="kw">&gt;&lt;/textarea&gt;</span>
  <span class="kw">&lt;button&gt;</span>Add Comment<span class="kw">&lt;/button&gt;</span>
<span class="kw">&lt;/div&gt;</span></code></pre>
<p>But this is really only half the story. The <code>TaskDetail</code> view class still handles multiple concerns, such as displaying the task and creating comments. Let's split that view class up, using the <code>CompositeView</code> base class:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"># app/assets/javascripts/support/<span class="ot">composite_view</span>.<span class="fu">js</span>
<span class="ot">Support</span>.<span class="fu">CompositeView</span> = <span class="kw">function</span>(options) {
  <span class="kw">this</span>.<span class="fu">children</span> = <span class="fu">_</span>([]);
  <span class="kw">this</span>.<span class="fu">bindings</span> = <span class="fu">_</span>([]);
  <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">apply</span>(<span class="kw">this</span>, [options]);
};

<span class="ot">_</span>.<span class="fu">extend</span>(<span class="ot">Support</span>.<span class="ot">CompositeView</span>.<span class="fu">prototype</span>, <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">prototype</span>, {
  <span class="dt">leave</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="fu">unbind</span>();
    <span class="kw">this</span>.<span class="fu">unbindFromAll</span>();
    <span class="kw">this</span>.<span class="fu">remove</span>();
    <span class="kw">this</span>.<span class="fu">_leaveChildren</span>();
    <span class="kw">this</span>.<span class="fu">_removeFromParent</span>();
  },

  <span class="dt">bindTo</span>: <span class="kw">function</span>(source, event, callback) {
    <span class="ot">source</span>.<span class="fu">bind</span>(event, callback, <span class="kw">this</span>);
    <span class="kw">this</span>.<span class="ot">bindings</span>.<span class="fu">push</span>({ <span class="dt">source</span>: source, <span class="dt">event</span>: event, <span class="dt">callback</span>: callback });
  },

  <span class="dt">unbindFromAll</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="ot">bindings</span>.<span class="fu">each</span>(<span class="kw">function</span>(binding) {
      <span class="ot">binding</span>.<span class="ot">source</span>.<span class="fu">unbind</span>(<span class="ot">binding</span>.<span class="fu">event</span>, <span class="ot">binding</span>.<span class="fu">callback</span>);
    });
    <span class="kw">this</span>.<span class="fu">bindings</span> = <span class="fu">_</span>([]);
  },

  <span class="dt">renderChild</span>: <span class="kw">function</span>(view) {
    <span class="ot">view</span>.<span class="fu">render</span>();
    <span class="kw">this</span>.<span class="ot">children</span>.<span class="fu">push</span>(view);
    <span class="ot">view</span>.<span class="fu">parent</span> = <span class="kw">this</span>;
  },

  <span class="dt">renderChildInto</span>: <span class="kw">function</span>(view, container) {
    <span class="kw">this</span>.<span class="fu">renderChild</span>(view);
    <span class="fu">$</span>(container).<span class="fu">empty</span>().<span class="fu">append</span>(<span class="ot">view</span>.<span class="fu">el</span>);
  },

  <span class="dt">appendChild</span>: <span class="kw">function</span>(view) {
    <span class="kw">this</span>.<span class="fu">renderChild</span>(view);
    <span class="fu">$</span>(<span class="kw">this</span>.<span class="fu">el</span>).<span class="fu">append</span>(<span class="ot">view</span>.<span class="fu">el</span>);
  },

  <span class="dt">appendChildTo</span>: <span class="kw">function</span> (view, container) {
    <span class="kw">this</span>.<span class="fu">renderChild</span>(view);
    <span class="fu">$</span>(container).<span class="fu">append</span>(<span class="ot">view</span>.<span class="fu">el</span>);
  },

  <span class="dt">prependChild</span>: <span class="kw">function</span>(view) {
    <span class="kw">this</span>.<span class="fu">renderChild</span>(view);
    <span class="fu">$</span>(<span class="kw">this</span>.<span class="fu">el</span>).<span class="fu">prepend</span>(<span class="ot">view</span>.<span class="fu">el</span>);
  },

  <span class="dt">prependChildTo</span>: <span class="kw">function</span> (view, container) {
    <span class="kw">this</span>.<span class="fu">renderChild</span>(view);
    <span class="fu">$</span>(container).<span class="fu">prepend</span>(<span class="ot">view</span>.<span class="fu">el</span>);
  },

  <span class="dt">_leaveChildren</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="ot">children</span>.<span class="fu">chain</span>().<span class="fu">clone</span>().<span class="fu">each</span>(<span class="kw">function</span>(view) {
      <span class="kw">if</span> (<span class="ot">view</span>.<span class="fu">leave</span>)
        <span class="ot">view</span>.<span class="fu">leave</span>();
    });
  },

  <span class="dt">_removeFromParent</span>: <span class="kw">function</span>() {
    <span class="kw">if</span> (<span class="kw">this</span>.<span class="fu">parent</span>)
      <span class="kw">this</span>.<span class="ot">parent</span>.<span class="fu">_removeChild</span>(<span class="kw">this</span>);
  },

  <span class="dt">_removeChild</span>: <span class="kw">function</span>(view) {
    <span class="kw">var</span> index = <span class="kw">this</span>.<span class="ot">children</span>.<span class="fu">indexOf</span>(view);
    <span class="kw">this</span>.<span class="ot">children</span>.<span class="fu">splice</span>(index, <span class="dv">1</span>);
  }
});

<span class="ot">Support</span>.<span class="ot">CompositeView</span>.<span class="fu">extend</span> = <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">extend</span>;</code></pre>
<p>Similar to the <code>SwappingRouter</code>, the <code>CompositeView</code> base class solves common housekeeping problems by establishing a convention. See the &quot;SwappingRouter and Backbone internals&quot; section for an in-depth analysis of how this subclassing pattern works.</p>
<p>Now our <code>CompositeView</code> maintains an array of its immediate children as <code>this.children</code>. With this reference in place, a parent view's <code>leave()</code> method can invoke <code>leave()</code> on its children, ensuring that an entire tree of composed views is cleaned up properly.</p>
<p>For child views that can dismiss themselves, such as dialog boxes, children maintain a back-reference at <code>this.parent</code>. This is used to reach up and call <code>this.parent.removeChild(this)</code> for these self-dismissing views.</p>
<p>Making use of <code>CompositeView</code>, we split up the <code>TaskDetail</code> view class:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> TaskDetail = <span class="ot">Support</span>.<span class="ot">CompositeView</span>.<span class="fu">extend</span>({
  <span class="dt">tagName</span>: <span class="st">'section'</span>,
  <span class="dt">id</span>: <span class="st">'task'</span>,

  <span class="dt">initialize</span>: <span class="kw">function</span>() {
    <span class="ot">_</span>.<span class="fu">bindAll</span>(<span class="kw">this</span>, <span class="st">&quot;renderDetails&quot;</span>);
    <span class="kw">this</span>.<span class="ot">model</span>.<span class="fu">on</span>(<span class="st">&quot;change&quot;</span>, <span class="kw">this</span>.<span class="fu">renderDetails</span>);
  },

  <span class="dt">render</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="fu">renderLayout</span>();
    <span class="kw">this</span>.<span class="fu">renderDetails</span>();
    <span class="kw">this</span>.<span class="fu">renderCommentsList</span>();
  },

  <span class="dt">renderLayout</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="ot">$el</span>.<span class="fu">html</span>(JST[<span class="st">'tasks/show'</span>]());
  },

  <span class="dt">renderDetails</span>: <span class="kw">function</span>() {
    <span class="kw">var</span> detailsMarkup = JST[<span class="st">'tasks/details'</span>]({ <span class="dt">task</span>: <span class="kw">this</span>.<span class="fu">model</span> });
    <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'.task-details'</span>).<span class="fu">html</span>(detailsMarkup);
  },

  <span class="dt">renderCommentsList</span>: <span class="kw">function</span>() {
    <span class="kw">var</span> commentsList = <span class="kw">new</span> <span class="fu">CommentsList</span>({ <span class="dt">model</span>: <span class="kw">this</span>.<span class="fu">model</span> });
    <span class="kw">var</span> commentsContainer = <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'comments'</span>);
    <span class="kw">this</span>.<span class="fu">renderChildInto</span>(commentsList, commentsContainer);
  }
});</code></pre>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> CommentsList = <span class="ot">Support</span>.<span class="ot">CompositeView</span>.<span class="fu">extend</span>({
  <span class="dt">tagName</span>: <span class="st">'ul'</span>,

  <span class="dt">initialize</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="ot">model</span>.<span class="ot">comments</span>.<span class="fu">on</span>(<span class="st">&quot;add&quot;</span>, <span class="kw">this</span>.<span class="fu">renderComments</span>);
  },

  <span class="dt">render</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="fu">renderLayout</span>();
    <span class="kw">this</span>.<span class="fu">renderComments</span>();
    <span class="kw">this</span>.<span class="fu">renderCommentForm</span>();
  },

  <span class="dt">renderLayout</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="ot">$el</span>.<span class="fu">html</span>(JST[<span class="st">'comments/list'</span>]());
  },

  <span class="dt">renderComments</span>: <span class="kw">function</span>() {
    <span class="kw">var</span> commentsContainer = <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'comments-list'</span>);
    <span class="ot">commentsContainer</span>.<span class="fu">html</span>(<span class="st">''</span>);

    <span class="kw">this</span>.<span class="ot">model</span>.<span class="ot">comments</span>.<span class="fu">each</span>(<span class="kw">function</span>(comment) {
      <span class="kw">var</span> commentMarkup = JST[<span class="st">'comments/item'</span>]({ <span class="dt">comment</span>: comment });
      <span class="ot">commentsContainer</span>.<span class="fu">append</span>(commentMarkup);
    });
  },

  <span class="dt">renderCommentForm</span>: <span class="kw">function</span>() {
    <span class="kw">var</span> commentForm = <span class="kw">new</span> <span class="fu">CommentForm</span>({ <span class="dt">model</span>: <span class="kw">this</span>.<span class="fu">model</span> });
    <span class="kw">var</span> commentFormContainer = <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'.new-comment-form'</span>);
    <span class="kw">this</span>.<span class="fu">renderChildInto</span>(commentForm, commentFormContainer);
  }
});</code></pre>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> CommentForm = <span class="ot">Support</span>.<span class="ot">CompositeView</span>.<span class="fu">extend</span>({
  <span class="dt">events</span>: {
    <span class="st">&quot;click button&quot;</span>: <span class="st">&quot;createComment&quot;</span>
  },

  <span class="dt">initialize</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="fu">model</span> = <span class="kw">this</span>.<span class="ot">options</span>.<span class="fu">model</span>;
  },

  <span class="dt">render</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="ot">$el</span>.<span class="fu">html</span>(JST[<span class="st">'comments/new'</span>]);
  },

  <span class="dt">createComment</span>: <span class="kw">function</span>() {
    <span class="kw">var</span> comment = <span class="kw">new</span> <span class="fu">Comment</span>({ <span class="dt">text</span>: <span class="fu">$</span>(<span class="st">'.new-comment-input'</span>).<span class="fu">val</span>() });
    <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'.new-comment-input'</span>).<span class="fu">val</span>(<span class="st">''</span>);
    <span class="kw">this</span>.<span class="ot">model</span>.<span class="ot">comments</span>.<span class="fu">create</span>(comment);
  }
});</code></pre>
<p>Along with this, remove the <code>&lt;%= JST(...) %&gt;</code> template nestings, allowing the view classes to assemble the templates instead. In this case, each template contains placeholder elements that are used to wrap child views:</p>
<pre class="sourceCode rhtml"><code class="sourceCode rhtml"><span class="co">&lt;!-- app/assets/templates/tasks/show.jst.ejs --&gt;</span>
<span class="kw">&lt;section</span><span class="ot"> class=</span><span class="st">&quot;task-details&quot;</span><span class="kw">&gt;</span>
<span class="kw">&lt;/section&gt;</span>

<span class="kw">&lt;section</span><span class="ot"> class=</span><span class="st">&quot;comments&quot;</span><span class="kw">&gt;</span>
<span class="kw">&lt;/section&gt;</span></code></pre>
<pre class="sourceCode rhtml"><code class="sourceCode rhtml"><span class="co">&lt;!-- app/assets/templates/tasks/details.jst.ejs --&gt;</span>
<span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&quot;checkbox&quot;</span><span class="kw">&lt;%=</span> task.isComplete()<span class="ch"> ? </span><span class="st">' checked=&quot;checked&quot;'</span><span class="ch"> : </span><span class="st">''</span> <span class="kw">%&gt;</span> <span class="kw">/&gt;</span>
<span class="kw">&lt;h2&gt;&lt;%=</span> task.escape(<span class="st">&quot;title&quot;</span>) <span class="kw">%&gt;&lt;/h2&gt;</span></code></pre>
<pre class="sourceCode rhtml"><code class="sourceCode rhtml"><span class="co">&lt;!-- app/assets/templates/comments/list.jst.ejs --&gt;</span>
<span class="kw">&lt;ul</span><span class="ot"> class=</span><span class="st">&quot;comments-list&quot;</span><span class="kw">&gt;</span>
<span class="kw">&lt;/ul&gt;</span>

<span class="kw">&lt;section</span><span class="ot"> class=</span><span class="st">&quot;new-comment-form&quot;</span><span class="kw">&gt;</span>
<span class="kw">&lt;/section&gt;</span></code></pre>
<pre class="sourceCode rhtml"><code class="sourceCode rhtml"><span class="co">&lt;!-- app/assets/templates/comments/item.jst.ejs --&gt;</span>
<span class="kw">&lt;h4&gt;&lt;%=</span> comment.user.escape(<span class="st">'name'</span>) <span class="kw">%&gt;&lt;/h4&gt;</span>
<span class="kw">&lt;p&gt;&lt;%=</span> comment.escape(<span class="st">'text'</span>) <span class="kw">%&gt;&lt;/p&gt;</span></code></pre>
<pre class="sourceCode rhtml"><code class="sourceCode rhtml"><span class="co">&lt;!-- app/assets/templates/comments/new.jst.ejs --&gt;</span>
<span class="kw">&lt;label</span><span class="ot"> for=</span><span class="st">&quot;new-comment-input&quot;</span><span class="kw">&gt;</span>Add comment<span class="kw">&lt;/label&gt;</span>
<span class="kw">&lt;textarea</span><span class="ot"> class=</span><span class="st">&quot;new-comment-input&quot;</span><span class="ot"> cols=</span><span class="st">&quot;30&quot;</span><span class="ot"> rows=</span><span class="st">&quot;10&quot;</span><span class="kw">&gt;&lt;/textarea&gt;</span>
<span class="kw">&lt;button&gt;</span>Add Comment<span class="kw">&lt;/button&gt;</span></code></pre>
<p>There are several advantages to this approach:</p>
<ul>
<li>Each view class has a smaller and more cohesive set of responsibilities</li>
<li>The comments view code, extracted and decoupled from the task view code, can now be reused on other domain objects with comments</li>
<li>The task view performs better, since adding new comments or updating the task details will only re-render the pertinent section, instead of re-rendering the entire composite of task and comments</li>
</ul>
<p>In the example app, we make use of a composite view on <code>TasksIndex</code> located at <code>app/assets/javascripts/views/tasks_index.js</code>. The situation is similar to what has been discussed here. The view responsible for rendering the list of children will actually render them as children. Note how the <code>renderTasks</code> function iterates over the collection of tasks, instantiates a <code>TaskItem</code> view for each, renders it as a child with <code>renderChild</code>, and finally appends it to table's body. Now, when the router cleans up the <code>TasksIndex</code> with <code>leave</code>, it will also clean up all of its children.</p>
</section>
<section id="cleaning-up-views-properly" class="level3">
<h3><a href="#cleaning-up-views-properly">Cleaning up views properly</a></h3>
<p>You've learned how leaving lingering events bound on views that are no longer on the page can cause both UI bugs or, what's probably worse, memory leaks. A slight flickering of the interface is annoying at best, but prolonged usage of your &quot;untidy&quot; app could, in fact, make the user's browser start consuming massive amounts of memory, potentially causing browser crashes, data loss and unhappy users and angry developers.</p>
<p>We now have a full set of tools to clean up views properly. To summarize, the big picture tools are:</p>
<ul>
<li>A <em>Swapping Router</em> that keeps track of the current view and tells it to clean up before it swaps in a new view</li>
<li>A <em>Composite View</em> that keeps track of its child views so it can tell them to clean up when it is cleaning itself up</li>
</ul>
<p>The <code>leave()</code> function ties this all together. A call to <code>leave()</code> can either come from a <code>SwappingRouter</code> or from a parent <code>CompositeView</code>. A <code>CompositeView</code> will respond to <code>leave()</code> by passing that call down to its children. At each level, in addition to propagating the call, <code>leave()</code> handles the task of completely cleaning up after a view by removing the corresponding element from the DOM via jQuery's <code>remove()</code> function, and removing all event bindings via a call to <code>Backbone.Events.off()</code>. In this way a single call at the top level cleans the slate for an entirely new view.</p>
</section>
</section>
<section id="forms" class="level2">
<h2><a href="#forms">Forms</a></h2>
<p>Who likes writing form code by hand? Nobody, that's who. Rails' form builder API greatly helps reduce application code, and we aim to maintain a similar level of abstraction in our Backbone application code. Let's take a look at what we need from form building code to achieve this.</p>
<p>We have a few requirements when it comes to handling forms. We need to:</p>
<ul>
<li>Build form markup and populate it with model values</li>
<li>Serialize a form into a model for validation and persistence</li>
<li>Display error messages</li>
</ul>
<p>Additionally, it's nice to:</p>
<ul>
<li>Reduce boilerplate</li>
<li>Render consistent and stylable markup</li>
<li>Automatically build form structure from data structure</li>
</ul>
<p>Let's look at the requirements one by one and compare approaches.</p>
<section id="building-markup" class="level3">
<h3><a href="#building-markup">Building markup</a></h3>
<p>Our first requirement is the ability to build markup. For example, consider a Rails model <code>User</code> that has a username and password. We might want to build form markup that looks like this:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="co">&lt;!-- app/templates/users/form.jst.ejs --&gt;</span>
<span class="kw">&lt;form&gt;</span>
  <span class="kw">&lt;li&gt;</span>
    <span class="kw">&lt;label</span><span class="ot"> for=</span><span class="st">&quot;email&quot;</span><span class="kw">&gt;</span>Email<span class="kw">&lt;/label&gt;</span>
    <span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> id=</span><span class="st">&quot;email&quot;</span><span class="ot"> name=</span><span class="st">&quot;email&quot;</span><span class="kw">&gt;</span>
  <span class="kw">&lt;/li&gt;</span>
  <span class="kw">&lt;li&gt;</span>
    <span class="kw">&lt;label</span><span class="ot"> for=</span><span class="st">&quot;password&quot;</span><span class="kw">&gt;</span>Password<span class="kw">&lt;/label&gt;</span>
    <span class="kw">&lt;input</span><span class="ot"> type=</span><span class="st">&quot;password&quot;</span><span class="ot"> id=</span><span class="st">&quot;password&quot;</span><span class="ot"> name=</span><span class="st">&quot;password&quot;</span><span class="kw">&gt;</span>
  <span class="kw">&lt;/li&gt;</span>
<span class="kw">&lt;/form&gt;</span></code></pre>
<p>One approach you could take is writing the full form markup by hand. You could create a template available to Backbone via JST that contains the raw HTML. If you took the above markup and saved it into <code>app/templates/users/form.jst.ejs</code>, it would be accessible as <code>JST[&quot;users/form&quot;]()</code>.</p>
<p>You <em>could</em> write all the HTML by hand, but we'd like to avoid that.</p>
<p>Another route that might seem appealing is reusing the Rails form builders through the asset pipeline. Consider <code>app/templates/users/form.jst.ejs.erb</code> which is processed first with ERB, and then made available as a JST template. There are a few concerns to address, such as including changing the EJS or ERB template delimiters <code>&lt;% %&gt;</code> to not conflict and mixing the Rails helper modules into the <code>Tilt::ERbTemplate</code> rendering context. However, this approach still only generates markup; it doesn't serialize forms into data hashes or Backbone models.</p>
</section>
<section id="serializing-forms" class="level3">
<h3><a href="#serializing-forms">Serializing forms</a></h3>
<p>The second requirement in building forms is to serialize them into objects suitable for setting Backbone model attributes. Assuming the markup we discussed above, you could approach this manually:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> serialize = <span class="kw">function</span>(form) {
  <span class="kw">var</span> elements = <span class="fu">$</span>(<span class="st">'input, select, textarea'</span>, form);

  <span class="kw">var</span> serializer = <span class="kw">function</span>(attributes, element) {
    <span class="kw">var</span> element = <span class="fu">$</span>(element);
    attributes[<span class="ot">element</span>.<span class="fu">attr</span>(<span class="st">'name'</span>)] = <span class="ot">element</span>.<span class="fu">val</span>();
  };

  <span class="kw">return</span> <span class="ot">_</span>.<span class="fu">inject</span>(elements, serializer, []);
};

<span class="kw">var</span> form = <span class="fu">$</span>(<span class="st">'form'</span>);
<span class="kw">var</span> model = <span class="kw">new</span> <span class="ot">MyApp</span>.<span class="ot">Models</span>.<span class="fu">User</span>();
<span class="kw">var</span> attributes = <span class="fu">serialize</span>(form);
<span class="ot">model</span>.<span class="fu">set</span>(attributes);</code></pre>
<p>This gets you started, but has a few shortcomings. It doesn't handle nested attributes, doesn't handle typing (consider a date picker input; ideally it would set a Backbone model's attribute to a JavaScript Date instance), and will include any <code>&lt;input type=&quot;submit&quot;&gt;</code> elements when constructing the attribute hash.</p>
</section>
<section id="a-backbone-forms-library" class="level3">
<h3><a href="#a-backbone-forms-library">A Backbone forms library</a></h3>
<p>If you want to avoid writing form markup by hand, your best bet is to use a JavaScript form builder. Since the model data is being read and written by Backbone views and models, it's ideal to have markup construction and form serialization implemented on the client side.</p>
<p>One solid implementation is <a href="https://github.com/powmedia/backbone-forms"><code>backbone-forms</code> by Charles Davison</a>. It provides markup construction and serialization, as well as a method for declaring a typed schema to support both of those facilities. It offers a flexible system for adding custom editor types, and supports configuring your form markup structure by providing HTML template fragments.</p>
</section>
<section id="display-server-errors" class="level3">
<h3><a href="#display-server-errors">Display server errors</a></h3>
<p>We are assuming, with a hybrid Rails/Backbone application, that at least some of your business logic resides on the server. Let's take a look at the client/server interaction that takes place when a user of the example application creates a task.</p>
<p>The client side interface for creating a new task is structured similarly to a traditional Rails form. Although moderated by Backbone views and models, essentially there is a form whose contents are submitted to the Rails server, where attributes are processed and a response is generated.</p>
<p>Let's add a validation to the Task Rails model, ensuring each task has something entered for the title:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby">  validates <span class="st">:title</span>, <span class="st">:presence</span> =&gt; <span class="dv">true</span></code></pre>
<p>Now, if you create a task without a title, the Rails <code>TasksController</code> still delivers a response:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="kw">def</span> create
  respond_with(current_user.tasks.create(params[<span class="st">:task</span>]))
<span class="kw">end</span></code></pre>
<p>but the response now returns with an HTTP response code of 422 and a JSON response body of <code>{&quot;title&quot;:[&quot;can't be blank&quot;]}</code>.</p>
<p>Establishing a few conventions, we can display these per-field errors alongside their corresponding form inputs. We'll establish a few conventions that, when we can adhere to them, allow us to render the Rails validation errors inline on the form. Depending on how you structure markup in your application, you can employ a variation on this approach.</p>
<p>For an example, let's examine a form field modeled after Formtastic conventions:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;form</span><span class="ot"> id=</span><span class="st">&quot;example_form&quot;</span><span class="kw">&gt;</span>
  <span class="kw">&lt;ol&gt;</span>
    <span class="kw">&lt;li</span><span class="ot"> id=</span><span class="st">&quot;task_title_input&quot;</span><span class="kw">&gt;</span>
      <span class="kw">&lt;label</span><span class="ot"> for=</span><span class="st">&quot;task_title&quot;</span><span class="kw">&gt;</span>Title<span class="kw">&lt;/label&gt;</span>
      <span class="kw">&lt;input</span><span class="ot"> id=</span><span class="st">&quot;task_title&quot;</span><span class="ot"> name=</span><span class="st">&quot;title&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="kw">&gt;</span>
      <span class="co">&lt;!--</span>
<span class="co">        &lt;p class=&quot;inline-errors&quot;&gt;</span>
<span class="co">          The error for this field will be rendered here.</span>
<span class="co">        &lt;/p&gt;</span>
<span class="co">      --&gt;</span>
    <span class="kw">&lt;/li&gt;</span>
  <span class="kw">&lt;/ol&gt;</span>
<span class="kw">&lt;/form&gt;</span></code></pre>
<p>Elsewhere, likely in a view class, when a user triggers a save action in the interface, we save the form's corresponding model. If the <code>save()</code> fails, we'll parse the model attributes and corresponding error(s) from the server's response and render an <code>ErrorView</code>.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> formField = <span class="fu">$</span>(<span class="st">'form#example_form'</span>);

<span class="ot">model</span>.<span class="fu">on</span>(<span class="st">'error'</span>, <span class="kw">function</span>(model, response, options) {
  <span class="kw">var</span> attributesWithErrors = <span class="ot">JSON</span>.<span class="fu">parse</span>(<span class="ot">response</span>.<span class="fu">responseText</span>);

  <span class="kw">new</span> <span class="fu">ErrorView</span>({
    <span class="dt">el</span>: formField,
    <span class="dt">attributesWithErrors</span>: attributesWithErrors
  }).<span class="fu">render</span>();
});

<span class="ot">model</span>.<span class="fu">save</span>();</code></pre>
<p>The <code>ErrorView</code> iterates over the response attributes and their errors (there may be more than one error per model attribute), rendering them inline into the form. The <code>ErrorView</code> also adds the <code>error</code> CSS class to the <code>&lt;li&gt;</code> field container:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/error_view.js</span>
ErrorView = <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">extend</span>({
  <span class="dt">initialize</span>: <span class="kw">function</span>(options) {
    <span class="kw">this</span>.<span class="fu">attributesWithErrors</span> = <span class="kw">this</span>.<span class="ot">options</span>.<span class="fu">attributesWithErrors</span>;
    <span class="ot">_</span>.<span class="fu">bindAll</span>(<span class="kw">this</span>, <span class="st">&quot;clearErrors&quot;</span>, <span class="st">&quot;renderErrors&quot;</span>, <span class="st">&quot;renderError&quot;</span>, <span class="st">&quot;fieldFor&quot;</span>);
  },

  <span class="dt">render</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="fu">clearOldErrors</span>();
    <span class="kw">this</span>.<span class="fu">renderErrors</span>();
  },

  <span class="dt">clearOldErrors</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">&quot;.error&quot;</span>).<span class="fu">removeClass</span>(<span class="st">&quot;error&quot;</span>);
    <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">&quot;p.inline-errors&quot;</span>).<span class="fu">remove</span>();
  },

  <span class="dt">renderErrors</span>: <span class="kw">function</span>() {
    <span class="ot">_</span>.<span class="fu">each</span>(<span class="kw">this</span>.<span class="fu">attributesWithErrors</span>, <span class="kw">this</span>.<span class="fu">renderError</span>);
  },

  <span class="dt">renderError</span>: <span class="kw">function</span>(errors, attribute) {
    <span class="kw">var</span> errorString = <span class="ot">errors</span>.<span class="fu">join</span>(<span class="st">&quot;, &quot;</span>);
    <span class="kw">var</span> field = <span class="kw">this</span>.<span class="fu">fieldFor</span>(attribute);
    <span class="kw">var</span> errorTag = <span class="fu">$</span>(<span class="st">'&lt;p&gt;'</span>).<span class="fu">addClass</span>(<span class="st">'inline-errors'</span>).<span class="fu">text</span>(errorString);
    <span class="ot">field</span>.<span class="fu">append</span>(errorTag);
    <span class="ot">field</span>.<span class="fu">addClass</span>(<span class="st">&quot;error&quot;</span>);
  },

  <span class="dt">fieldFor</span>: <span class="kw">function</span>(attribute) {
    <span class="kw">return</span> <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'li[id*=&quot;_'</span> + attribute + <span class="st">'_input&quot;]'</span>);
  }
});</code></pre>
</section>
</section>
<section id="internationalization" class="level2">
<h2><a href="#internationalization">Internationalization</a></h2>
<p>When you move your application's view logic onto the client, such as with Backbone, you quickly find that the library support for views is not as comprehensive as what you have on the server. The http://guides.rubyonrails.org/i18n.html[Rails internationalization (i18n) API], provided via the https://rubygems.org/gems/i18n[i18n gem], is not automatically available to client-side view rendering. We'd like to take advantage of that framework, as well as any localization work you've done, if you are adding Backbone into an existing app.</p>
<p>There is a JavaScript library, available with Rails support as a Ruby gem https://github.com/fnando/i18n-js[<code>i18n-js</code>], that provides access to your i18n content as a JavaScript object, similar to the way the JST object provides access to your templates.</p>
<p>From the documentation, you can link the client-side locale to the server-side locale:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;script</span><span class="ot"> type=</span><span class="st">&quot;text/javascript&quot;</span><span class="kw">&gt;</span>
  <span class="ot">I18n</span>.<span class="fu">defaultLocale</span> = <span class="st">&quot;&lt;%= I18n.default_locale %&gt;&quot;</span>;
  <span class="ot">I18n</span>.<span class="fu">locale</span> = <span class="st">&quot;&lt;%= I18n.locale %&gt;&quot;</span>;
<span class="kw">&lt;/script&gt;</span></code></pre>
<p>...and then use the <code>I18n</code> JavaScript object to provide translations:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// translate with your default locale</span>
<span class="ot">I18n</span>.<span class="fu">t</span>(<span class="st">&quot;some.scoped.translation&quot;</span>);

<span class="co">// translate with explicit setting of locale</span>
<span class="ot">I18n</span>.<span class="fu">t</span>(<span class="st">&quot;some.scoped.translation&quot;</span>, {<span class="dt">locale</span>: <span class="st">&quot;fr&quot;</span>});</code></pre>
<p>You can use the <code>I18n.t()</code> function inside your templates, too:</p>
<pre class="sourceCode rhtml"><code class="sourceCode rhtml"><span class="kw">&lt;nav&gt;</span>
  <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;#/&quot;</span><span class="kw">&gt;&lt;%=</span> <span class="dt">I18n</span>.t(<span class="st">&quot;nav.links.home&quot;</span>) <span class="kw">%&gt;&lt;/a&gt;</span>
  <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;#/projects&quot;</span><span class="kw">&gt;&lt;%=</span> <span class="dt">I18n</span>.t(<span class="st">&quot;nav.links.projects&quot;</span>) <span class="kw">%&gt;&lt;/a&gt;</span>
  <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;#/settings&quot;</span><span class="kw">&gt;&lt;%=</span> <span class="dt">I18n</span>.t(<span class="st">&quot;nav.links.settings&quot;</span>) <span class="kw">%&gt;&lt;/a&gt;</span>
<span class="kw">&lt;/nav&gt;</span></code></pre>
<p>Number, currency, and date formatting is available with <code>i18n.js</code> as well - see the <a href="https://github.com/fnando/i18n-js">documentation</a> for further usage information.</p>
<p></p>
</section>
</section>
<section id="models-and-collections" class="level1">
<h1><a href="#models-and-collections">Models and collections</a></h1>
<section id="filters-and-sorting" class="level2">
<h2><a href="#filters-and-sorting">Filters and sorting</a></h2>
<p>When using our Backbone models and collections, it's often handy to filter the collections by reusable criteria, or sort them by several different criteria.</p>
</section>
<section id="modifying-collections-in-place" class="level2">
<h2><a href="#modifying-collections-in-place">Modifying collections in-place</a></h2>
<p>An easy method of filtering or sorting a collection is by updating it in-place.</p>
<p>To sort a collection in-place, change its <code>comparator</code> property to a new function and call <code>#sort</code>:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> alphabet = <span class="kw">new</span> <span class="ot">Backbone</span>.<span class="fu">Collection</span>([
  <span class="kw">new</span> <span class="ot">Backbone</span>.<span class="fu">Model</span>({ <span class="dt">letter</span>: <span class="st">'W'</span>, <span class="dt">syllables</span>: <span class="dv">3</span> }),
  <span class="kw">new</span> <span class="ot">Backbone</span>.<span class="fu">Model</span>({ <span class="dt">letter</span>: <span class="st">'X'</span>, <span class="dt">syllables</span>: <span class="dv">2</span> }),
  <span class="kw">new</span> <span class="ot">Backbone</span>.<span class="fu">Model</span>({ <span class="dt">letter</span>: <span class="st">'Y'</span>, <span class="dt">syllables</span>: <span class="dv">1</span> }),
  <span class="kw">new</span> <span class="ot">Backbone</span>.<span class="fu">Model</span>({ <span class="dt">letter</span>: <span class="st">'Z'</span>, <span class="dt">syllables</span>: <span class="dv">1</span> })
]);

<span class="co">// the collection starts off in natural, insertion order</span>
<span class="ot">console</span>.<span class="fu">log</span>(<span class="ot">alphabet</span>.<span class="fu">pluck</span>(<span class="st">'letter'</span>)); <span class="co">// ['W', 'X', 'Y', 'Z']</span>

<span class="co">// sort them by number of syllables in the pronunciation</span>
<span class="ot">alphabet</span>.<span class="fu">comparator</span> = <span class="kw">function</span>(letter) { <span class="kw">return</span> <span class="ot">letter</span>.<span class="fu">get</span>(<span class="st">'syllables'</span>) };
<span class="ot">alphabet</span>.<span class="fu">sort</span>();
<span class="ot">console</span>.<span class="fu">log</span>(<span class="ot">alphabet</span>.<span class="fu">pluck</span>(<span class="st">'letter'</span>)); <span class="co">// ['Y', 'Z', 'X', 'W']</span></code></pre>
<p>To filter a collection in-place, iterate over it and reject the elements you want to remove:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// get rid of letters that take too long to say</span>
shortLetters = <span class="ot">alphabet</span>.<span class="fu">filter</span>(<span class="kw">function</span>(letter) {
  <span class="kw">return</span> <span class="ot">letter</span>.<span class="fu">get</span>(<span class="st">'syllables'</span>) == <span class="dv">1</span>;
});
<span class="ot">alphabet</span>.<span class="fu">reset</span>(shortLetters);
<span class="ot">console</span>.<span class="fu">log</span>(<span class="ot">alphabet</span>.<span class="fu">pluck</span>(<span class="st">'letter'</span>)); <span class="co">// ['Y', 'Z']</span></code></pre>
<p>Note that the filtering is destructive; after we invoke <code>alphabet#reset</code>, there is no way to get the discarded elements back. Also, there is no link back to the parent collection - if elements are added to the base collection, they are not propagated automatically to the filtered view. Since it's occasionally valuable to produce a filtered view on a collection that receives changes to the root collection, let's take a look at implementing it.</p>
<p>After that, we'll take a look at a memory leak that this pattern can introduce, and how to effectively manage that.</p>
<p>Finally, while the clone-and-modify approach is more clearly useful for filtering, it can be helpful in sorting as well if you need to render multiple views from the same base collection, but with different sort orders.</p>
</section>
<section id="filtering" class="level2">
<h2><a href="#filtering">Filtering</a></h2>
<p>To filter a <code>Backbone.Collection</code>, as with Rails named scopes, first define functions on your collections that filter by your criteria, using the <code>select</code> function from Underscore.js; then, return new instances of the collection class. A first implementation might look like this:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/collections/tasks.js</span>
<span class="kw">var</span> Tasks = <span class="ot">Backbone</span>.<span class="ot">Collection</span>.<span class="fu">extend</span>({
  <span class="dt">model</span>: Task,
  <span class="dt">url</span>: <span class="st">'/tasks'</span>,

  <span class="dt">complete</span>: <span class="kw">function</span>() {
    <span class="kw">var</span> filteredTasks = <span class="kw">this</span>.<span class="fu">select</span>(<span class="kw">function</span>(task) {
      <span class="kw">return</span> <span class="ot">task</span>.<span class="fu">get</span>(<span class="st">'completed_at'</span>) !== <span class="kw">null</span>;
    });
    <span class="kw">return</span> <span class="kw">new</span> <span class="fu">Tasks</span>(filteredTasks);
  }
});</code></pre>
<p>Let's refactor this a bit. Ideally, the filter functions will reuse logic already defined in your model class:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/models/task.js</span>
<span class="kw">var</span> Task = <span class="ot">Backbone</span>.<span class="ot">Model</span>.<span class="fu">extend</span>({
  <span class="dt">isComplete</span>: <span class="kw">function</span>() {
    <span class="kw">return</span> <span class="kw">this</span>.<span class="fu">get</span>(<span class="st">'completed_at'</span>) !== <span class="kw">null</span>;
  }
});

<span class="kw">var</span> Tasks = <span class="ot">Backbone</span>.<span class="ot">Collection</span>.<span class="fu">extend</span>({
  <span class="dt">model</span>: Task,
  <span class="dt">url</span>: <span class="st">'/tasks'</span>,

  <span class="dt">complete</span>: <span class="kw">function</span>() {
    <span class="kw">var</span> filteredTasks = <span class="kw">this</span>.<span class="fu">select</span>(<span class="kw">function</span>(task) {
      <span class="kw">return</span> <span class="ot">task</span>.<span class="fu">isComplete</span>();
    });
    <span class="kw">return</span> <span class="kw">new</span> <span class="fu">Tasks</span>(filteredTasks);
  }
});</code></pre>
<p>Going further, notice that there are actually two concerns in this function. The first is the notion of filtering the collection, and the second is the specific filtering criteria (<code>task.isComplete()</code>).</p>
<p>Let's separate the two concerns here, and extract a <code>filtered</code> function:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/models/task.js</span>
<span class="kw">var</span> Task = <span class="ot">Backbone</span>.<span class="ot">Model</span>.<span class="fu">extend</span>({
  <span class="dt">isComplete</span>: <span class="kw">function</span>() {
    <span class="kw">return</span> <span class="kw">this</span>.<span class="fu">get</span>(<span class="st">'completed_at'</span>) !== <span class="kw">null</span>;
  }
});

<span class="co">// app/assets/javascripts/collections/tasks.js</span>
<span class="kw">var</span> Tasks = <span class="ot">Backbone</span>.<span class="ot">Collection</span>.<span class="fu">extend</span>({
  <span class="dt">model</span>: Task,
  <span class="dt">url</span>: <span class="st">'/tasks'</span>,

  <span class="dt">complete</span>: <span class="kw">function</span>() {
    <span class="kw">return</span> <span class="kw">this</span>.<span class="fu">filtered</span>(<span class="kw">function</span>(task) {
      <span class="kw">return</span> <span class="ot">task</span>.<span class="fu">isComplete</span>();
    });
  },

  <span class="dt">filtered</span>: <span class="kw">function</span>(criteriaFunction) {
    <span class="kw">return</span> <span class="kw">new</span> <span class="fu">Tasks</span>(<span class="kw">this</span>.<span class="fu">select</span>(criteriaFunction));
  }
});</code></pre>
<p>We can extract this function into a reusable mixin, abstracting the <code>Tasks</code> collection class using <code>this.constructor</code>:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/filterable_collection_mixin.js</span>
<span class="kw">var</span> FilterableCollectionMixin = {
  <span class="dt">filtered</span>: <span class="kw">function</span>(criteriaFunction) {
    <span class="kw">return</span> <span class="kw">new</span> <span class="kw">this</span>.<span class="fu">constructor</span>(<span class="kw">this</span>.<span class="fu">select</span>(criteriaFunction));
  }
};

<span class="co">// app/assets/javascripts/models/task.js</span>
<span class="kw">var</span> Task = <span class="ot">Backbone</span>.<span class="ot">Model</span>.<span class="fu">extend</span>({
  <span class="dt">isComplete</span>: <span class="kw">function</span>() {
    <span class="kw">return</span> <span class="kw">this</span>.<span class="fu">get</span>(<span class="st">'completed_at'</span>) !== <span class="kw">null</span>;
  }
});

<span class="co">// app/assets/javascripts/collections/tasks.js</span>
<span class="kw">var</span> Tasks = <span class="ot">Backbone</span>.<span class="ot">Collection</span>.<span class="fu">extend</span>({
  <span class="dt">model</span>: Task,
  <span class="dt">url</span>: <span class="st">'/tasks'</span>,

  <span class="dt">complete</span>: <span class="kw">function</span>() {
    <span class="kw">return</span> <span class="kw">this</span>.<span class="fu">filtered</span>(<span class="kw">function</span>(task) {
      <span class="kw">return</span> <span class="ot">task</span>.<span class="fu">isComplete</span>();
    });
  }
});

<span class="ot">_</span>.<span class="fu">extend</span>(<span class="ot">Tasks</span>.<span class="fu">prototype</span>, FilterableCollectionMixin);</code></pre>
</section>
<section id="propagating-collection-changes" class="level2">
<h2><a href="#propagating-collection-changes">Propagating collection changes</a></h2>
<p>The <code>FilterableCollectionMixin</code>, as we've written it, will produce a filtered collection that does not update when the original collection is changed.</p>
<p>A naive approach is to bind to the change, add, and remove events on the source collection, reapply the filter function, and repopulate the filtered collection:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/filterable_collection_mixin.js</span>
<span class="kw">var</span> FilterableCollectionMixin = {
  <span class="dt">filtered</span>: <span class="kw">function</span>(criteriaFunction) {
    <span class="kw">var</span> sourceCollection = <span class="kw">this</span>;
    <span class="kw">var</span> filteredCollection = <span class="kw">new</span> <span class="kw">this</span>.<span class="fu">constructor</span>;

    <span class="kw">var</span> applyFilter = <span class="kw">function</span>() {
      <span class="ot">filteredCollection</span>.<span class="fu">reset</span>(<span class="ot">sourceCollection</span>.<span class="fu">select</span>(criteriaFunction));
    };

    <span class="kw">this</span>.<span class="fu">bind</span>(<span class="st">&quot;change&quot;</span>, applyFilter);
    <span class="kw">this</span>.<span class="fu">bind</span>(<span class="st">&quot;add&quot;</span>,    applyFilter);
    <span class="kw">this</span>.<span class="fu">bind</span>(<span class="st">&quot;remove&quot;</span>, applyFilter);

    <span class="fu">applyFilter</span>();

    <span class="kw">return</span> filteredCollection;
  }
};</code></pre>
<p>While this correctly updates the filtered collection when the base collection or one of its models is changed, this will always trigger a <code>reset</code> event on the filtered collection, rather than the appropriate event.</p>
<p>A full <code>FilteredCollectionMixin</code>, along with specs for its event triggering in various states, is included in the <code>example_app</code> in:</p>
<ul>
<li><code>app/assets/javascripts/filterable_collection_mixin.js</code></li>
<li><code>spec/javascripts/filterable_collection_mixin_spec.js</code></li>
</ul>
<section id="a-note-on-event-bindings-and-reference-leaks" class="level3">
<h3><a href="#a-note-on-event-bindings-and-reference-leaks">A note on event bindings and reference leaks</a></h3>
<p>The general approach of duplicating a collection to filter or sort it is handy, but there is a piece of bookkeeping that you have to keep in mind. Consider a filterable results interface that renders a collection, and assume that the view uses this derivative collection approach to filtering.</p>
<p>The view accepts a base collection and then maintains a filtered version of that collection, which it renders from.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/filterable_results_view.js</span>
<span class="kw">var</span> FilterableResultsView = <span class="ot">Support</span>.<span class="ot">CompositeView</span>.<span class="fu">extend</span>({
  <span class="dt">events</span>: {
    <span class="st">&quot;click button.filter&quot;</span>: applyFilter,
  },

  <span class="dt">initialize</span>: <span class="kw">function</span>(options) {
    <span class="kw">this</span>.<span class="fu">baseCollection</span> = <span class="ot">options</span>.<span class="fu">collection</span>;
    <span class="kw">this</span>.<span class="fu">filteredCollection</span> = <span class="kw">this</span>.<span class="fu">baseCollection</span>;
  },

  <span class="dt">applyFilter</span>: <span class="kw">function</span>() {
    <span class="kw">var</span> filterFunction = <span class="kw">this</span>.<span class="fu">computeFilterFunction</span>(); <span class="co">// filtering logic goes here</span>
    <span class="kw">this</span>.<span class="fu">filteredCollection</span> = <span class="kw">this</span>.<span class="ot">baseCollection</span>.<span class="fu">filtered</span>(filterFunction);
    <span class="kw">this</span>.<span class="fu">render</span>();
  },

  <span class="dt">render</span>: <span class="kw">function</span>() {
    <span class="co">// render from this.filteredCollection</span>
  },

  <span class="co">// ...</span>
});</code></pre>
<p>There is a leak in FilterableMixinCollection, as we have it now, which is exposed by this usage pattern. The contructor-local functions <code>addToFiltered</code>, <code>removeFromFiltered</code>, and <code>changeFiltered</code> close over the <code>filteredCollection</code> reference inside <code>FilterableCollectionMixin#filtered</code>. Those functions are also bound as event handlers on the <code>baseCollection</code>, which means a reference chain is maintained from the base collection, through its event handlers, to those functions, to the filtered collection.</p>
<p>Unless these event handlers are unbound, the filtered collection will never be eligible for garbage collection. If the user re-filters the view many times, which is particularly likely in a long-lived client-side application, this leakage can grow quite large. Additionally, the chain of references extending from the filtered collections may grow quite large themselves.</p>
<p>Unfortunately, a filtered collection is not aware of when you are finished using it, so we must expose the cleanup concern as something for the view to handle. See the <code>teardown</code> function in <code>FilterableCollectionMixin</code>, which unbinds these event handlers, allowing the filtered collection to be correctly garbage collected.</p>
<p>You can think of this in a similar way to how the <code>SwappingRouter</code> tracks its current view, disposing of the old view before swapping in the new one.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/filterable_results_view.js</span>
<span class="kw">var</span> FilterableResultsView = <span class="ot">Support</span>.<span class="ot">CompositeView</span>.<span class="fu">extend</span>({
  <span class="dt">initialize</span>: <span class="kw">function</span>(options) {
    <span class="kw">this</span>.<span class="fu">baseCollection</span> = <span class="ot">options</span>.<span class="fu">collection</span>;

    <span class="co">// If we just assign filteredCollection to baseCollection, either:</span>
    <span class="co">//</span>
    <span class="co">// 1. baseCollection does not have #teardown, so calling it blows up.</span>
    <span class="co">// 2. baseCollection does have #teardown, and we tear it down while</span>
    <span class="co">//    filtering, breaking the chain from its parent.  Oops.</span>
    <span class="co">//</span>
    <span class="co">// So, produce a filtered copy that initially contains all member elements.</span>
    <span class="kw">this</span>.<span class="fu">filteredCollection</span> = <span class="kw">this</span>.<span class="ot">baseCollection</span>.<span class="fu">filtered</span>(
      <span class="kw">function</span>() { <span class="kw">return</span> <span class="kw">true</span>; });
  },

  <span class="dt">applyFilter</span>: <span class="kw">function</span>() {
    <span class="kw">var</span> filterFunction = <span class="kw">this</span>.<span class="fu">computeFilterFunction</span>(); <span class="co">// filtering logic goes here</span>
    <span class="kw">this</span>.<span class="ot">filteredFunction</span>.<span class="fu">teardown</span>();
    <span class="kw">this</span>.<span class="fu">filteredCollection</span> = <span class="kw">this</span>.<span class="ot">baseCollection</span>.<span class="fu">filtered</span>(filterFunction);
    <span class="kw">this</span>.<span class="fu">render</span>();
  },

  <span class="co">// ...</span>
});</code></pre>
</section>
</section>
<section id="sorting" class="level2">
<h2><a href="#sorting">Sorting</a></h2>
<p>The simplest way to sort a <code>Backbone.Collection</code> is to define a <code>comparator</code> function. This functionality is built in:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/collections/tasks.js</span>
<span class="kw">var</span> Tasks = <span class="ot">Backbone</span>.<span class="ot">Collection</span>.<span class="fu">extend</span>({
  <span class="dt">model</span>: Task,
  <span class="dt">url</span>: <span class="st">'/tasks'</span>,

  <span class="dt">comparator</span>: <span class="kw">function</span>(task) {
    <span class="kw">return</span> <span class="ot">task</span>.<span class="fu">dueDate</span>;
  }
});</code></pre>
<p>If you'd like to provide more than one sort order on your collection, you can use an approach similar to the <code>filtered</code> function above, and return a new <code>Backbone.Collection</code> whose <code>comparator</code> is overridden. Call <code>sort</code> to update the ordering on the new collection:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/collections/tasks.js</span>
<span class="kw">var</span> Tasks = <span class="ot">Backbone</span>.<span class="ot">Collection</span>.<span class="fu">extend</span>({
  <span class="dt">model</span>: Task,
  <span class="dt">url</span>: <span class="st">'/tasks'</span>,

  <span class="dt">comparator</span>: <span class="kw">function</span>(task) {
    <span class="kw">return</span> <span class="ot">task</span>.<span class="fu">dueDate</span>;
  },

  <span class="dt">byCreatedAt</span>: <span class="kw">function</span>() {
    <span class="kw">var</span> sortedCollection = <span class="kw">new</span> <span class="fu">Tasks</span>(<span class="kw">this</span>.<span class="fu">models</span>);
    <span class="ot">sortedCollection</span>.<span class="fu">comparator</span> = <span class="kw">function</span>(task) {
      <span class="kw">return</span> <span class="ot">task</span>.<span class="fu">createdAt</span>;
    };
    <span class="ot">sortedCollection</span>.<span class="fu">sort</span>();
    <span class="kw">return</span> sortedCollection;
  }
});</code></pre>
<p>Similarly, you can extract the reusable concern to another function:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/collections/tasks.js</span>
<span class="kw">var</span> Tasks = <span class="ot">Backbone</span>.<span class="ot">Collection</span>.<span class="fu">extend</span>({
  <span class="dt">model</span>: Task,
  <span class="dt">url</span>: <span class="st">'/tasks'</span>,

  <span class="dt">comparator</span>: <span class="kw">function</span>(task) {
    <span class="kw">return</span> <span class="ot">task</span>.<span class="fu">dueDate</span>;
  },

  <span class="dt">byCreatedAt</span>: <span class="kw">function</span>() {
    <span class="kw">return</span> <span class="kw">this</span>.<span class="fu">sortedBy</span>(<span class="kw">function</span>(task) {
      <span class="kw">return</span> <span class="ot">task</span>.<span class="fu">createdAt</span>;
    });
  },

  <span class="dt">byCompletedAt</span>: <span class="kw">function</span>() {
    <span class="kw">return</span> <span class="kw">this</span>.<span class="fu">sortedBy</span>(<span class="kw">function</span>(task) {
      <span class="kw">return</span> <span class="ot">task</span>.<span class="fu">completedAt</span>;
    });
  },

  <span class="dt">sortedBy</span>: <span class="kw">function</span>(comparator) {
    <span class="kw">var</span> sortedCollection = <span class="kw">new</span> <span class="fu">Tasks</span>(<span class="kw">this</span>.<span class="fu">models</span>);
    <span class="ot">sortedCollection</span>.<span class="fu">comparator</span> = comparator;
    <span class="ot">sortedCollection</span>.<span class="fu">sort</span>();
    <span class="kw">return</span> sortedCollection;
  }
});</code></pre>
<p>...And then into another reusable mixin:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/sortable_collection_mixin.js</span>
<span class="kw">var</span> SortableCollectionMixin = {
  <span class="dt">sortedBy</span>: <span class="kw">function</span>(comparator) {
    <span class="kw">var</span> sortedCollection = <span class="kw">new</span> <span class="kw">this</span>.<span class="fu">constructor</span>(<span class="kw">this</span>.<span class="fu">models</span>);
    <span class="ot">sortedCollection</span>.<span class="fu">comparator</span> = comparator;
    <span class="ot">sortedCollection</span>.<span class="fu">sort</span>();
    <span class="kw">return</span> sortedCollection;
  }
};

<span class="kw">var</span> Tasks = <span class="ot">Backbone</span>.<span class="ot">Collection</span>.<span class="fu">extend</span>({
  <span class="dt">model</span>: Task,
  <span class="dt">url</span>: <span class="st">'/tasks'</span>,

  <span class="dt">comparator</span>: <span class="kw">function</span>(task) {
    <span class="kw">return</span> <span class="ot">task</span>.<span class="fu">dueDate</span>;
  },

  <span class="dt">byCreatedAt</span>: <span class="kw">function</span>() {
    <span class="kw">return</span> <span class="kw">this</span>.<span class="fu">sortedBy</span>(<span class="kw">function</span>(task) {
      <span class="kw">return</span> <span class="ot">task</span>.<span class="fu">createdAt</span>;
    });
  },

  <span class="dt">byCompletedAt</span>: <span class="kw">function</span>() {
    <span class="kw">return</span> <span class="kw">this</span>.<span class="fu">sortedBy</span>(<span class="kw">function</span>(task) {
      <span class="kw">return</span> <span class="ot">task</span>.<span class="fu">completedAt</span>;
    });
  }
});

<span class="ot">_</span>.<span class="fu">extend</span>(<span class="ot">Tasks</span>.<span class="fu">prototype</span>, SortableCollectionMixin);</code></pre>
<p>Just as with the <code>FilterableCollectionMixin</code> before, the <code>SortableCollectionMixin</code> should observe its source if updates are to propagate from one collection to another:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/sortable_collection_mixin.js</span>
<span class="kw">var</span> SortableCollectionMixin = {
  <span class="dt">sortedBy</span>: <span class="kw">function</span>(comparator) {
    <span class="kw">var</span> sourceCollection = <span class="kw">this</span>;
    <span class="kw">var</span> sortedCollection = <span class="kw">new</span> <span class="kw">this</span>.<span class="fu">constructor</span>;
    <span class="ot">sortedCollection</span>.<span class="fu">comparator</span> = comparator;

    <span class="kw">var</span> applySort = <span class="kw">function</span>() {
      <span class="ot">sortedCollection</span>.<span class="fu">reset</span>(<span class="ot">sourceCollection</span>.<span class="fu">models</span>);
      <span class="ot">sortedCollection</span>.<span class="fu">sort</span>();
    };

    <span class="kw">this</span>.<span class="fu">on</span>(<span class="st">&quot;change&quot;</span>, applySort);
    <span class="kw">this</span>.<span class="fu">on</span>(<span class="st">&quot;add&quot;</span>,    applySort);
    <span class="kw">this</span>.<span class="fu">on</span>(<span class="st">&quot;remove&quot;</span>, applySort);

    <span class="fu">applySort</span>();

    <span class="kw">return</span> sortedCollection;
  }
};</code></pre>
<p>It is left as an excerise for the reader to update <code>SortableCollectionMixin</code> to trigger the correct change/add/remove events as in the improved <code>FilterableCollectionMixin</code> above.</p>
</section>
<section id="validations" class="level2">
<h2><a href="#validations">Validations</a></h2>
<p>The server is the authoritative place for verifying whether data being stored is valid. Even though Backbone.js <a href="http://documentcloud.github.com/backbone/#Model-validate">exposes an API</a> for performing client-side validations, when it comes to validating user data in a Backbone.js application, we want to continue to use the very same mechanisms on the server side that we've used in Rails all along: the ActiveModel validations API.</p>
<p>The challenge is tying the two together: letting your ActiveRecord objects reject invalid user data, and having the errors bubble all the way up to the interface for user feedback - and keeping it all seamless to the user and easy for the developer.</p>
<p>Let's wire this up. To get started, we'll add a validation on the task's title attribute on the ActiveRecord model, like so:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="co"># app/models/task.rb</span>
<span class="kw">class</span> <span class="dt">Task</span> &lt; <span class="dt">ActiveRecord</span>::<span class="dt">Base</span>
  validates <span class="st">:title</span>, presence: <span class="dv">true</span>
<span class="kw">end</span></code></pre>
<p>On the Backbone side of the world, we have a Backbone task called <code>YourApp.Models.Task</code>:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/models/task.js</span>
<span class="ot">YourApp</span>.<span class="ot">Models</span>.<span class="fu">Task</span> = <span class="ot">Backbone</span>.<span class="ot">Model</span>.<span class="fu">extend</span>({
  <span class="dt">urlRoot</span>: <span class="st">'/tasks'</span>
});</code></pre>
<p>We also have a place where users enter new tasks - just a form on the task list:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="co">&lt;!-- app/assets/templates/tasks/form_fields.jst.ejs --&gt;</span>
<span class="kw">&lt;form&gt;</span>
  <span class="kw">&lt;ul&gt;</span>
    <span class="kw">&lt;li</span><span class="ot"> class=</span><span class="st">&quot;task_title_input&quot;</span><span class="kw">&gt;</span>
      <span class="kw">&lt;label</span><span class="ot"> for=</span><span class="st">&quot;title&quot;</span><span class="kw">&gt;</span>Title<span class="kw">&lt;/label&gt;</span>
      <span class="kw">&lt;input</span><span class="ot"> id=</span><span class="st">&quot;title&quot;</span><span class="ot"> maxlength=</span><span class="st">&quot;255&quot;</span><span class="ot"> name=</span><span class="st">&quot;title&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="kw">&gt;</span>
    <span class="kw">&lt;/li&gt;</span>
    <span class="kw">&lt;li&gt;</span>
      <span class="kw">&lt;button</span><span class="ot"> class=</span><span class="st">&quot;submit&quot;</span><span class="ot"> id=</span><span class="st">&quot;create-task&quot;</span><span class="kw">&gt;</span>Create task<span class="kw">&lt;/button&gt;</span>
    <span class="kw">&lt;/li&gt;</span>
  <span class="kw">&lt;/ul&gt;</span>
<span class="kw">&lt;/form&gt;</span></code></pre>
<p>On the <code>NewTask</code> Backbone view, we bind the button's click event to a new function that we'll call <code>createTask</code>:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/new_task.js</span>
<span class="ot">YourApp</span>.<span class="ot">Views</span>.<span class="fu">NewTask</span> = <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">extend</span>({
  <span class="dt">events</span>: {
    <span class="st">&quot;click #create-task&quot;</span>: <span class="st">&quot;createTask&quot;</span>
  },

  <span class="dt">createTask</span>: {
    <span class="co">// grab attribute values from the form</span>
    <span class="co">// storing them on the attributes hash</span>
    <span class="kw">var</span> attributes = {};
    <span class="ot">_</span>.<span class="fu">each</span>(<span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'form input, form select'</span>), <span class="kw">function</span>(element) {
      <span class="kw">var</span> element = <span class="fu">$</span>(element);
      <span class="kw">if</span>(<span class="ot">element</span>.<span class="fu">attr</span>(<span class="st">'name'</span>) != <span class="st">&quot;commit&quot;</span>) {
        attributes[<span class="ot">element</span>.<span class="fu">attr</span>(<span class="st">'name'</span>)] = <span class="ot">element</span>.<span class="fu">val</span>();
      }
    });

    <span class="kw">var</span> self = <span class="kw">this</span>;
    <span class="co">// create a new task and save it to the server</span>
    <span class="kw">new</span> <span class="ot">YourApp</span>.<span class="ot">Models</span>.<span class="fu">Task</span>(attributes).<span class="fu">save</span>({}, {
        <span class="dt">success</span>: <span class="kw">function</span>() { <span class="co">/* handle success */</span> }
        <span class="dt">error</span>:   <span class="kw">function</span>() { <span class="co">/* validation error occurred, show user */</span> }
      });
    <span class="kw">return</span> <span class="kw">false</span>;
  }
})</code></pre>
<p>This gets the job done, but let's introduce a new class to handle extracting attributes from the form so that it's decoupled from this view and is therefore easier to extend and reuse.</p>
<p>We'll call this the <code>FormAttributes</code>, and its code is as follows:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/form_attributes.js</span>
FormAttributes = <span class="kw">function</span>(form) {
  <span class="kw">this</span>.<span class="fu">form</span> = form;
}

<span class="ot">_</span>.<span class="fu">extend</span>(<span class="ot">FormAttributes</span>.<span class="fu">prototype</span>, {
  <span class="dt">attributes</span>: <span class="kw">function</span>() {
    <span class="kw">var</span> attributes = {};
    <span class="ot">_</span>.<span class="fu">each</span>(<span class="fu">$</span>(<span class="st">'input, select'</span>, <span class="kw">this</span>.<span class="fu">form</span>), <span class="kw">function</span>(element) {
      <span class="kw">var</span> element = <span class="fu">$</span>(element);
      <span class="kw">if</span>(<span class="ot">element</span>.<span class="fu">attr</span>(<span class="st">'name'</span>) != <span class="st">&quot;commit&quot;</span>) {
        attributes[<span class="ot">element</span>.<span class="fu">attr</span>(<span class="st">'name'</span>)] = <span class="ot">element</span>.<span class="fu">val</span>();
      }
    });
    <span class="kw">return</span> attributes;
  }
});</code></pre>
<p>With this class in place, we can rewrite our form submit action to:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/new_task.js</span>
<span class="ot">YourApp</span>.<span class="ot">Views</span>.<span class="fu">NewTask</span> = <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">extend</span>({
  <span class="dt">events</span>: {
    <span class="st">&quot;click #create-task&quot;</span>: <span class="st">&quot;createTask&quot;</span>
  },

  <span class="dt">createTask</span>: {
    <span class="kw">var</span> attributes = <span class="kw">new</span> <span class="fu">FormAttributes</span>(<span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'form'</span>)).<span class="fu">attributes</span>();

    <span class="kw">var</span> self = <span class="kw">this</span>;
    <span class="co">// create a new task and save it to the server</span>
    <span class="kw">new</span> <span class="ot">YourApp</span>.<span class="ot">Models</span>.<span class="fu">Task</span>(attributes).<span class="fu">save</span>({}, {
        <span class="dt">success</span>: <span class="kw">function</span>() { <span class="co">/* handle success */</span> }
        <span class="dt">error</span>:   <span class="kw">function</span>() { <span class="co">/* validation error occurred, show user */</span> }
      });
    <span class="kw">return</span> <span class="kw">false</span>;
  }
})</code></pre>
<p>When you call <code>save()</code> on a Backbone model, Backbone will delegate to <code>.sync()</code> and create a POST request on the model's URL, where the payload is the attributes that you've passed onto the <code>save()</code> call.</p>
<p>The easiest way to handle this in Rails is to use <code>respond_to</code>/<code>respond_with</code>, available in Rails 3 applications:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="co"># app/controllers/tasks_controller.rb</span>
<span class="kw">class</span> <span class="dt">TasksController</span> &lt; <span class="dt">ApplicationController</span>
  respond_to <span class="st">:json</span>
  <span class="kw">def</span> create
    task = <span class="dt">Task</span>.create(params)
    respond_with task
  <span class="kw">end</span>
<span class="kw">end</span></code></pre>
<p>When the task is created successfully, Rails will render the show action using the object that you've passed to the <code>respond_with</code> call, so make sure the show action is defined in your routes:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="co"># config/routes.rb</span>
resources <span class="st">:tasks</span>, only: [<span class="st">:create</span>, <span class="st">:show</span>]</code></pre>
<p>When the task cannot be created successfully because some validation constraint is not met, the Rails responder will render the model's errors as a JSON object, and use an HTTP status code of 422, which will alert Backbone that there was an error in the request and it was not processed.</p>
<p>The response from Rails in that case looks something like this:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript">{ <span class="st">&quot;title&quot;</span>: [<span class="st">&quot;can't be blank&quot;</span>] }</code></pre>
<p>That two-line action in a Rails controller is all we need to talk to our Backbone models and handle error cases.</p>
<p>Back to the Backbone model's <code>save()</code> call: Backbone will invoke one of two callbacks when it receives a response from the Rails app, so we simply pass in a hash containing a function to run for both the success and the error cases.</p>
<p>In the success case, we may want to add the new model instance to a global collection of tasks. Backbone will trigger the add event on that collection, which is a chance for some other view to bind to that event and re-render itself so that the new task appears on the page.</p>
<p>In the error case, however, we want to display inline errors on the form. When Backbone triggers the <code>error</code> callback, it passes along two parameters: the model being saved and the raw response. We have to parse the JSON response and iterate through it, rendering an inline error on the form corresponding to each of the errors. Let's introduce a couple of new classes that will help along the way.</p>
<p>First is the <code>ErrorList</code>. An <code>ErrorList</code> encapsulates parsing of the raw JSON that came in from the server and provides an iterator to easily loop through errors:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/error_list.js</span>
ErrorList = <span class="kw">function</span> (response) {
  <span class="kw">if</span> (response &amp;&amp; <span class="ot">response</span>.<span class="fu">responseText</span>) {
    <span class="kw">this</span>.<span class="fu">attributesWithErrors</span> = <span class="ot">JSON</span>.<span class="fu">parse</span>(<span class="ot">response</span>.<span class="fu">responseText</span>);
  }
};

<span class="ot">_</span>.<span class="fu">extend</span>(<span class="ot">ErrorList</span>.<span class="fu">prototype</span>, {
  <span class="dt">each</span>: <span class="kw">function</span> (iterator) {
    <span class="ot">_</span>.<span class="fu">each</span>(<span class="kw">this</span>.<span class="fu">attributesWithErrors</span>, iterator);
  },

  <span class="dt">size</span>: <span class="kw">function</span>() {
    <span class="kw">return</span> <span class="ot">_</span>.<span class="fu">size</span>(<span class="kw">this</span>.<span class="fu">attributesWithErrors</span>);
  }
});</code></pre>
<p>Next up is the <code>ErrorView</code>, which is in charge of taking the <code>ErrorList</code> and appending each inline error in the form, providing feedback to the user that their input is invalid:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/error_view.js</span>
ErrorView = <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">extend</span>({
  <span class="dt">initialize</span>: <span class="kw">function</span>() {
    <span class="ot">_</span>.<span class="fu">bindAll</span>(<span class="kw">this</span>, <span class="st">&quot;renderError&quot;</span>);
  },

  <span class="dt">render</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">&quot;.error&quot;</span>).<span class="fu">removeClass</span>(<span class="st">&quot;error&quot;</span>);
    <span class="kw">this</span>.<span class="fu">$</span>(<span class="st">&quot;p.inline-errors&quot;</span>).<span class="fu">remove</span>();
    <span class="kw">this</span>.<span class="ot">options</span>.<span class="ot">errors</span>.<span class="fu">each</span>(<span class="kw">this</span>.<span class="fu">renderError</span>);
  },

  <span class="dt">renderError</span>: <span class="kw">function</span>(errors, attribute) {
    <span class="kw">var</span> errorString = <span class="ot">errors</span>.<span class="fu">join</span>(<span class="st">&quot;, &quot;</span>);
    <span class="kw">var</span> field = <span class="kw">this</span>.<span class="fu">fieldFor</span>(attribute);
    <span class="kw">var</span> errorTag = <span class="fu">$</span>(<span class="st">'&lt;p&gt;'</span>).<span class="fu">addClass</span>(<span class="st">'inline-errors'</span>).<span class="fu">text</span>(errorString);
    <span class="ot">field</span>.<span class="fu">append</span>(errorTag);
    <span class="ot">field</span>.<span class="fu">addClass</span>(<span class="st">&quot;error&quot;</span>);
  },

  <span class="dt">fieldFor</span>: <span class="kw">function</span>(attribute) {
    <span class="kw">return</span> <span class="fu">$</span>(<span class="kw">this</span>.<span class="ot">options</span>.<span class="fu">el</span>).<span class="fu">find</span>(<span class="st">'li[id*=&quot;_'</span> + attribute + <span class="st">'_input&quot;]'</span>).<span class="fu">first</span>();
  }
});</code></pre>
<p>Note the <code>fieldFor</code> function. It expects a field with an id containing a certain format. Therefore, in order for this to work, the form's HTML must contain a matching element. In our case, it was the list item with an id of <code>task_title_input</code>.</p>
<p>When a Backbone view's <code>el</code> is already on the DOM, we need to pass it into the view's constructor. In the case of the <code>ErrorView</code> class, we want to operate on the view that contains the form that originated the errors.</p>
<p>To use these classes, we take the response from the server and pass that along to the <code>ErrorList</code> constructor, which we then pass to the <code>ErrorView</code>, which will do its fine job inserting the inline errors when we call <code>render()</code> on it. Putting it all together, our save call's callbacks now look like this:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> self = <span class="kw">this</span>;
<span class="kw">var</span> model = <span class="kw">new</span> <span class="ot">YourApp</span>.<span class="ot">Models</span>.<span class="fu">Task</span>(attributes);
<span class="ot">model</span>.<span class="fu">save</span>({
  <span class="dt">error</span>: <span class="kw">function</span>(model, response) {
    <span class="kw">var</span> errors = <span class="kw">new</span> <span class="fu">ErrorList</span>(response);
    <span class="kw">var</span> view   = <span class="kw">new</span> <span class="fu">ErrorView</span>( { <span class="dt">el</span>: <span class="ot">self</span>.<span class="fu">el</span>, <span class="dt">errors</span>: errors } );
    <span class="ot">view</span>.<span class="fu">render</span>();
  }
});</code></pre>
<p>Here, we've shown how you can decouple different concerns into their own classes, creating a system that is easier to extend, and potentially arriving at solutions generic enough even to be shared across applications. Our simple <code>FormAttributes</code> class has a long way to go. It can grow up to handle many other cases, such as dates.</p>
<p>One example of a generic library that handles much of what we've done here, as well as helpers for rendering the forms, is Backbone.Form. In order to know how to render all attributes of a model, it requires you to specify a &quot;schema&quot; on the model class - and it will take it from there. The source for Backbone.Form can be found <a href="https://github.com/powmedia/backbone-forms">on github</a>.</p>
</section>
<section id="model-relationships" class="level2">
<h2><a href="#model-relationships">Model relationships</a></h2>
<p>In any non-trivial application, you will have relationships in your domain model that are valuable to express on the client side. For example, consider a contact management application where each person in your contact list has many phone numbers, each of a different kind.</p>
<p>Or, consider a project planning application where there are Teams, Members, and Projects as resources (models and collections). There are relationships between each of these primary resources, and those relationships in turn may be exposed as first-class resources: a Membership to link a Team and a Member, or a Permission to link a Team with a Project. These relationships are often exposed as first-class models - so they can be created and destroyed the same way as other models, and so that additional domain information about the relationship, such as a duration, rate, or quantity, can be described.</p>
<p>These model relationships don't have to be persisted by a relational database. In a chatroom application whose data is persisted in a key-value store, the data could still be modeled as a Room which has many Messages, as well as Memberships that link the Room to Users. A content management application that stores its data in a document database still has the notion of hierarchy, where a Site contains many Pages, each of which constitutes zero or more Sections.</p>
<p>In a vanilla Rails application, the object model is described on the server side with ActiveRecord subclasses, and exposed to the Backbone client through a JSON HTTP API. You have a few choices to make when designing this API, largely focused on the inherent coupling of model relationships and data -- when you handle a request for one resource, which of its associated resources (if any) do you deliver, too?</p>
<p>Then, on the client side, you have a wide degree of choice in how to model the relationships, when to eagerly pre-fetch associations and when to lazily defer loading, and whether to employ a supporting library to help define your model relationships.</p>
</section>
<section id="backbone-relational-plugin" class="level2">
<h2><a href="#backbone-relational-plugin">Backbone-relational plugin</a></h2>
<p>If your use cases are supported by it, Paul Uithol's <a href="https://github.com/PaulUithol/Backbone-relational">Backbone-relational</a> is arguably the most popular and actively maintained library for this. It lets you declare one-to-one, one-to-many, and many-to-one relations on your Backbone models by extending a new base class, <code>Backbone.RelationalModel</code>. It's good to understand how this works under the hood, so we'll cover one way to implement a relational object model in Backbone below, but we encourage you to check out the <code>Backbone-relational</code> plugin as a way to work at a higher level of abstraction.</p>
</section>
<section id="relations-in-the-task-app" class="level2">
<h2><a href="#relations-in-the-task-app">Relations in the task app</a></h2>
<p>In the example application, there are users which have many tasks. Each task has many attachments and assignments. Tasks are assigned to users through assignments, so tasks have many assigned users as well.</p>
</section>
<section id="deciding-how-to-deliver-data-to-the-client" class="level2">
<h2><a href="#deciding-how-to-deliver-data-to-the-client">Deciding how to deliver data to the client</a></h2>
<p>Before you decide how to model your JSON API or how to declare your client-side model relationships, consider the user experience of your application. For <code>TaskApp</code>, we decided to have interactions as follows:</p>
<ul>
<li>A user signs up or logs in</li>
<li>The user is directed to their dashboard</li>
<li>The dashboard shows all tasks, including assigned users, but without attachments</li>
<li>When a user views the details of an individual task, the attachments for that task are displayed</li>
</ul>
<p>This leads us to see that a user's tasks and their assignees are used immediately upon navigating to the dashboard, but the attachment data for a task are not needed upon initial page load, and may well never be needed at all.</p>
<p>Let's say that we are also planning for the user to have continuous network access, but not necessarily with a high speed connection. We should also keep in mind that users tend to view their list of tasks frequently, but rarely view the attachments.</p>
<p>Based on these points, we will bootstrap the collections of tasks and assignees inside the dashboard, and defer loading of associated attachments until after the user clicks through to a task.</p>
<p>We could have selected from several other alternatives, including:</p>
<ul>
<li>Don't preload any information, and deliver only static assets (HTML, CSS, JS) on the dashboard request. Fetch all resources over separate XHR calls. This can provide for a shorter initial page load time, with the cost of a longer wait for actual interactivity. Although the byte size of the page plus data is roughly the same, the overhead of additional HTTP requests incurs extra load time.</li>
<li>Preload all the information, including attachments. This would work well if we expect users to frequently access the attachments of many tasks, but incurs a longer initial page load.</li>
<li>Use <code>localStorage</code> as the primary storage engine, and sync to the Rails server in the background. While this would be advantageous if we expected network access to be intermittent, it incurs the additional complexity of server-side conflict resolution if two clients submit conflicting updates.</li>
</ul>
</section>
<section id="designing-the-http-json-api" class="level2">
<h2><a href="#designing-the-http-json-api">Designing the HTTP JSON API</a></h2>
<p>Now that we know we'll bootstrap the tasks with assignees and defer the Associations, we should decide how to deliver the deferred content. Our goal is to fetch attachments for an individual task. Let's discuss two options.</p>
<p>One way we could approach this is to issue an API call for the nested collection:</p>
<pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">curl</span> http://localhost:3000/tasks/78/attachments.json <span class="kw">|</span> <span class="kw">ppjson</span>
<span class="kw">[</span>
  {
    <span class="st">&quot;id&quot;</span>: <span class="st">&quot;32&quot;</span>,
    <span class="st">&quot;file_url&quot;</span>: <span class="st">&quot;https://s3.amazonaws.com/tasksapp/uploads/32/mock.png&quot;</span>
  },
  {
    <span class="st">&quot;id&quot;</span>: <span class="st">&quot;33&quot;</span>,
    <span class="st">&quot;file_url&quot;</span>: <span class="st">&quot;https://s3.amazonaws.com/tasksapp/uploads/33/users.jpg&quot;</span>
  }
<span class="kw">]</span></code></pre>
<p>Note that we will authenticate API requests with cookies, just like normal user logins, so the actual curl request would need to include a cookie from a logged-in user.</p>
<p>Another way we could approach this is to embed the comment and attachment data in the JSON representation of an individual task, and deliver this data from the <code>/tasks/:id</code> endpoint:</p>
<pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">curl</span> http://tasksapp.local:3000/tasks/78.json <span class="kw">|</span> <span class="kw">ppjson</span>
<span class="kw">{</span>
  <span class="kw">/*</span> some attributes left out for clarity */

  <span class="st">&quot;id&quot;</span>: <span class="kw">78</span>,
  <span class="st">&quot;user_id&quot;</span>: <span class="kw">1</span>,
  <span class="st">&quot;title&quot;</span>: <span class="st">&quot;Clean up landing page&quot;</span>,
  <span class="st">&quot;attachments&quot;</span>:<span class="kw"> [</span>
    {
      <span class="st">&quot;id&quot;</span>: <span class="st">&quot;32&quot;</span>,
      <span class="st">&quot;upload_url&quot;</span>: <span class="st">&quot;https://s3.amazonaws.com/tasksapp/uploads/32/mock.png&quot;</span>
    }
 <span class="kw"> ]</span>
<span class="kw">}</span></code></pre>
<p>We'll take this approach for the example application, because it illustrates parsing nested models in Backbone.</p>
<p>At this point, we know that our HTTP JSON API should support at least the following Rails routes:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="co"># config/routes.rb</span>
resources <span class="st">:tasks</span>, <span class="st">:only</span> =&gt; [<span class="st">:show</span>, <span class="st">:create</span>] <span class="kw">do</span>
  resources <span class="st">:attachments</span>, <span class="st">:only</span> =&gt; [<span class="st">:create</span>]
<span class="kw">end</span></code></pre>
<p>As an aside: In some applications, you may choose to expose a user-facing API. It's valuable to dogfood this endpoint by making use of it from your own Backbone code. Often these APIs will be scoped under an &quot;/api&quot; namespace, possibly with an API version namespace as well like &quot;/api/v1&quot;.</p>
</section>
<section id="implementing-the-api-presenting-the-json" class="level2">
<h2><a href="#implementing-the-api-presenting-the-json">Implementing the API: presenting the JSON</a></h2>
<p>To build the JSON presentation, we have a few options. Rails already comes with support for overriding the <code>Task#as_json</code> method, which is probably the easiest thing to do. However, logic regarding the JSON representation of a model is not the model's concern. An approach that separates presentation logic is preferable, such as creating a separate presenter object, or writing a builder-like view.</p>
<p>The <a href="https://github.com/nesquena/rabl">RABL gem</a> helps you concisely build a view of your models, and keeps this logic in the presentation tier.</p>
<p>RABL allows you to create templates where you can easily specify the JSON representation of your models. If you've worked with the <code>builder</code> library to generate XML such as an RSS feed, you'll feel right at home.</p>
<p>To use it, first include the <code>rabl</code> and <code>yajl-ruby</code> gems in your Gemfile. Then you can create a view ending with <code>.json.rabl</code> to handle any particular request. For example, a <code>tasks#show</code> action may look like this:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="co"># app/controllers/tasks_controller.rb</span>
<span class="kw">class</span> <span class="dt">TasksController</span> &lt; <span class="dt">ApplicationController</span>
  respond_to <span class="st">:json</span>

  <span class="kw">def</span> show
    <span class="ot">@task</span> = <span class="dt">Task</span>.find(params[<span class="st">:id</span>])
    respond_with <span class="ot">@task</span>
  <span class="kw">end</span>
<span class="kw">end</span></code></pre>
<p>Rails' responder will first look for a template matching the controller/action with the format in the file name, in this case <code>json</code>. If it doesn't find anything, it will invoke <code>to_json</code> on the <code>@task</code> model, but in this case we are providing one in <code>app/views/tasks/show.json.rabl</code>, so it will render that instead:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="co"># app/views/tasks/show.json.rabl</span>
object <span class="ot">@task</span>
attributes(<span class="st">:id</span>, <span class="st">:title</span>, <span class="st">:complete</span>)
child(<span class="st">:user</span>) { attributes(<span class="st">:id</span>, <span class="st">:email</span>) }
child(<span class="st">:attachments</span>) { attributes(<span class="st">:id</span>, <span class="st">:email</span>) }</code></pre>
</section>
<section id="parsing-the-json-and-instantiating-client-side-models" class="level2">
<h2><a href="#parsing-the-json-and-instantiating-client-side-models">Parsing the JSON and instantiating client-side models</a></h2>
<p>Now that our API delivers the <code>Task</code> JSON to the client, including its nested <code>Attachments</code>, we need to correctly handle this nested data in the client-side model. Instead of a nested hash of attributes on the <code>Task</code>, we want to instantiate a Backbone collection for the attachments that contains a set of Backbone <code>Attachment</code> models.</p>
<p>The JSON for the attachments is initially set on the Backbone <code>Task</code> model as a Backbone attribute which can be accessed with <code>get()</code> and <code>set()</code>. We are replacing it with an instance of a Backbone <code>Attachments</code> collection and placing that as an object property:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="ot">taskBeforeParsing</span>.<span class="fu">get</span>(<span class="st">'attachments'</span>)
<span class="co">// =&gt; [ { id: 1, upload_url: '...' }, { id: 2, upload_url: '...' } ]</span>
<span class="ot">taskBeforeParsing</span>.<span class="fu">attachments</span>
<span class="co">// =&gt; undefined</span>

<span class="co">/* parse attributes... */</span>

<span class="ot">taskAfterParsing</span>.<span class="fu">get</span>(<span class="st">'attachments'</span>)
<span class="co">// =&gt; undefined</span>
<span class="ot">taskAfterParsing</span>.<span class="fu">attachments</span>
<span class="co">// =&gt; ExampleApp.Collection.Attachments(...)</span></code></pre>
<p>One way to do this is to override the <code>parse</code> function on the <code>Task</code> model.</p>
<p>There are two <code>parse</code> functions in Backbone: one on <code>Collection</code> and another on <code>Model</code>. Backbone will invoke them whenever a model or collection is populated with data from the server; that is, during <code>Model#fetch</code>, <code>Model#save</code> (which updates model attributes based on the server's response to the HTTP PUT/POST request), and <code>Collection#fetch</code>. It's also invoked when a new model is initialized and <code>options.parse</code> is set to <code>true</code>.</p>
<p>It's important to note that <code>parse</code> is not called by <code>Collection#reset</code>, which should be called with an array of models as its first argument. Backbone does support calling <code>Collection#reset</code> with just an array of bare attribute hashes, but these will not be routed through <code>Model#parse</code>, which can be the source of some confusion.</p>
<p>Another way to intercept nested attributes and produce a full object graph is to bind to the <code>change</code> event for the association attribute - in this case, <code>task.attachments</code>:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/models/task.js</span>
<span class="ot">ExampleApp</span>.<span class="ot">Models</span>.<span class="fu">Task</span> = <span class="ot">Backbone</span>.<span class="ot">Model</span>.<span class="fu">extend</span>({
  <span class="dt">initialize</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="fu">on</span>(<span class="st">&quot;change:attachments&quot;</span>, <span class="kw">this</span>.<span class="fu">parseAttachments</span>);
    <span class="kw">this</span>.<span class="fu">parseAttachments</span>();
  },

  <span class="dt">parseAttachments</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="fu">attachments</span> = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Collections</span>.<span class="fu">Attachments</span>(<span class="kw">this</span>.<span class="fu">get</span>(<span class="st">'attachments'</span>));
  },

  <span class="co">// ...</span></code></pre>
<p>This ensures that our custom parsing is invoked whenever the <code>attachments</code> attribute is changed, and when new model instances are created.</p>
</section>
<section id="when-to-fetch-deferred-data" class="level2">
<h2><a href="#when-to-fetch-deferred-data">When to fetch deferred data</a></h2>
<p>Since a Backbone task doesn't always have its associations filled, when you move from <code>TasksIndex</code> to <code>TasksShow</code>, you need to invoke <code>task.fetch()</code> to pull all the task attributes from <code>GET /tasks/:id</code> and populate the <code>attachments</code> association. Whose concern is that? Let's talk it through.</p>
<p>You could lazily populate this association by making the <code>task.attachments</code> association a function instead of a property. Compare <code>task.attachments.each</code> to <code>task.attachments().each</code>; in the latter, the accessing function encapsulates the concern of laziness in fetching and populating, but then you run into the issue that fetch is asynchronous. Passing a callback into <code>attachments()</code> is kludgy; it exposes the deferred nature of the association everywhere you need to access it.</p>
<p>We'll instead prefer to treat the deferred nature explicitly in the <code>Routers.Tasks#show</code> route, a natural application seam to the <code>TaskShow</code> view. This frees <code>TaskShow</code> from having to know about the persistence details of the model:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/routers/tasks.js</span>
<span class="ot">ExampleApp</span>.<span class="ot">Routers</span>.<span class="fu">Tasks</span> = <span class="ot">Support</span>.<span class="ot">SwappingRouter</span>.<span class="fu">extend</span>({
  <span class="co">// ...</span>

  <span class="dt">show</span>: <span class="kw">function</span>(taskId) {
    <span class="kw">var</span> task = <span class="kw">this</span>.<span class="ot">collection</span>.<span class="fu">get</span>(taskId);
    <span class="kw">var</span> tasksRouter = <span class="kw">this</span>;
    <span class="ot">task</span>.<span class="fu">fetch</span>({
      <span class="dt">success</span>: <span class="kw">function</span>() {
        <span class="kw">var</span> view = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Views</span>.<span class="fu">TaskShow</span>({ <span class="dt">model</span>: task });
        <span class="ot">tasksRouter</span>.<span class="fu">swap</span>(view);
      }
    });
  }
});</code></pre>
<p>Now, we have successfully deferred the <code>Task#attachments</code> association and kept the concern clear of the view.</p>
</section>
<section id="complex-nested-models" class="level2">
<h2><a href="#complex-nested-models">Complex nested models</a></h2>
<p>As your domain model grows more complex, you might find that you want to deliver information about more than one model together in a request; i.e., nested attributes. ActiveRecord provides <code>accepts_nested_attributes_for</code>, a facility for conveniently passing nested attributes through from requests to ActiveRecord and sorting out the relationships there.</p>
<p>With more interactive web applications, one relevant change is that pages often have several independently usable sections which update more frequently and fluidly compared to their synchronous full-page submitting counterparts. To support this more finely-grained interface, the client-side implementation and the HTTP JSON API are often more finely-grained to match, resulting in fewer bulk submissions with composite data structures.</p>
<p>A useful way to categorize these situations is by whether they are comprised of singular (one-to-one) relationships or plural relationships. It's worth discussing an alternative to <code>accepts_nested_attributes_for</code> that works for singular associations. Then, we'll dive into how to model bulk updates for plural associations from Backbone.</p>
</section>
<section id="composite-models" class="level2">
<h2><a href="#composite-models">Composite models</a></h2>
<p>Consider a signup form that allows a customer to quickly get started with a project management application.</p>
<p>They fill out information for their individual user account, as well as information about the team they represent (and will eventually invite others users from) and perhaps some information about an initial project. One way to model this is to present a <code>signup</code> resource that handles creating the correct user, team, and project records. The implementation would involve a vanilla <code>SignupsController</code> and a Ruby class <code>Signup</code> class that delegates its nested attributes to their respective models.</p>
<p>This composite class encodes the responsibility for translating between the flat data structure produced by the user interface and the cluster of objects that is produced. It's best suited for representing a handful of related records that each have singular relationships - <code>has_one</code>/<code>belongs_to</code>, rather than plural <code>has_many</code> relationships.</p>
<p>There are a few other benefits to these composite classes, too. They are handy for adding any conditional logic in the composition, such as a Signup creating a Billing entry for paid Plan levels. The composite class should be easier to isolation test, compared to testing the persistence outcomes of <code>accepts_nested_attributes_for</code>. It's also useful to note that the composite Signup class is not actually persisted; it simply represents a convenient abstraction in the domain model.</p>
<p>In this case, it's straightforward to provide an HTTP API endpoint that exposes the <code>signups</code> resource and to model this on the client side as a corresponding Backbone model. All of the attributes on the composite resource are at a single level (not nested), so this is a familiar client-side implementation.</p>
<p>This general pattern encapsulates the composite nature of the resource, leaving the fact that it is persisted across multiple tables as an implementation detail. This keeps the presentation tier simpler, unconcerned with the composite nature of the resource.</p>
</section>
<section id="accepts_nested_attributes_for" class="level2">
<h2><a href="#accepts_nested_attributes_for"><code>accepts_nested_attributes_for</code></a></h2>
<p>A classic situation to encounter nested attributes is in <code>has_many :through</code> relationships. For example, consider a workflow in which you assign multiple people to perform a job. The three domain models are <code>Job</code>, <code>Worker</code>, and the join model <code>Assignment</code>.</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="co"># app/models/job.rb</span>
<span class="kw">class</span> <span class="dt">Job</span> &lt; <span class="dt">ActiveRecord</span>::<span class="dt">Base</span>
  has_many <span class="st">:assignments</span>
  has_many <span class="st">:workers</span>, <span class="st">:though</span> =&gt; <span class="st">:assignments</span>
<span class="kw">end</span>

<span class="co"># app/models/assignment.rb</span>
<span class="kw">class</span> <span class="dt">Assignment</span> &lt; <span class="dt">ActiveRecord</span>::<span class="dt">Base</span>
  belongs_to <span class="st">:job</span>
  belongs_to <span class="st">:worker</span>
<span class="kw">end</span>

<span class="co"># app/models/worker.rb</span>
<span class="kw">class</span> <span class="dt">Worker</span> &lt; <span class="dt">ActiveRecord</span>::<span class="dt">Base</span>
  has_many <span class="st">:assignments</span>
  has_many <span class="st">:jobs</span>, <span class="st">:through</span> =&gt; <span class="st">:assignments</span>
<span class="kw">end</span></code></pre>
<p>Earlier, we discussed how Ajax-enabled web applications often provide more finely-grained user interfaces that allow the user to submit information in smaller chunks and allow the developer to model the persistence and HTTP API in finer pieces. Let's say that we have a user interface where we create a job and bulk assign several workers to the new job all in one form. It's possible to achieve a good, fast user experience while still creating the job and its child assignment records in separate requests.</p>
<p>However, it may still be preferable in some cases to perform these bulk submissions, creating a parent record along with several child records all in one HTTP request. We'll model this on the backend with Rails' <code>accepts_nested_attributes_for</code>:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="co"># app/models/job.rb</span>
<span class="kw">class</span> <span class="dt">Job</span> &lt; <span class="dt">ActiveRecord</span>::<span class="dt">Base</span>
  has_many <span class="st">:assignments</span>
  has_many <span class="st">:workers</span>, <span class="st">:though</span> =&gt; <span class="st">:assignments</span>
  accepts_nested_attributes_for <span class="st">:assignments</span>
<span class="kw">end</span></code></pre>
<p>As a quick refresher, this allows us in our Rails code to set <code>@job.assignments_attributes = [{}, {}, ...]</code> with an Array of Hashes, each containing attributes for a new <code>Assignment</code>, the join model. This behavior of Rails <code>accepts_nested_attributes_for</code> shapes our HTTP API: A simple API endpoint controller should be able to pass the request parameters straight through to ActiveRecord, so the JSON going over the HTTP request will look like this:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">/* POST /api/v1/jobs */</span>
{
  <span class="dt">name</span>: <span class="st">&quot;Move cardboard boxes to new warehouse&quot;</span>,
  <span class="dt">description</span>: <span class="st">&quot;Move boxes from closet C3 to warehouse W2&quot;</span>,
  <span class="dt">assignmment_attributes</span>: [
    { <span class="dt">worker_id</span>: <span class="dv">1</span> },
    { <span class="dt">worker_id</span>: <span class="dv">3</span> },
    { <span class="dt">worker_id</span>: <span class="dv">5</span> }
  ]
}</code></pre>
<p>Shifting our focus to the client-side implementation, we can largely ignore the <code>Assignment</code> join model in Backbone, and just model this nested association directly. We'll use a <code>Job</code> Backbone model containing a <code>Workers</code> collection. This is a simplified perspective of the relationship, but it is all that the client needs to know.</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/my_app.js</span>
MyApp = {};
<span class="ot">MyApp</span>.<span class="fu">Models</span> = {};
<span class="ot">MyApp</span>.<span class="fu">Collections</span> = {};

<span class="co">// app/assets/javascripts/models/worker.js</span>
<span class="ot">MyApp</span>.<span class="ot">Models</span>.<span class="fu">Worker</span> = <span class="ot">Backbone</span>.<span class="ot">Model</span>.<span class="fu">extend</span>({
});

<span class="co">// app/assets/javascripts/collections/workers.js</span>
<span class="ot">MyApp</span>.<span class="ot">Collections</span>.<span class="fu">Workers</span> = <span class="ot">Backbone</span>.<span class="ot">Collection</span>.<span class="fu">extend</span>({
  <span class="dt">model</span>: <span class="ot">ExampleApp</span>.<span class="ot">Models</span>.<span class="fu">Worker</span>
});

<span class="co">// app/assets/javascripts/models/job.js</span>
<span class="ot">MyApp</span>.<span class="ot">Models</span>.<span class="fu">Job</span> = <span class="ot">Backbone</span>.<span class="ot">Model</span>.<span class="fu">extend</span>({
  <span class="dt">urlRoot</span>: <span class="st">'/api/v1/jobs'</span>,

  <span class="dt">initialize</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="fu">workers</span> = <span class="kw">new</span> <span class="ot">MyApp</span>.<span class="ot">Collections</span>.<span class="fu">Workers</span>();
  },

  <span class="dt">toJSON</span>: <span class="kw">function</span>() {
    <span class="kw">var</span> json = <span class="ot">_</span>.<span class="fu">clone</span>(<span class="kw">this</span>.<span class="fu">attributes</span>);

    <span class="ot">json</span>.<span class="fu">assignment_attributes</span> = <span class="kw">this</span>.<span class="ot">workers</span>.<span class="fu">map</span>(<span class="kw">function</span>(worker) {
      <span class="kw">return</span> { <span class="dt">worker_id</span>: <span class="ot">worker</span>.<span class="fu">id</span> };
    });

    <span class="kw">return</span> json;
  }
});</code></pre>
<p>Now, you can add workers directly to the job:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> worker3 = <span class="kw">new</span> <span class="ot">MyApp</span>.<span class="ot">Models</span>.<span class="fu">Worker</span>({ <span class="dt">id</span>: <span class="dv">3</span> });
<span class="kw">var</span> worker5 = <span class="kw">new</span> <span class="ot">MyApp</span>.<span class="ot">Models</span>.<span class="fu">Worker</span>({ <span class="dt">id</span>: <span class="dv">5</span> });

<span class="kw">var</span> job = <span class="kw">new</span> <span class="ot">MyApp</span>.<span class="ot">Models</span>.<span class="fu">Job</span>();
<span class="ot">job</span>.<span class="fu">set</span>({ <span class="dt">title</span>: <span class="st">&quot;Raise barn walls&quot;</span> });
<span class="ot">job</span>.<span class="ot">workers</span>.<span class="fu">add</span>(worker3);
<span class="ot">job</span>.<span class="ot">workers</span>.<span class="fu">add</span>(worker5);

<span class="ot">JSON</span>.<span class="fu">stringify</span>(<span class="ot">job</span>.<span class="fu">toJSON</span>()) <span class="co">// Results in:</span>
                             <span class="co">//</span>
                             <span class="co">// {</span>
                             <span class="co">//   &quot;title&quot;:  &quot;Raise barn walls&quot;,</span>
                             <span class="co">//   &quot;assignment_attributes&quot;: [</span>
                             <span class="co">//     {&quot;worker_id&quot;:3},</span>
                             <span class="co">//     {&quot;worker_id&quot;:5}</span>
                             <span class="co">//   ]</span>
                             <span class="co">// }</span></code></pre>
<p>...and saving the Backbone <code>Job</code> model will submit correctly structured JSON to the Rails server.</p>
<p>This, of course, only covers the creation of nested bulk models. Subsequently fetching a nested object graph from the server involves a handful of separate design decisions around producing JSON on the server and parsing it on the client. These concerns are discussed in the &quot;Model relationships&quot; chapter.</p>
</section>
<section id="example-for-accepts_nested_attributes_for" class="level2">
<h2><a href="#example-for-accepts_nested_attributes_for">Example for <code>accepts_nested_attributes_for</code></a></h2>
<p>In the example application, a task may be assigned to zero or more users. The association is tracked through an <code>Assignment</code> join model, and you can create assignments and tasks at the same time. Users can see tasks they have created or tasks that others have created and assigned to them.</p>
<p>We use <code>accepts_nested_attributes_for</code> for persisting the task and its nested assignments. The <code>Task</code> Backbone model takes care of parsing the assignment JSON to nest an <code>Assignments</code> collection inside itself. It also provides correctly-formatted JSON so that Rails picks up the nested association.</p>
<p>The <code>TasksNew</code> view handles the expanding interface for adding more assignees, and is also responsible for finding the Backbone <code>User</code> models by email to associate them to the task while it is constructed.</p>
</section>
<section id="duplicating-business-logic-across-the-client-and-server" class="level2">
<h2><a href="#duplicating-business-logic-across-the-client-and-server">Duplicating business logic across the client and server</a></h2>
<p>When you're building a multi-tier application where business logic is spread across tiers, one big challenge you face is to avoid duplicating that logic across tiers. There is a trade-off here, between duplication and performance. It's desirable to have only one implementation of a particular concern in your domain, but it's also desirable for your application to perform responsively.</p>
<section id="an-example-model-validations" class="level3">
<h3><a href="#an-example-model-validations">An example: model validations</a></h3>
<p>For example, let's say that a user must have an email address.</p>
<p>At one end of the scale, there is no duplication: All business logic is defined in one tier, and other tiers access the logic by remote invocation. Your Rails <code>Member</code> model provides a validation:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="co"># app/models/member.rb</span>
<span class="kw">class</span> <span class="dt">Member</span> &lt; <span class="dt">ActiveRecord</span>::<span class="dt">Base</span>
  validate <span class="st">:email</span>, <span class="st">:presence</span> =&gt; <span class="dv">true</span>
<span class="kw">end</span></code></pre>
<p>The Backbone view attempts to persist the member as usual, binding to its <code>error</code> event to handle the server-side error:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/member_form_view.js</span>
<span class="kw">var</span> MemberFormView = <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">extend</span>({
  <span class="dt">events</span>: {
    <span class="st">&quot;submit form&quot;</span>: <span class="st">&quot;submit&quot;</span>
  },

  <span class="dt">initialize</span>: <span class="kw">function</span>() {
    <span class="ot">_</span>.<span class="fu">bindAll</span>(<span class="kw">this</span>, <span class="st">&quot;error&quot;</span>);
    <span class="kw">this</span>.<span class="ot">model</span>.<span class="fu">bind</span>(<span class="st">&quot;error&quot;</span>, <span class="kw">this</span>.<span class="fu">error</span>);
  },

  <span class="dt">render</span>: <span class="kw">function</span>() {
    <span class="co">// render form...</span>
  },

  <span class="dt">submit</span>: <span class="kw">function</span>() {
    <span class="kw">var</span> attributes = <span class="kw">new</span> <span class="fu">FormSerializer</span>(<span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'form'</span>)).<span class="fu">attributes</span>();
    <span class="kw">this</span>.<span class="ot">model</span>.<span class="fu">save</span>(attributes);
  },

  <span class="dt">error</span>: <span class="kw">function</span>(model, errorResponse) {
    <span class="kw">var</span> errors = <span class="kw">new</span> <span class="fu">ErrorList</span>(errorResponse);
    <span class="kw">new</span> <span class="fu">ErrorView</span>({ <span class="dt">el</span>: <span class="ot">self</span>.<span class="fu">el</span>, <span class="dt">errors</span>: errors }).<span class="fu">render</span>();
  }
});</code></pre>
<p>This uses the <code>ErrorView</code> class, which is able to parse the error hash returned from Rails, which was discussed in the &quot;Validations&quot; section of the &quot;Models and Collections&quot; chapter.</p>
<blockquote>
<p>This is probably the first time you'll see <code>_.bindAll()</code>, so let's pause briefly to introduce what it is doing.</p>
<p>When an event is triggered, the code invoking the callback is able to set the JavaScript context. By calling <code>_.bindAll(this, &quot;error&quot;)</code>, we are instead overriding whatever context it may have been, and setting it to <code>this</code>. This is necessary so that when we call <code>this.$(\'form\')</code> in the <code>error()</code> callback, we get the right object back.</p>
<p>Always use <code>_.bindAll</code> when you need to force the JavaScript context (<code>this</code>) within a function's body.</p>
</blockquote>
<p>In the case of no duplication, your Backbone <code>Member</code> model does not declare this validation. A user fills out a form for a creating a new member in your application, submits the form, and, if they forget to include an email address, a validation message is displayed. The application delegates the entire validation concern to the server, as we saw in the &quot;Validations&quot; section of the &quot;Models and Collections&quot; chapter.</p>
<p>However, round-tripping validation to the server can be too slow in some cases, and we'd like to provide feedback to the end user more quickly. To do this, we have to implement the validation concern on the client side as well. Backbone provides a facility for validating models during their persistence, so we could write:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/models/member.js</span>
<span class="kw">var</span> Member = <span class="ot">Backbone</span>.<span class="ot">Model</span>.<span class="fu">extend</span>({
  <span class="dt">validate</span>: <span class="kw">function</span>() {
    <span class="kw">var</span> errors = {};
    <span class="kw">if</span> (<span class="ot">_</span>.<span class="fu">isEmpty</span>(<span class="kw">this</span>.<span class="fu">get</span>(<span class="st">'email'</span>))) {
      <span class="ot">errors</span>.<span class="fu">email</span> = [<span class="st">&quot;can't be blank&quot;</span>];
    }
    <span class="kw">return</span> errors;
  }
});</code></pre>
<p>Conveniently, we've structured the return value of the <code>validate()</code> function to mirror the structure of the Rails error JSON we saw returned above. Now, we <em>could</em> augment the <code>ErrorView</code> class's constructor function to handle either client-side or server-side errors:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/utility/error_list.js</span>
<span class="kw">var</span> ErrorList = <span class="kw">function</span>(responseOrErrors) {
  <span class="kw">if</span> (responseOrErrors &amp;&amp; <span class="ot">responseOrErrors</span>.<span class="fu">responseText</span>) {
    <span class="kw">this</span>.<span class="fu">attributesWithErrors</span> = <span class="ot">JSON</span>.<span class="fu">parse</span>(<span class="ot">response</span>.<span class="fu">responseText</span>);
  } <span class="kw">else</span> {
    <span class="kw">this</span>.<span class="fu">attributesWithErrors</span> = responseOrErrors;
  }
};</code></pre>
<p>With Backbone, the <code>validate()</code> function is called for each invocation of <code>save()</code>. Validations can also be run on <code>set()</code> by passing <code>{validate: true}</code>, so as soon as we set the email address on the member, its presence is validated. For the user experience with the quickest response, we could observe changes on the email form field, updating the model's <code>email</code> attribute whenever it changes, and displaying the inline error message immediately.</p>
<p>With <code>ErrorList</code> able to handle either client-side or server-side error messages, we have a server-side guarantee of data correctness, footnote<sup><a href="#fn1" class="footnoteRef" id="fnref1">1</a></sup> and a responsive UI that can validate the member's email presence without round-tripping to the server.</p>
<p>The tradeoff we've made is that of duplication; the concern of &quot;what constitutes a valid member&quot; is written twice -- in two different languages, no less. In some cases this is unavoidable. In others, there are mitigation strategies for reducing the duplication, or at least its impact on your code quality and maintainability.</p>
<p>Let's take a look at what kinds of logic you might find duplicated, and then at strategies for reducing duplication.</p>
</section>
<section id="kinds-of-logic-you-duplicate" class="level3">
<h3><a href="#kinds-of-logic-you-duplicate">Kinds of logic you duplicate</a></h3>
<p>In Rails applications, our model layer can contain a variety of kinds of business logic:</p>
<ul>
<li>Validations: This is pretty straightforward, since there's a well-defined Rails API for validating ActiveModel classes.</li>
<li>Querying: Sorting and filtering fall into this category. Implementations vary slightly, but are often built with <code>named_scope</code> or class methods returning <code>ActiveRecord::Relation</code> instances. Occasionally querying is delegated to class other than the ActiveRecord instance.</li>
<li>Callbacks: Similar to validations, there's a well-defined API for callbacks (or &quot;lifecycle events&quot;) on Rails models; <code>after_create</code> and so on.</li>
<li>Algorithms: Everything else. Sometimes they're implemented on the ActiveRecord instances, but are often split out into other classes and used via composition. One example from commerce apps would be an <code>Order</code> summing the costs of its <code>LineItems</code>. Or consider an example from an agile project planning application, where a <code>ProjectPlan</code> recalculates a <code>Project</code>'s set of <code>UserStory</code> objects into weekly <code>Iteration</code> bucket objects.</li>
</ul>
<p>There are often other methods on your Rails models, but they are either a mix of the above categories (a <code>state_machine</code> implementation could be considered a mix of validations and callback) and other methods that don't count as business logic - methods that are actually implementing presentation concerns are a frequent example.</p>
<p>It's worth considering each of these categories in turn, and how they can be distributed across client and server to provide a responsive experience.</p>
</section>
<section id="validations-1" class="level3">
<h3><a href="#validations-1">Validations</a></h3>
<p>Validations are probably the lowest-hanging fruit. Since the API for declaring validations is largely declarative and well-bounded, we can imagine providing an interface that introspects Rails models and builds a client-side implementation automatically.</p>
<p>Certainly, there are cases which aren't possible to automate, such as custom Ruby validation code or validations which depend on a very large dataset that would be impractical to deliver to the client (say, a ZIP code database). These cases would need to fall back to either an XHR call to the server-side implementation, or a custom-written client-side implementation - a duplicate implementation.</p>
<p>This is actually what the <a href="https://github.com/bcardarella/client_side_validations"><code>client_side_validations</code> gem</a> does, only it is not available for Backbone yet. However, it is on the roadmap, and the &quot;model&quot; branch is a work in progress of this functionality. We will be keeping an eye on this branch: <a href="https://github.com/bcardarella/client_side_validations/tree/model">https://github.com/bcardarella/client_side_validations/tree/model</a></p>
</section>
<section id="querying" class="level3">
<h3><a href="#querying">Querying</a></h3>
<p>Like validations, Rails the syntax and outcome of many common Rails query methods are relatively declarative. It may be possible to convert server-side scopes into client-side collection filtering. However, that is of questionable value in most Backbone applications we've encountered.</p>
<p>In most Backbone apps there ends up being little duplication between client and server sorting and filtering. Either the logic happens on the client and is therefore not needed on the server, or the search logic happens on the server and is not needed on the client.</p>
<p>If you find that your application has duplication here, consider whether there may be a better way to separate responsibilities.</p>
</section>
<section id="callbacks" class="level3">
<h3><a href="#callbacks">Callbacks</a></h3>
<p>We've found that model callbacks are rarely duplicated between the client and server sides. It's actually more likely that your client-side models will differ sufficiently from the server-side models, since they are in the presentation tier and the concerns are different.</p>
<p>As you continue to push more logic client-side - as we've found is the trend when using Backbone - you may find that some life-cycle events may move or be duplicated from the server to the client. The implementation and concern of these often varies significantly from what they were on the server. For example, a callback translated to Backbone will likely be implemented as an event being fired and listened to by another object.</p>
</section>
<section id="algorithms" class="level3">
<h3><a href="#algorithms">Algorithms</a></h3>
<p>General algorithms are often the trickiest things for which to resolve duplication between client and server. It's also common that important algorithms are, in fact, needed on both client and server.</p>
<p>The more complicated the algorithm, the more troubling this will become. Bugs may be introduced, and the client- and server-side algorithms might not actually produce the same results.</p>
<p>You could implement the actual logic of the algorithm in JavaScript and then make that available to Ruby, by using something like <a href="https://github.com/sstephenson/execjs">ExecJS</a> to run the JavaScript code from Ruby. But you must weigh the cost of that additional complexity and overhead against the code of duplicating logic.</p>
<p>Also, you could consider JavaScript on the server side in something like Node.js, exposed via a webservice that Rails can access. However, it is debatable whether this is actually easier.</p>
<p>Finally, it may be possible to reduce duplication by splitting responsibility for the algorithm in pieces: half on the client and half on the server, and then use coordinated communication and caching to accomplish the algorithm and improve the performance, respectively.</p>
<p>More information about this technique can be found here:</p>
<ul>
<li><a href="http://c2.com/cgi/wiki?HalfObjectPlusProtocol">http://c2.com/cgi/wiki?HalfObjectPlusProtocol</a></li>
<li><a href="http://c2.com/cgi/wiki?HoppPatternLanguage">http://c2.com/cgi/wiki?HoppPatternLanguage</a></li>
</ul>
</section>
</section>
<section id="synchronizing-between-clients" class="level2">
<h2><a href="#synchronizing-between-clients">Synchronizing between clients</a></h2>
<p>A driving force behind the move to rich client web apps is to improve the user experience. These applications are more responsive and can support more detailed and stateful interactions.</p>
<p>One such interaction involves multiple concurrent users interacting with the same resource in real time. We can deliver a more seamless experience by propagating users' changes to one another as they take place: When you and I edit the same document, I see your changes on my screen as you type them. If you've ever used Google Docs or Google Wave, you've seen this in action.</p>
<p>So, how can we build this functionality into our own applications?</p>
<section id="the-moving-parts" class="level3">
<h3><a href="#the-moving-parts">The moving parts</a></h3>
<p>There are a few different pieces that we'll put together for this. The basic parts are:</p>
<ol type="1">
<li><strong>Change events.</strong> The fundamental unit of information that we broadcast through our system to keep clients in sync. Delivered as messages, these events contain enough information for any receiving client to update its own data without needing a full re-fetch from the server.</li>
<li><strong>An event source.</strong> With trusted clients, changes can originate directly from the client. More often, however, we will want the server to arbitrate changes so that it can apply authorization, data filtering, and validations.</li>
<li><strong>A transport layer that supports pushing to clients.</strong> <a href="http://www.w3.org/TR/websockets/">The WebSocket API</a> is such a transport, and is ideal for its low overhead and latency.</li>
<li><strong>Event-driven clients.</strong> Clients should be able to react to incoming change events, ideally handling them with incremental UI updates rather than re-drawing themselves entirely. Backbone helps in this department, as your client-side application is likely already set up to handle such events.</li>
<li><strong>A message bus.</strong> Separating the concern of message delivery from our main application helps it stay smaller and helps us scale our messaging and application infrastructure separately. There are already several great off-the-shelf tools we can use for this.</li>
</ol>
</section>
<section id="putting-it-together-a-look-at-the-life-cycle-of-a-change" class="level3">
<h3><a href="#putting-it-together-a-look-at-the-life-cycle-of-a-change">Putting it together: A look at the life cycle of a change</a></h3>
<p>Revisiting our todo application, we'd like to add the ability to collaborate on todo lists, so that different users will be able to work on the same todo list concurrently. Several users can look at the same list; adding, changing, and checking off items.</p>
<p>There are a few technical decisions mentioned previously. For this example, we will:</p>
<ol type="1">
<li>Use Rails on the server and Backbone on the client.</li>
<li>Use the server as the canonical event source so that clients do not have to trust one another. In particular, we'll employ an <code>ActiveRecord::Observer</code> that observes Rails model changes and dispatches a change event.</li>
<li>Use <a href="http://faye.jcoglan.com">Faye</a> as the messaging backend, which has Ruby and JavaScript implementations for clients and server. Faye implements the <a href="http://svn.cometd.com/trunk/bayeux/bayeux.html">Bayeux protocol</a>, prefers WebSocket for transport (though it gracefully degrades to long polling, CORS, or JSON-P), and supports a bunch of other goodies like clustering and extensions (inbound- and outbound- message filtering, like Rack middleware).</li>
</ol>
<p>In our application, there are several connected clients viewing the same todo list, and one user, &quot;Alice,&quot; makes a change to an item on the list.</p>
<p>Let's take a look at the lifecycle of one change event.</p>
<p>Setup:</p>
<ol type="1">
<li>An instance of JavaScript class <code>BackboneSync.FayeSubscriber</code> is instantiated on each client. It is configured with a channel to listen to, and a collection to update.</li>
<li>The Faye server is started.</li>
<li>The Rails server is started, and several clients are connected and viewing <code>#todo_lists/1</code>.</li>
</ol>
<p>On Alice's machine, the client responsible for the change:</p>
<ol type="1">
<li>Alice clicks &quot;Save&quot; in her view of the list.</li>
<li>The &quot;save&quot; view event is triggered.</li>
<li>The event handler invokes <code>this.model.save(attributes)</code>.</li>
<li><code>Backbone.Model.prototype.save</code> calls <code>Backbone.sync</code>.</li>
<li><code>Backbone.sync</code> invokes <code>$.ajax</code> and issues an HTTP PUT request to the server.</li>
</ol>
<p>On the server:</p>
<ol type="1">
<li>Rails handles the PUT request and calls <code>#update_attributes</code> on an ActiveRecord model instance.</li>
<li>An <code>ActiveRecord::Observer</code> observing this model gets its <code>#after_save</code> method invoked.</li>
<li>The observer dispatches a change event message to Faye.</li>
<li>Faye broadcasts the change event to all subscribers.</li>
</ol>
<p>On all clients:</p>
<ol type="1">
<li><code>FayeSubscriber</code> receives the change event message, likely over a WebSocket.</li>
<li>The subscriber parses the event message, picking out the event (<code>update</code>), the <code>id</code> of the model to update, and a new set of attributes to apply.</li>
<li>The <code>FayeSubscriber</code> fetches the model from the collection, and calls <code>set</code> on it to update its attributes.</li>
</ol>
<p>Now all the clients have received the changeset that Alice made.</p>
</section>
<section id="implementation-step-1-faye-server" class="level3">
<h3><a href="#implementation-step-1-faye-server">Implementation: Step 1, Faye server</a></h3>
<p>We'll need to run Faye to relay messages from publishers to subscribers. For Rails apps that depend on Faye, We recommend keeping a <code>faye/</code> subdirectory under the app root that contains a <code>Gemfile</code> and <code>config.ru</code>, and maybe a shell script to start Faye:</p>
<pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">cat</span> faye/Gemfile

<span class="kw">source</span> <span class="st">'http://rubygems.org'</span>
<span class="kw">gem</span> <span class="st">'faye'</span>
<span class="kw">gem</span> <span class="st">'thin'</span>

$ <span class="kw">cat</span> faye/config.ru

<span class="kw">require</span> <span class="st">'faye'</span>
<span class="kw">bayeux</span> = Faye::RackAdapter.new(:mount =<span class="kw">&gt;</span> <span class="st">'/faye'</span>, :timeout =<span class="kw">&gt;</span> 25)
<span class="kw">bayeux.listen</span>(9292)

$ <span class="kw">cat</span> faye/run.sh

<span class="co">#!/usr/bin/env bash</span>
<span class="ot">BASEDIR=$(</span><span class="kw">dirname</span> <span class="ot">$0)</span>
<span class="ot">BUNDLE_GEMFILE=$BASEDIR</span>/Gemfile
<span class="kw">bundle</span> exec rackup <span class="ot">$BASEDIR</span>/config.ru -s thin -E production

$ <span class="kw">bundle</span>
<span class="kw">(...)</span>
<span class="kw">Your</span> bundle is complete! Use <span class="kw">`bundle</span> show [gemname]<span class="kw">`</span> to see where a bundled gem is installed.

$ <span class="kw">./faye/run.sh</span>

<span class="kw">&gt;&gt;</span> <span class="kw">Thin</span> web server (v1.2.11 codename Bat-Shit Crazy)
<span class="kw">&gt;&gt;</span> <span class="kw">Maximum</span> connections set to 1024
<span class="kw">&gt;&gt;</span> <span class="kw">Listening</span> on 0.0.0.0:9292, CTRL+C to stop</code></pre>
</section>
<section id="implementing-it-step-2-activerecord-observers" class="level3">
<h3><a href="#implementing-it-step-2-activerecord-observers">Implementing it: Step 2, ActiveRecord observers</a></h3>
<p>Now that the message bus is running, let's walk through the server code. The Rails app's responsibility is this: Whenever a todo model is created, updated, or deleted, it will publish a change event message.</p>
<p>This is implemented with an <code>ActiveRecord::Observer</code>. We provide the functionality in a module:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="co"># lib/backbone_sync.rb</span>
<span class="kw">module</span> <span class="dt">BackboneSync</span>
  <span class="kw">module</span> <span class="dt">Rails</span>
    <span class="kw">module</span> <span class="dt">Faye</span>
      mattr_accessor <span class="st">:root_address</span>
      <span class="dv">self</span>.root_address = <span class="st">'http://localhost:9292'</span>

      <span class="kw">module</span> <span class="dt">Observer</span>
        <span class="kw">def</span> after_update(model)
          <span class="dt">Event</span>.new(model, <span class="st">:update</span>).broadcast
        <span class="kw">end</span>

        <span class="kw">def</span> after_create(model)
          <span class="dt">Event</span>.new(model, <span class="st">:create</span>).broadcast
        <span class="kw">end</span>

        <span class="kw">def</span> after_destroy(model)
          <span class="dt">Event</span>.new(model, <span class="st">:destroy</span>).broadcast
        <span class="kw">end</span>
      <span class="kw">end</span>

      <span class="kw">class</span> <span class="dt">Event</span>
        <span class="kw">def</span> initialize(model, event)
          <span class="ot">@model</span> = model
          <span class="ot">@event</span> = event
        <span class="kw">end</span>

        <span class="kw">def</span> broadcast
          <span class="dt">Net</span>::<span class="dt">HTTP</span>.post_form(uri, <span class="st">:message</span> =&gt; message)
        <span class="kw">end</span>

        <span class="kw">private</span>

        <span class="kw">def</span> uri
          <span class="dt">URI</span>.parse(<span class="st">&quot;</span><span class="ot">#{</span><span class="dt">BackboneSync</span>::<span class="dt">Rails</span>::<span class="dt">Faye</span>.root_address<span class="ot">}</span><span class="st">/faye&quot;</span>)
        <span class="kw">end</span>

        <span class="kw">def</span> message
          { <span class="st">:channel</span> =&gt; channel,
            <span class="st">:data</span> =&gt; data          }.to_json
        <span class="kw">end</span>

        <span class="kw">def</span> channel
          <span class="st">&quot;/sync/</span><span class="ot">#{@model</span>.class.table_name<span class="ot">}</span><span class="st">&quot;</span>
        <span class="kw">end</span>

        <span class="kw">def</span> data
          { <span class="ot">@event</span> =&gt; { <span class="ot">@model</span>.id =&gt; <span class="ot">@model</span>.as_json } }
        <span class="kw">end</span>
      <span class="kw">end</span>
    <span class="kw">end</span>
  <span class="kw">end</span>
<span class="kw">end</span></code></pre>
<p>...and then mix it into a concrete observer class in our application. In this case, we name it <code>TodoObserver</code>:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="co"># app/observers/todo_observer.rb</span>
<span class="kw">class</span> <span class="dt">TodoObserver</span> &lt; <span class="dt">ActiveRecord</span>::<span class="dt">Observer</span>
  <span class="kw">include</span> <span class="dt">BackboneSync</span>::<span class="dt">Rails</span>::<span class="dt">Faye</span>::<span class="dt">Observer</span>
<span class="kw">end</span></code></pre>
<p>This observer is triggered each time a Rails <code>Todo</code> model is created, updated, or destroyed. When one of these events happen, the observer sends along a message to our message bus, indicating the change.</p>
<p>Let's say that a <code>Todo</code> was just created:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby">&gt;&gt; <span class="dt">Todo</span>.create(title: <span class="st">&quot;Buy some tasty kale juice&quot;</span>)
=&gt; <span class="co">#&lt;Todo id: 17, title: &quot;Buy some tasty kale juice&quot;, created_at: &quot;2011-09-06 20:49:03&quot;, updated_at: &quot;2011-09-07 15:01:09&quot;&gt;</span></code></pre>
<p>The message looks like this:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript">{
  <span class="st">&quot;channel&quot;</span>: <span class="st">&quot;/sync/todos&quot;</span>,
  <span class="st">&quot;data&quot;</span>: {
    <span class="st">&quot;create&quot;</span>: {
      <span class="st">&quot;17&quot;</span>: {
        <span class="st">&quot;id&quot;</span>: <span class="dv">17</span>,
        <span class="st">&quot;title&quot;</span>: <span class="st">&quot;Buy some tasty kale juice&quot;</span>,
        <span class="st">&quot;created_at&quot;</span>: <span class="st">&quot;2011-09-06T20:49:03Z&quot;</span>,
        <span class="st">&quot;updated_at&quot;</span>: <span class="st">&quot;2011-09-07T15:01:09Z&quot;</span>
      }
    }
  }
}</code></pre>
<p>Received by Faye, the message is broadcast to all clients subscribing to the <code>/sync/todos</code> channel, including our browser-side <code>FayeSubscriber</code> objects.</p>
</section>
<section id="implementing-it-step-3-in-browser-subscribers" class="level3">
<h3><a href="#implementing-it-step-3-in-browser-subscribers">Implementing it: Step 3, In-browser subscribers</a></h3>
<p>In each browser, we want to connect to the Faye server, subscribe to events on channels that interest us, and update Backbone collections based on those messages.</p>
<p>Faye runs an HTTP server, and serves up its own client library, so that's easy to pull in:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;script</span><span class="ot"> type=</span><span class="st">&quot;text/javascript&quot;</span><span class="ot"> src=</span><span class="st">&quot;http://localhost:9292/faye.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></code></pre>
<p>To subscribe to Faye channels, instantiate a <code>Faye.Client</code> and call <code>subscribe</code> on it:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">var</span> client = <span class="kw">new</span> <span class="ot">Faye</span>.<span class="fu">Client</span>(<span class="st">'http://localhost:9292/faye'</span>);
<span class="ot">client</span>.<span class="fu">subscribe</span>(<span class="st">'/some/channel'</span>, <span class="kw">function</span>(message) {
  <span class="co">// handle message</span>
});</code></pre>
<p>When the browser receives messages from Faye, we want to update a Backbone collection. Let's wrap up those two concerns into a <code>FayeSubscriber</code>:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/backbone_sync.js</span>
<span class="kw">this</span>.<span class="fu">BackboneSync</span> = <span class="kw">this</span>.<span class="fu">BackboneSync</span> || {};

<span class="ot">BackboneSync</span>.<span class="fu">RailsFayeSubscriber</span> = (<span class="kw">function</span>() {
  <span class="kw">function</span> <span class="fu">RailsFayeSubscriber</span>(collection, options) {
    <span class="kw">this</span>.<span class="fu">collection</span> = collection;
    <span class="kw">this</span>.<span class="fu">client</span> = <span class="kw">new</span> <span class="ot">Faye</span>.<span class="fu">Client</span>(<span class="st">'&lt;%= BackboneSync::Rails::Faye.root_address %&gt;/faye'</span>);
    <span class="kw">this</span>.<span class="fu">channel</span> = <span class="ot">options</span>.<span class="fu">channel</span>;
    <span class="kw">this</span>.<span class="fu">subscribe</span>();
  }

  <span class="ot">RailsFayeSubscriber</span>.<span class="ot">prototype</span>.<span class="fu">subscribe</span> = <span class="kw">function</span>() {
    <span class="kw">return</span> <span class="kw">this</span>.<span class="ot">client</span>.<span class="fu">subscribe</span>(<span class="st">&quot;/sync/&quot;</span> + <span class="kw">this</span>.<span class="fu">channel</span>, <span class="ot">_</span>.<span class="fu">bind</span>(<span class="kw">this</span>.<span class="fu">receive</span>, <span class="kw">this</span>));
  };

  <span class="ot">RailsFayeSubscriber</span>.<span class="ot">prototype</span>.<span class="fu">receive</span> = <span class="kw">function</span>(message) {
    <span class="kw">var</span> self = <span class="kw">this</span>;
    <span class="kw">return</span> <span class="ot">$</span>.<span class="fu">each</span>(message, <span class="kw">function</span>(event, eventArguments) {
      <span class="kw">return</span> self[event](eventArguments);
    });
  };

  <span class="ot">RailsFayeSubscriber</span>.<span class="ot">prototype</span>.<span class="fu">update</span> = <span class="kw">function</span>(params) {
    <span class="kw">var</span> self = <span class="kw">this</span>;
    <span class="kw">return</span> <span class="ot">$</span>.<span class="fu">each</span>(params, <span class="kw">function</span>(id, attributes) {
      <span class="kw">var</span> model = <span class="ot">self</span>.<span class="ot">collection</span>.<span class="fu">get</span>(id);
      <span class="kw">return</span> <span class="ot">model</span>.<span class="fu">set</span>(attributes);
    });
  };

  <span class="ot">RailsFayeSubscriber</span>.<span class="ot">prototype</span>.<span class="fu">create</span> = <span class="kw">function</span>(params) {
    <span class="kw">var</span> self = <span class="kw">this</span>;
    <span class="kw">return</span> <span class="ot">$</span>.<span class="fu">each</span>(params, <span class="kw">function</span>(id, attributes) {
      <span class="kw">var</span> model = <span class="kw">new</span> <span class="ot">self</span>.<span class="ot">collection</span>.<span class="fu">model</span>(attributes);
      <span class="kw">return</span> <span class="ot">self</span>.<span class="ot">collection</span>.<span class="fu">add</span>(model);
    });
  };

  <span class="ot">RailsFayeSubscriber</span>.<span class="ot">prototype</span>.<span class="fu">destroy</span> = <span class="kw">function</span>(params) {
    <span class="kw">var</span> self = <span class="kw">this</span>;
    <span class="kw">return</span> <span class="ot">$</span>.<span class="fu">each</span>(params, <span class="kw">function</span>(id, attributes) {
      <span class="kw">var</span> model = <span class="ot">self</span>.<span class="ot">collection</span>.<span class="fu">get</span>(id);
      <span class="kw">return</span> <span class="ot">self</span>.<span class="ot">collection</span>.<span class="fu">remove</span>(model);
    });
  };

  <span class="kw">return</span> RailsFayeSubscriber;
})();</code></pre>
<p>Now, for each collection that we'd like to keep in sync, we instantiate a corresponding <code>FayeSubscriber</code>. Say, in your application bootstrap code:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"># app/assets/javascripts/routers/<span class="ot">todos</span>.<span class="fu">js</span>
<span class="ot">MyApp</span>.<span class="ot">Routers</span>.<span class="fu">TodosRouter</span> = <span class="ot">Backbone</span>.<span class="ot">Router</span>.<span class="fu">extend</span>({
  <span class="dt">initialize</span>: <span class="kw">function</span>(options) {
    <span class="kw">this</span>.<span class="fu">todos</span> = <span class="kw">new</span> <span class="ot">Todos</span>.<span class="ot">Collections</span>.<span class="fu">TodosCollection</span>();
    <span class="kw">new</span> <span class="ot">BackboneSync</span>.<span class="fu">FayeSubscriber</span>(<span class="kw">this</span>.<span class="fu">todos</span>, { <span class="dt">channel</span>: <span class="st">'todos'</span> });
    <span class="kw">this</span>.<span class="ot">todos</span>.<span class="fu">reset</span>(<span class="ot">options</span>.<span class="fu">todos</span>);
  },

  <span class="co">// ...</span>
});</code></pre>
<p>Now run the app, and watch browsers receive push updates!</p>
</section>
<section id="testing-synchronization" class="level3">
<h3><a href="#testing-synchronization">Testing synchronization</a></h3>
<p>Of course, this introduces a great deal of complexity into your app. There's a new daemon running on the server (Faye), and every client now has to correctly listen to its messages and re-render the appropriate views to show the new data. This gets even more complex when the resource being updated is currently being edited by another user. Your own requirements will dictate the correct behavior in cases like that, but what's most important is that you are able to reproduce such workflows in automated tests.</p>
<p>While this book includes a chapter dedicated to testing Backbone applications, this next section describes the tools and approach that will allow you to verify this behavior in tests.</p>
<p>Following an outside-in development approach, we start with an acceptance test and dive into the isolated testing examples when the acceptance tests drive us to them. There's nothing novel in regards to isolation testing of these components, so we will not touch on them here. Instead, we'll describe how to write an acceptance test for the above scenario.</p>
<p>The required pieces for the approach are:</p>
<ul>
<li>Ensure a faye server running on your testing environment</li>
<li>Fire up a browser session using an browser acceptance testing framework</li>
<li>Sign in as Alice</li>
<li>Start a second browser session and sign in as Olivia</li>
<li>Edit some data on Alice's session</li>
<li>See the edited data reflected on Olivia's session</li>
</ul>
<p>We will be using Cucumber with Capybara and RSpec for this example.</p>
<p>To ensure the Faye server is running, we merely try to make a connection to it when Cucumber boots, failing early if we can't connect. Here's a small snippet that you can drop in <code>features/support/faye.rb</code> to do just that:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="kw">begin</span>
  <span class="dt">Timeout</span>.timeout(<span class="dv">1</span>) <span class="kw">do</span>
    uri = <span class="dt">URI</span>.parse(<span class="dt">BackboneSync</span>::<span class="dt">Rails</span>::<span class="dt">Faye</span>.root_address)
    <span class="dt">TCPSocket</span>.new(uri.host, uri.port).close
  <span class="kw">end</span>
<span class="kw">rescue</span> <span class="dt">Errno</span>::<span class="dt">ECONNREFUSED</span>, <span class="dt">Errno</span>::<span class="dt">EHOSTUNREACH</span>, <span class="dt">Timeout</span>::<span class="dt">Error</span>
  raise <span class="st">&quot;Could not connect to Faye&quot;</span>
<span class="kw">end</span></code></pre>
<p>With that in place, we are now sure that Faye is running and we can move on to our Cucumber scenario. Create a <code>features/sync_task.feature</code> file and let's describe the desired functionality:</p>
<pre class="cucumber"><code>  @javascript
  Scenario: Viewing a task edited by another user
    Given the following users exist:
      | email               |
      | alice@example.com   |
      | olivia@example.com  |
    Given the following task exists:
      | title             |
      | Get Cheeseburgers |
    And I am using session &quot;Alice&quot;
    And I sign in as &quot;alice@example.com&quot;
    Then I should see &quot;Get Cheeseburgers&quot;
    When I switch to session &quot;Olivia&quot;
    And I sign in as &quot;olivia@example.com&quot;
    And I edit the &quot;Get Cheeseburgers&quot; task and rename it to &quot;Buy Cheeseburgers&quot;
    And I switch to session &quot;Alice&quot;
    Then I should see &quot;Buy Cheeseburgers&quot;</code></pre>
<p>Thankfully, Capybara allows us to run acceptance tests with client-side behavior by specifying different drivers to run scenarios that require JavaScript vs. those which don't. The very first line above, <code>@javascript</code>, tells Capybara to use a JavaScript-enabled driver such as Selenium or capybara-webkit.</p>
<p>The following two steps that create some fixture data are provided by <a href="https://github.com/thougthbot/factory_girl">FactoryGirl</a>, which looks into your factory definitions and builds step definitions based on their attributes and associations.</p>
<p>But then we get into the meat of the problem: switching sessions. Capybara introduced the ability to name and switch sessions in your scenarios via the <code>session_name</code> method. The definition for the <code>I am using session &quot;Alice&quot;</code> step looks like this:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="dt">When</span> <span class="ot">/^I (?:am using|switch to) session &quot;([^&quot;]+)&quot;$/</span> <span class="kw">do</span> |new_session_name|
  <span class="dt">Capybara</span>.session_name = new_session_name
<span class="kw">end</span></code></pre>
<p>This allows us to essentially open up different browsers, if you're using the Selenium driver, and it is the key to exercising background syncing code in Capybara acceptance testing.</p>
<p>With this in place, the rest is quite straightforward - we simply interact with the application as you would with any Cucumber scenario; visiting pages, filling in forms, and verifying results on the page, all the while specifying which session you're interacting with.</p>
<p>Additionally, the <code>BackboneSync.FayeSubscriber</code> JavaScript class should also be tested in isolation. We've used Jasmine for testing JavaScript behavior successfully, so it is the approach we recommend. For more information about using Jasmine, refer to the &quot;Testing&quot; chapter.</p>
</section>
<section id="further-reading" class="level3">
<h3><a href="#further-reading">Further reading</a></h3>
<p>For a solid, readable background on idempotent messages, check out <a href="http://devhawk.net/2007/11/09/the-importance-of-idempotence/"><em>The Importance of Idempotence</em></a>.</p>
</section>
</section>
<section id="uploading-attachments" class="level2">
<h2><a href="#uploading-attachments">Uploading attachments</a></h2>
<p>While Ruby gems like paperclip make the API for attaching files to models very similar to the standard ActiveModel attribute persistence API, attaching files to Backbone models is not quite as straightforward. In this section, we'll take a look at the general approach for attaching files, and then examine the specific implementation used in the example application.</p>
<section id="saving-files-along-with-attributes" class="level3">
<h3><a href="#saving-files-along-with-attributes">Saving files along with attributes</a></h3>
<p>When you save a Backbone model, its attributes are sent to the server via Backbone.sync. It would be ideal to treat file uploads in the same fashion, storing the files as attributes on the client-side Backbone model and uploading them, along with all the other attributes, when then model is saved.</p>
<p><code>Backbone.Model#save</code> delegates to <code>Backbone.sync</code> which, by default, transmits data using <code>$.ajax</code> with a <code>dataType</code> of <code>json</code>.</p>
<p>We <em>could</em> send files along here, too, using the HTML5 File API to read the file data and send it serialized inside the JSON payload. But this would require us to make server-side changes to parse the file from JSON, and there is no IE support for the File API as of IE9. <a href="http://caniuse.com/fileapi">http://caniuse.com/fileapi</a></p>
<p>A slightly more sophisticated approach would be to use the FormData API and XMLHttpRequest Level 2 to serialize attributes instead, transmitting them to the server as multipart/form-data, which already has a defined serialization for files. This would allow you to work without modifying your server, but still leaves IE completely unsupported.</p>
<p>To support the broadest set of browsers, but still deliver file uploads in the same request as attributes, you'll use a hidden iframe technique. Probably the most transparent approach is to take advantage of jQuery's <a href="http://api.jquery.com/extending-ajax/#Transports">AJAX Transport</a> functionality with the <a href="http://cmlenz.github.com/jquery-iframe-transport/">jquery.iframe-transport.js</a> plugin. There is a caveat with this approach too, however, as we cannot get at the response headers, breaking automatic content type detection and, more importantly, breaking the use of HTTP response codes to indicate server-side errors. This approach would deliver the smoothest user experience - at the cost of more integration code.</p>
<p>The <a href="https://github.com/leppert/remotipart">Remotipart gem</a> provides some conventions for delivering response information back to the client side, although the use-case is slightly different and the library uses the <code>jquery.form.js</code> <code>ajaxSubmit()</code> function to perform an iframe upload, instead of the smaller <code>jquery.iframe-transport.js</code> plugin.</p>
</section>
<section id="separating-file-upload-and-model-persistence" class="level3">
<h3><a href="#separating-file-upload-and-model-persistence">Separating file upload and model persistence</a></h3>
<p>The general approach we'll take here is to separate the file upload request from the model persistence requests. The server will respond to the upload with an identifier, which we can use on the client side to populate an attribute on a Backbone model, whether it is a new model or an existing one.</p>
<p>This does mean that you can have unclaimed attachments if the end user leaves the page before saving the parent model, and these should be periodically swept if disk usage is an issue.</p>
<p>When modeling this from the Rails side, you can choose to persist the file upload identifier (e.g., the local path or S3 URL) on one of your models directly, or you can break the attachment out into its own ActiveRecord model and store a foreign key relation on your primary model. For our example we'll do the latter, adding an <code>Attachment</code> model and resource to the app.</p>
<p>We'll use the HTML5 File API because it's a straightforward approach to illustrate.</p>
</section>
<section id="example-step-1-upload-interface" class="level3">
<h3><a href="#example-step-1-upload-interface">Example, Step 1: Upload interface</a></h3>
<p>In our example task management app, we'd like the owner of a task to attach several images to each task. We want uploads to happen in the task detail view, and to appear in-page as soon as they are uploaded. We don't need to display uploads on the index view.</p>
<p>First, let's write an acceptance test to drive the functionality:</p>
<pre><code># features/users/attach_file_to_task.feature
@javascript
Feature: Attach a file to a task

  As a user
  I want to attach files to a task
  So that I can include reference materials

  Background:
    Given I am signed up as &quot;email@example.com&quot;
    When I sign in as &quot;email@example.com&quot;
    And I go to the tasks page
    And I create a task &quot;Buy&quot;
    And I create a task &quot;Eat&quot;

  Scenario: Attach a file to a task
    When I attach &quot;spec/fixtures/blueberries.jpg&quot; to the &quot;Buy&quot; task
    Then I should see &quot;blueberries.jpg&quot; attached to the &quot;Buy&quot; task
    And I should see no attachments on the &quot;Eat&quot; task

  Scenario: Attach multiple files to a task
    When I attach &quot;spec/fixtures/blueberries.jpg&quot; to the &quot;Buy&quot; task
    And I attach &quot;spec/fixtures/strawberries.jpg&quot; to the &quot;Buy&quot; task
    Then I should see &quot;blueberries.jpg&quot; attached to the &quot;Buy&quot; task
    And I should see &quot;strawberries.jpg&quot; attached to the &quot;Buy&quot; task</code></pre>
<p>The first failures we get are from the lack of upload UI. We'll drop down to unit tests to drive this out:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"># spec/javascripts/views/<span class="ot">task_show_spec</span>.<span class="fu">js</span>
<span class="co">//= require application</span>

<span class="fu">describe</span>(<span class="st">&quot;ExampleApp.Views.TaskShow&quot;</span>, <span class="kw">function</span>() {
  <span class="kw">var</span> task, view, $el;

  <span class="fu">beforeEach</span>(<span class="kw">function</span>() {
    task = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Models</span>.<span class="fu">Task</span>({
      <span class="dt">id</span>: <span class="dv">1</span>,
      <span class="dt">title</span>: <span class="st">&quot;Wake up&quot;</span>
    });

    view = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Views</span>.<span class="fu">TaskShow</span>({ <span class="dt">model</span>: task });
    $el = <span class="fu">$</span>(<span class="ot">view</span>.<span class="fu">render</span>().<span class="fu">el</span>);
  });

  <span class="fu">it</span>(<span class="st">&quot;renders the detail view for a task&quot;</span>, <span class="kw">function</span>() {
    <span class="fu">expect</span>($el).<span class="fu">toHaveText</span>(<span class="ot">/Wake up/</span>);
  });

  <span class="fu">it</span>(<span class="st">&quot;renders a file upload area&quot;</span>, <span class="kw">function</span>() {
    <span class="fu">expect</span>($el).<span class="fu">toContain</span>(<span class="st">&quot;.upload label:contains('Attach a file to upload')&quot;</span>);
    <span class="fu">expect</span>($el).<span class="fu">toContain</span>(<span class="st">&quot;.upload button:contains('Upload attachment')&quot;</span>);
    <span class="fu">expect</span>($el).<span class="fu">toContain</span>(<span class="st">&quot;.upload input[type=file]&quot;</span>);
  });

  <span class="fu">it</span>(<span class="st">&quot;links the upload label and input&quot;</span>, <span class="kw">function</span>() {
    <span class="kw">var</span> $label = <span class="ot">$el</span>.<span class="fu">find</span>(<span class="st">'.upload label'</span>);
    <span class="kw">var</span> $input = <span class="ot">$el</span>.<span class="fu">find</span>(<span class="st">'.upload input'</span>);
    <span class="fu">expect</span>(<span class="ot">$label</span>.<span class="fu">attr</span>(<span class="st">'for'</span>)).<span class="fu">toEqual</span>(<span class="ot">$input</span>.<span class="fu">attr</span>(<span class="st">'id'</span>));
  });
});</code></pre>
<p>Then, we'll add the upload form in the <code>tasks/show.jst.ejs</code> template, so the UI elements are in place:</p>
<pre><code># app/assets/templates/tasks/show.jst.ejs
&lt;p&gt;Task title&lt;/p&gt;

&lt;ul class=&quot;attachments&quot;&gt;
&lt;/ul&gt;

&lt;div class=&quot;upload&quot;&gt;
  &lt;label for=&quot;input&quot;&gt;Attach a file to upload&lt;/label&gt;
  &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt;
  &lt;button&gt;Upload attachment&lt;/button&gt;
&lt;/div&gt;

&lt;a href=&quot;#&quot;&gt;Back to task list&lt;/a&gt;</code></pre>
<p>Once our units pass, we run the acceptance tests again. The next failure we see is that nothing happens upon upload. We'll drop down to Jasmine here to write a spec for uploading that asserts the correct upload request is issued:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// spec/javascripts/views/task_show_uploading_spec.js</span>

<span class="fu">it</span>(<span class="st">&quot;uploads the file when the upload method is called&quot;</span>, <span class="kw">function</span>() {
  <span class="ot">view</span>.<span class="fu">upload</span>();
  <span class="fu">expect</span>(<span class="kw">this</span>.<span class="ot">requests</span>.<span class="fu">length</span>).<span class="fu">toEqual</span>(<span class="dv">1</span>);
  <span class="fu">expect</span>(<span class="kw">this</span>.<span class="fu">requests</span>[<span class="dv">0</span>].<span class="ot">requestBody</span>.<span class="fu">constructor</span>).<span class="fu">toEqual</span>(FormData);
});

<span class="fu">it</span>(<span class="st">&quot;uploads an attachment for the current task&quot;</span>, <span class="kw">function</span>() {
  <span class="ot">view</span>.<span class="fu">upload</span>();
  <span class="fu">expect</span>(<span class="kw">this</span>.<span class="fu">requests</span>[<span class="dv">0</span>].<span class="fu">url</span>).<span class="fu">toEqual</span>(<span class="st">&quot;/tasks/1/attachments.json&quot;</span>);
});</code></pre>
<p>and implement using the <code>uploader.js</code> library:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/task_show.js</span>

render: <span class="kw">function</span> () {
  <span class="co">// ...</span>
  <span class="kw">this</span>.<span class="fu">attachUploader</span>();
  <span class="kw">return</span> <span class="kw">this</span>;
},

<span class="co">// ...</span>

attachUploader: <span class="kw">function</span>() {
  <span class="kw">var</span> uploadUrl = <span class="st">&quot;/tasks/&quot;</span> + <span class="kw">this</span>.<span class="ot">model</span>.<span class="fu">get</span>(<span class="st">'id'</span>) + <span class="st">'/attachments.json'</span>;

  <span class="kw">this</span>.<span class="fu">uploader</span> = <span class="kw">new</span> <span class="fu">uploader</span>(<span class="kw">this</span>.<span class="fu">uploadInput</span>(), {
    <span class="dt">url</span>:      uploadUrl,
    <span class="dt">success</span>:  <span class="kw">this</span>.<span class="fu">uploadSuccess</span>,
    <span class="dt">prefix</span>:   <span class="st">'upload'</span>
  });
},</code></pre>
<p>The acceptance tests still aren't passing, and a little digging will reveal that we need to manually set the CSRF token on the upload request. Normally, this would be set by <code>jquery_ujs.js</code> with a jQuery AJAX prefilter, but the upload code we are using manually constructs an <code>XMLHttpRequest</code> instead of using <code>$.ajax</code>, so that it may bind to the <code>onprogress</code> event.</p>
<p>We write a spec:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// spec/javascripts/views/task_show_uploading_spec.js</span>
<span class="fu">it</span>(<span class="st">&quot;sets the CSRF token for the upload request&quot;</span>, <span class="kw">function</span>() {
  <span class="ot">view</span>.<span class="fu">upload</span>();
  <span class="kw">var</span> expectedCsrfToken = <span class="fu">$</span>(<span class="st">'meta[name=&quot;csrf-token&quot;]'</span>).<span class="fu">attr</span>(<span class="st">'content'</span>);
  <span class="fu">expect</span>(<span class="kw">this</span>.<span class="fu">requests</span>[<span class="dv">0</span>].<span class="fu">requestHeaders</span>[<span class="st">'X-CSRF-Token'</span>]).<span class="fu">toEqual</span>(expectedCsrfToken);
});</code></pre>
<p>And add the CSRF token implementation at the end of <code>attachUploader</code>:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/task_show.js</span>
attachUploader: <span class="kw">function</span>() {
  <span class="co">// ...</span>

  <span class="kw">this</span>.<span class="ot">uploader</span>.<span class="fu">prefilter</span> = <span class="kw">function</span>() {
    <span class="kw">var</span> token = <span class="fu">$</span>(<span class="st">'meta[name=&quot;csrf-token&quot;]'</span>).<span class="fu">attr</span>(<span class="st">'content'</span>);
    <span class="kw">if</span> (token) <span class="kw">this</span>.<span class="ot">xhr</span>.<span class="fu">setRequestHeader</span>(<span class="st">'X-CSRF-Token'</span>, token);
  };
},</code></pre>
<p>And the spec is green.</p>
</section>
<section id="example-step-2-accept-and-persist-uploads-in-rails" class="level3">
<h3><a href="#example-step-2-accept-and-persist-uploads-in-rails">Example, Step 2: Accept and persist uploads in Rails</a></h3>
<p>At this point, we are sending the upload request from the client, but the server isn't responding, much less persisting the file. This portion is vanilla Rails and Paperclip. We create an <code>Attachment</code> model, a nested <code>:attachments</code> route under the <code>tasks</code> resource, and <code>AttachmentsController</code>. Then, we add the <a href="http://rubygems.org/gems/paperclip">paperclip gem</a> to the Gemfile, and include the <code>has_attached_file</code> directive in the <code>Attachment</code> model along with the corresponding <code>have_attached_file</code> example to the <code>Attachment</code> model spec.</p>
<p>Now that attachments are uploaded to the server, the final step is to display attachments to the user.</p>
</section>
<section id="example-step-3-display-uploaded-files" class="level3">
<h3><a href="#example-step-3-display-uploaded-files">Example, Step 3: Display Uploaded Files</a></h3>
<p>For structuring the attachments in Backbone, we want to be able to do something like the following:</p>
<pre class="sourceCode rhtml"><code class="sourceCode rhtml"><span class="co">&lt;!-- app/assets/templates/tasks/show.jst.ejs --&gt;</span>
<span class="kw">&lt;%</span> this.task.attachments.each(function(attachment) <span class="ch">{</span> <span class="kw">%&gt;</span>
  Attached: <span class="kw">&lt;img</span><span class="ot"> src=</span><span class="st">&quot;</span><span class="kw">&lt;%=</span> attachment.get(<span class="st">'upload_url'</span>)<span class="st">&quot; /&gt; %&gt;</span>
<span class="st">&lt;% }); %&gt;</span></code></pre>
<p>So, the task model will have an attachments property that instantiates with an <code>AttachmentsCollection</code> instance.</p>
<p>We're providing a JSON representation rooted at the task model using <a href="https://github.com/nesquena/rabl">Rabl</a>, which we discussed previously in &quot;Implementing the API: presenting the JSON.&quot;</p>
<pre><code># app/views/tasks/show.json.rabl
object @task

attributes :id, :created_at, :updated_id, :title, :complete, :user_id

child :attachments do
  attributes :id, :created_at, :updated_id, :upload_file_name, :upload_url
end</code></pre>
<p>We also tell Rabl to suppress the root JSON node, much like we did with <code>ActiveRecord::Base.include_root_in_json</code>:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="co"># config/initializers/rabl_init.rb</span>
<span class="dt">Rabl</span>.configure <span class="kw">do</span> |config|
  config.include_json_root = <span class="dv">false</span>
<span class="kw">end</span></code></pre>
<p>We can test drive the attachment display from Jasmine; see <code>task_show_with_attachments_spec.js</code>:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"># spec/javascripts/views/<span class="ot">task_show_with_attachments_spec</span>.<span class="fu">js</span>
<span class="co">//= require application</span>

<span class="fu">describe</span>(<span class="st">&quot;ExampleApp.Views.TaskShow for a task with attachments&quot;</span>, <span class="kw">function</span>() {
  <span class="kw">var</span> task, view, $el, blueberryUrl, strawberryUrl;

  <span class="fu">beforeEach</span>(<span class="kw">function</span>() {
    blueberryUrl = <span class="st">&quot;http://whatscookingamerica.net/Fruit/Blueberries4.jpg&quot;</span>;
    strawberryUrl = <span class="st">&quot;http://strawberriesweb.com/three-strawberries.jpg&quot;</span>
    task = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Models</span>.<span class="fu">Task</span>({
      <span class="dt">id</span>: <span class="dv">1</span>,
      <span class="dt">title</span>: <span class="st">&quot;Buy pies&quot;</span>,
      <span class="dt">attachments</span>: [
        {
          <span class="dt">upload_file_name</span>: <span class="st">&quot;blueberries.jpg&quot;</span>,
          <span class="dt">upload_url</span>: blueberryUrl
        },
        {
          <span class="dt">upload_file_name</span>: <span class="st">&quot;strawberries.jpg&quot;</span>,
          <span class="dt">upload_url</span>: strawberryUrl
        }
      ]
    });

    view = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Views</span>.<span class="fu">TaskShow</span>({ <span class="dt">model</span>: task });
    $el = <span class="fu">$</span>(<span class="ot">view</span>.<span class="fu">render</span>().<span class="fu">el</span>);
  });

  <span class="fu">it</span>(<span class="st">&quot;displays attachments&quot;</span>, <span class="kw">function</span>() {
    <span class="fu">expect</span>($el).<span class="fu">toContain</span>(<span class="st">&quot;.attachments img[src='&quot;</span> + blueberryUrl + <span class="st">&quot;']&quot;</span>)
    <span class="fu">expect</span>($el).<span class="fu">toContain</span>(<span class="st">&quot;.attachments img[src='&quot;</span> + strawberryUrl + <span class="st">&quot;']&quot;</span>)
  });

  <span class="fu">it</span>(<span class="st">&quot;displays attachment filenames&quot;</span>, <span class="kw">function</span>() {
    <span class="kw">var</span> attachments = <span class="ot">$el</span>.<span class="fu">find</span>(<span class="st">&quot;.attachments p&quot;</span>);
    <span class="fu">expect</span>(<span class="ot">attachments</span>.<span class="fu">first</span>()).<span class="fu">toHaveText</span>(<span class="st">'Attached: blueberries.jpg'</span>);
    <span class="fu">expect</span>(<span class="ot">attachments</span>.<span class="fu">last</span>()).<span class="fu">toHaveText</span>(<span class="st">'Attached: strawberries.jpg'</span>);
  });
});</code></pre>
<p>We'll represent attachments as an associated collection on <code>Task</code>, so we'll need a Backbone model and collection for attachments, too. First, the task model should parse its JSON to populate the associated attachments. Test drive that in the <code>ExampleApp.Models.Tasks</code> Jasmine spec:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"># spec/javascripts/models/<span class="ot">task_spec</span>.<span class="fu">js</span>
<span class="co">//= require application</span>

<span class="fu">describe</span>(<span class="st">&quot;ExampleApp.Models.Tasks&quot;</span>, <span class="kw">function</span>() {
  <span class="fu">it</span>(<span class="st">&quot;knows if it is complete&quot;</span>, <span class="kw">function</span>() {
    <span class="kw">var</span> completeTask = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Models</span>.<span class="fu">Task</span>({ <span class="dt">complete</span>: <span class="kw">true</span> });
    <span class="fu">expect</span>(<span class="ot">completeTask</span>.<span class="fu">isComplete</span>()).<span class="fu">toBe</span>(<span class="kw">true</span>);
  });

  <span class="fu">it</span>(<span class="st">&quot;knows if it is not complete&quot;</span>, <span class="kw">function</span>() {
    <span class="kw">var</span> incompleteTask = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Models</span>.<span class="fu">Task</span>({ <span class="dt">complete</span>: <span class="kw">false</span> });
    <span class="fu">expect</span>(<span class="ot">incompleteTask</span>.<span class="fu">isComplete</span>()).<span class="fu">toBe</span>(<span class="kw">false</span>);
  });
});

<span class="fu">describe</span>(<span class="st">&quot;ExampleApp.Models.Tasks#initialize&quot;</span>, <span class="kw">function</span>() {
  <span class="kw">var</span> attributes, task;

  <span class="fu">beforeEach</span>(<span class="kw">function</span>() {
    attributes = {<span class="st">&quot;id&quot;</span>:<span class="dv">1</span>,
                  <span class="st">&quot;title&quot;</span>:<span class="st">&quot;Sweet Task&quot;</span>,
                  <span class="st">&quot;attachments&quot;</span>:[
                    {<span class="st">&quot;upload_url&quot;</span>:<span class="st">&quot;/uploads/1.jpg&quot;</span>},
                    {<span class="st">&quot;upload_url&quot;</span>:<span class="st">&quot;/uploads/2.jpg&quot;</span>}
                  ]};
    task = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Models</span>.<span class="fu">Task</span>(attributes);
  });

  <span class="fu">it</span>(<span class="st">&quot;creates collections for nested attachments&quot;</span>, <span class="kw">function</span>() {
    <span class="kw">var</span> attachments = <span class="ot">task</span>.<span class="fu">attachments</span>;
    <span class="kw">var</span> typeCheck = attachments <span class="kw">instanceof</span> <span class="ot">ExampleApp</span>.<span class="ot">Collections</span>.<span class="fu">Attachments</span>;
    <span class="fu">expect</span>(typeCheck).<span class="fu">toEqual</span>(<span class="kw">true</span>);
    <span class="fu">expect</span>(<span class="ot">attachments</span>.<span class="fu">size</span>()).<span class="fu">toEqual</span>(<span class="dv">2</span>);
  });

  <span class="fu">it</span>(<span class="st">&quot;populates the collection with Attachment models&quot;</span>, <span class="kw">function</span>() {
    <span class="kw">var</span> attachments = <span class="ot">task</span>.<span class="fu">attachments</span>;
    <span class="kw">var</span> typeCheck = <span class="ot">attachments</span>.<span class="fu">first</span>() <span class="kw">instanceof</span> <span class="ot">ExampleApp</span>.<span class="ot">Models</span>.<span class="fu">Attachment</span>;
    <span class="fu">expect</span>(typeCheck).<span class="fu">toEqual</span>(<span class="kw">true</span>);
    <span class="fu">expect</span>(<span class="ot">attachments</span>.<span class="fu">first</span>().<span class="fu">get</span>(<span class="st">'upload_url'</span>)).<span class="fu">toEqual</span>(<span class="st">'/uploads/1.jpg'</span>);

    typeCheck = <span class="ot">attachments</span>.<span class="fu">last</span>() <span class="kw">instanceof</span> <span class="ot">ExampleApp</span>.<span class="ot">Models</span>.<span class="fu">Attachment</span>;
    <span class="fu">expect</span>(typeCheck).<span class="fu">toEqual</span>(<span class="kw">true</span>);
    <span class="fu">expect</span>(<span class="ot">attachments</span>.<span class="fu">last</span>().<span class="fu">get</span>(<span class="st">'upload_url'</span>)).<span class="fu">toEqual</span>(<span class="st">'/uploads/2.jpg'</span>);
  });
});

<span class="fu">describe</span>(<span class="st">&quot;ExampleApp.Models.Task attachments:change&quot;</span>, <span class="kw">function</span>() {
  <span class="fu">it</span>(<span class="st">&quot;re-parses the collection&quot;</span>, <span class="kw">function</span>() {
    <span class="kw">var</span> task = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Models</span>.<span class="fu">Task</span>({<span class="st">&quot;attachments&quot;</span>:[
                                            {<span class="st">&quot;upload_url&quot;</span>:<span class="st">&quot;1.jpg&quot;</span>},
                                            {<span class="st">&quot;upload_url&quot;</span>:<span class="st">&quot;2.jpg&quot;</span>}]});
    <span class="fu">expect</span>(<span class="ot">task</span>.<span class="ot">attachments</span>.<span class="fu">size</span>()).<span class="fu">toEqual</span>(<span class="dv">2</span>);

    <span class="ot">task</span>.<span class="fu">set</span>({<span class="st">&quot;attachments&quot;</span>:[{<span class="st">&quot;upload_url&quot;</span>:<span class="st">&quot;1.jpg&quot;</span>}]});
    <span class="fu">expect</span>(<span class="ot">task</span>.<span class="ot">attachments</span>.<span class="fu">size</span>()).<span class="fu">toEqual</span>(<span class="dv">1</span>);
  });
});</code></pre>
<p>The first failures reference the Backbone attachment model and attachments collection, so we add those, driving the collection out with a spec.</p>
<p>Next, we can implement the task model's JSON parsing to populate its associated attachments:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/models/task.js</span>
<span class="ot">ExampleApp</span>.<span class="ot">Models</span>.<span class="fu">Task</span> = <span class="ot">Backbone</span>.<span class="ot">Model</span>.<span class="fu">extend</span>({
  <span class="dt">initialize</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="fu">bind</span>(<span class="st">&quot;change:attachments&quot;</span>, <span class="kw">this</span>.<span class="fu">parseAttachments</span>);
    <span class="kw">this</span>.<span class="fu">parseAttachments</span>();
  },

  <span class="dt">parseAttachments</span>: <span class="kw">function</span>() {
    <span class="kw">var</span> attachmentsAttr = <span class="kw">this</span>.<span class="fu">get</span>(<span class="st">'attachments'</span>);
    <span class="kw">this</span>.<span class="fu">attachments</span> = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Collections</span>.<span class="fu">Attachments</span>(attachmentsAttr);
  },

  <span class="co">// ...</span>

});</code></pre>
<p>At this point, we return back to the acceptance test, and it's fully passing.</p>
<p></p>
</section>
</section>
</section>
<section id="testing" class="level1">
<h1><a href="#testing">Testing</a></h1>
<section id="full-stack-integration-testing" class="level2">
<h2><a href="#full-stack-integration-testing">Full-stack integration testing</a></h2>
<p>Your application is built from a collection of loosely coupled modules, spreading across several layers of the development stack. To ensure the application works correctly from the perspective of the end user, full-stack integration testing drives your application and verifies correct functionality from the user interface level. This is also referred to as &quot;acceptance testing.&quot;</p>
<section id="introduction-1" class="level3">
<h3><a href="#introduction-1">Introduction</a></h3>
<p>Writing a full-stack integration test for a JavaScript-driven web application will always involve some kind of browser, and although writing an application with Backbone can make a world of difference to you, the tools involved are all the same as far as your browser is concerned. Because your browser can run Backbone applications just like any JavaScript application, you can write integration tests for them just like you would for any JavaScript application. Also, because of tools like Capybara that support various drivers, you can generally test a JavaScript-based application just like you'd test a web application where all the logic lives on the server. This means that having a powerful, rich-client user interface won't make your application any harder to test. If you're familiar with tools like Capybara, Cucumber, and RSpec, you can dive right in and start testing your Backbone application. If not, the following sections should give you a taste of the available tools for full-stack integration tests written in Ruby.</p>
</section>
<section id="capybara" class="level3">
<h3><a href="#capybara">Capybara</a></h3>
<p>Though there is a host of tools available to you for writing automated integration tests, we recommend <a href="https://github.com/jnicklas/capybara">Capybara</a>. In a hybrid Rails application, where some portions are regular request/response and other portions are JavaScript, it's valuable to have a testing framework that abstracts the difference as much as possible.</p>
<p>Capybara is a high-level library that allows you to write tests from a user's perspective. Consider this example, which uses RSpec:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="co"># spec/requests/login_spec.rb</span>
describe <span class="st">&quot;the login process&quot;</span>, <span class="st">:type</span> =&gt; <span class="st">:request</span> <span class="kw">do</span>
  it <span class="st">&quot;accepts an email and password&quot;</span> <span class="kw">do</span>
    <span class="dt">User</span>.create(<span class="st">:email</span> =&gt; <span class="st">'alice@example.com'</span>, <span class="st">:password</span> =&gt; <span class="st">'password'</span>)
    visit <span class="st">'/'</span>
    fill_in <span class="st">'Email'</span>, <span class="st">:with</span> =&gt; <span class="st">'alice@example.com'</span>
    fill_in <span class="st">'Password'</span>, <span class="st">:with</span> =&gt; <span class="st">'password'</span>
    click_button <span class="st">'Log in'</span>
    page.should have_content(<span class="st">'You are logged in as alice@example.com'</span>)
  <span class="kw">end</span>
<span class="kw">end</span></code></pre>
<p>Notice that, as you read the spec, you're not concerned about whether the login interface is rendered with JavaScript, or whether the authentication request is over AJAX or not. A high-level library like Capybara keeps you from having to consider the back-end implementation, freeing you to focus on describing the application's behavior from an end-user's perspective. This perspective of writing specs is often called &quot;behavior-driven development&quot; (BDD).</p>
</section>
<section id="cucumber" class="level3">
<h3><a href="#cucumber">Cucumber</a></h3>
<p>You can take another step toward natural language tests, using Cucumber to define mappings. Cucumber is a test runner and a mapping layer. The specs you write in Cucumber are user stories, written in a constrained subset of English. The individual steps in these stories are mapped to a testing library - in our case, and probably most cases, to Capybara.</p>
<p>This additional layer of abstraction can be helpful for a few reasons. Some teams have nontechnical stakeholders writing integration specs as user stories. Cucumber sits at a level of abstraction that fits comfortably there: high-level enough for nontechnical stakeholders to write in, but precise enough to be translated into automated tests.</p>
<p>On other teams, the person writing the story is the same person who implements it. Still, it is valuable to use a tool that reinforces the distinction between the description phase and the implementation phase of the test. In the description phase, you are writing an English description of the software interaction:</p>
<pre class="cucumber"><code># features/login.feature
Given there is a user account &quot;alice@example.com&quot; with the password &quot;password&quot;
When I go to the home page
And I fill in the login form with &quot;alice@example.com&quot; and &quot;password&quot;
And I click the login button
Then I should see &quot;You are logged in as alice@example.com&quot;</code></pre>
<p>In the implementation phase of the test, you define what these steps do. In this case, they are defined to run Capybara methods:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="co"># features/step_definitions/login_steps.rb</span>
<span class="dt">Given</span> <span class="ot">/^there is a user account &quot;(.*)&quot; with the password &quot;(.*)&quot;$/</span> <span class="kw">do</span> \\
|email, password|
  <span class="dt">User</span>.create(<span class="st">:email</span> =&gt; email, <span class="st">:password</span> =&gt; password)
<span class="kw">end</span>

<span class="dt">When</span> <span class="st">&quot;I go to the home page&quot;</span> <span class="kw">do</span>
  visit <span class="st">&quot;/&quot;</span>
<span class="kw">end</span>

<span class="dt">When</span> <span class="ot">/^I fill in the login form with &quot;(.*)&quot; and &quot;(.*)&quot;$/</span> <span class="kw">do</span> |email, password|
  fill_in <span class="st">'Email'</span>, <span class="st">:with</span> =&gt; email
  fill_in <span class="st">'Password'</span>, <span class="st">:with</span> =&gt; password
<span class="kw">end</span>

<span class="dt">When</span> <span class="st">&quot;I click the login button&quot;</span> <span class="kw">do</span>
  click_button <span class="st">&quot;Login&quot;</span>
<span class="kw">end</span>

<span class="dt">Then</span> <span class="ot">/^I should see &quot;(.*)&quot;$/</span> <span class="kw">do</span> |text|
  page.should have_content(text)
<span class="kw">end</span></code></pre>
</section>
<section id="drivers" class="level3">
<h3><a href="#drivers">Drivers</a></h3>
<p>Capybara supports multiple drivers through a common API, each with benefits and drawbacks. We prefer to use either <a href="https://github.com/thoughtbot/capybara-webkit">capybara-webkit</a> or Selenium.</p>
<p>When possible, we use capybara-webkit. It's a fast, headless fake browser written using the WebKit browser engine. It's generally faster than Selenium and it's dependent on your system settings once compiled. This means that upgrading the browser you use every day won't ever affect your tests.</p>
<p>However, capybara-webkit is still young, and sometimes there's no substitute for having a real browser to run your tests through. In these situations, we fall back to using Selenium. Selenium will always support anything you can do in your actual browser, and supports multiple browsers, including Firefox, Chrome, Safari, and even Internet Explorer.</p>
<p>Capybara makes it easy to switch between drivers. Just set your default driver to capybara-webkit:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="co"># features/support/javascript_driver.rb or spec/spec_helper.rb</span>
<span class="dt">Capybara</span>.javascript_driver = <span class="st">:webkit</span></code></pre>
<p>Then, tag a Cucumber scenario as @javascript. If you need to fall back to using Selenium, tag that scenario with @selenium.</p>
</section>
</section>
<section id="isolated-unit-testing" class="level2">
<h2><a href="#isolated-unit-testing">Isolated unit testing</a></h2>
<p>Integration testing your application is great for ensuring that the product functions as intended, and works to mitigate against risk of regressions. There are additional benefits, though, to writing tests for individual units of your application in isolation, such as focused failures and decoupled code.</p>
<p>When an integration test fails, it can be difficult to pin down the exact reason why; particularly when a regression is introduced in a part of the application seemingly far away from where you're working. With the finer granularity of a unit test suite, failures are more targeted and help you get to the root of the problem more quickly.</p>
<p>Another benefit comes from unit testing when you test-drive code; i.e., when you write the tests before the implementation. Since you are starting with a piece of code which is client to your implementation modules, setup and dependency concerns are brought to your attention at the beginning of implementation, rather than much later during development when modules are integrated. Thinking about these concerns earlier helps you design modules which are more loosely coupled, have smaller interfaces, and are easier to set up. If code is hard to test, it will be hard to use. Writing the test first, you have a clear and concrete opportunity to make your implementation easier to use.</p>
<p>Finally, there are some behaviors that are difficult or impossible to test using a full-stack integration test. Here's a common example: you want to display a spinner graphic or disable a UI element while waiting for the server to respond to a request. You can't test this with an integration test because the time the server takes to respond is variable; by the time your test checks to look for the spinner graphic, the response will probably be finished. Even if it passes once, it may fail on the next run, or on the run after that. And if you decide to do an almost-full-stack test and fake out a slow response on the server, this will slow down your tests and introduce unnecessary indirection to an otherwise simple component. During isolation tests, it's easy to use techniques like dependency injection, stubbing, and mocking to test erratic behaviors and side effects that are difficult to observe during integration tests.</p>
<p>If you'd like to read more on test-driven development, check out Kent Beck's <em>Test Driven Development: By Example</em> and Gerard Meszaros' <em>xUnit Test Patterns: Refactoring Test Code</em>.</p>
<p>As there is plentiful content available for testing tools and strategies in Rails, we'll focus on isolation testing your Backbone code.</p>
<section id="isolation-testing-in-javascript" class="level3">
<h3><a href="#isolation-testing-in-javascript">Isolation testing in JavaScript</a></h3>
<p>There are many JavaScript testing frameworks available. Some run in-browser and provide facility for setting up DOM fixtures. Others are designed for standalone JavaScript code and can run on browserless JavaScript runtimes.</p>
<p>We'll use the Jasmine framework for writing our isolation specs. It integrates easily into a Rails application, and provides an RSpec-like syntax for writing specs:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// spec/javascripts/models/tasks_spec.js</span>
<span class="fu">describe</span>(<span class="st">&quot;ExampleApp.Models.Tasks&quot;</span>, <span class="kw">function</span>() {
  <span class="fu">it</span>(<span class="st">&quot;knows if it is complete&quot;</span>, <span class="kw">function</span>() {
    <span class="kw">var</span> completeTask = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Models</span>.<span class="fu">Task</span>({ <span class="dt">complete</span>: <span class="kw">true</span> });
    <span class="fu">expect</span>(<span class="ot">completeTask</span>.<span class="fu">isComplete</span>()).<span class="fu">toBe</span>(<span class="kw">true</span>);
  });

  <span class="fu">it</span>(<span class="st">&quot;knows if it is not complete&quot;</span>, <span class="kw">function</span>() {
    <span class="kw">var</span> incompleteTask = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Models</span>.<span class="fu">Task</span>({ <span class="dt">complete</span>: <span class="kw">false</span> });
    <span class="fu">expect</span>(<span class="ot">incompleteTask</span>.<span class="fu">isComplete</span>()).<span class="fu">toBe</span>(<span class="kw">false</span>);
  });
});</code></pre>
<p>To run the Jasmine tests in the example application, simply run <code>bundle exec rake jasmine</code> and visit http://localhost:8888.</p>
</section>
<section id="what-to-test" class="level3">
<h3><a href="#what-to-test">What to test?</a></h3>
<p>We frequently found it difficult to test JavaScript components in isolation before we started using Backbone. Although jQuery really takes the pain out of working with the DOM and communicating with the server, it's not object-oriented and provides nothing to help split up your application. Because most of our HTML was in ERB-based templates, it was generally difficult to test the JavaScript that relied on that HTML without also loading the web application. This meant that almost all of our early JavaScript tests were full-stack integration tests.</p>
<p>Using Backbone, it's much easier to test components in isolation. View code is restricted to views, and templates contain only HTML or interpolation code that can be interpreted by the JavaScript view layer, such as jst or Mustache templates. Models and collections can be given data in their constructor, and simple dependency injection allows unit tests to fake out the remote server. We don't test routers in isolation as often because they're very light on logic, but those are also easy to test by calling action methods directly or triggering events.</p>
<p>Since Backbone components are just as easy to test in isolation as they are to test full-stack, we generally use the same guidelines as we do for all Rails applications to decide what to test where.</p>
<p>Start with a top-down, full-stack Cucumber or RSpec scenario to describe the feature you're writing from a high-level perspective, and begin implementing behavior from the top as necessary. If you find that the feedback loop between a test failure and the code to pass it starts to feel too long, start writing isolated unit tests for the individual components you need to write to get closer to passing a higher-level assertion. As an example, an assertion from Capybara that fails because of a missing selector may need new models, controllers, views, and routes both on the server and in Backbone. Rather than writing several new components without seeing the failure message change, write a unit test for each piece as you progress down. If it's clear what component you need to add from the integration test failure, add that component without writing an isolated unit test. For example, a failure from a missing route or view file reveals an obvious next step, but missing text on a page, because a model method doesn't actually do anything, may motivate a unit test.</p>
<p>Many features will have edge cases or several logical branches. Anything that can't be described from a high-level, business value perspective should be tested from an isolated unit test. For example, when testing a form, it makes sense to write a scenario for the success path, where a user enters valid data that gets accepted and rendered by the application, and one extra scenario for the failure path, where a user enters invalid data that the system can't accept. However, when adding future validations or other reasons that a user's data can't be accepted, it makes sense to just write an extra isolated unit test, rather than adding a new scenario that largely duplicates the original failure scenario.</p>
<p>When writing isolation tests, the developer needs to decide exactly how much isolation to enforce. For example, when writing a unit test for a model, you'll likely decide not to involve an actual web server to provide data. However, when testing a view that composes other subviews, you'll likely allow the actual subview code to run. There are many cases when it will make sense to just write a unit test that involves a few components working together, rather than writing a full-stack scenario.</p>
<p>The overall goals when deciding how much to test via integration vs. isolation are to keep high-level business logic described in top-down tests, to keep details and edge cases described in unit tests, and to write tests that exercise the fewest number of components possible while remaining robust and descriptive without becoming brittle.</p>
</section>
<section id="helpful-tools" class="level3">
<h3><a href="#helpful-tools">Helpful Tools</a></h3>
<ul>
<li>Spy/stub/mock, even your HTTP, with <a href="http://sinonjs.org/">Sinon.js</a></li>
<li>If you're looking for factory_girl.js, it's called <a href="https://github.com/bkeepers/rosie">Rosie</a></li>
<li>Use the Rails asset pipeline with the latest edge versions of the Jasmine gem</li>
<li>See other examples on James Newbery's blog: <a href="http://tinnedfruit.com/2011/03/03/testing-backbone-apps-with-jasmine-sinon.html">testing Backbone with Jasmine</a> and check out his <a href="https://github.com/froots/backbone-jasmine-examples">examples on GitHub</a></li>
</ul>
</section>
</section>
<section id="example-test-driving-a-task-application" class="level2">
<h2><a href="#example-test-driving-a-task-application">Example: Test-driving a task application</a></h2>
<section id="setup" class="level3">
<h3><a href="#setup">Setup</a></h3>
<p>In this example, we'll be using Cucumber, Capybara, RSpec, and Jasmine to test-drive a todo list.</p>
<p>The Selenium driver comes configured with Capybara and is the quickest driver to get running. By default, it runs your tests in a remote-controlled Firefox session, so you'll want to install Firefox if you don't have it.</p>
<p>If you'd like to test on a WebKit-based browser, you can set up the <a href="http://code.google.com/p/selenium/wiki/ChromeDriver">Selenium ChromeDriver</a> to run integration tests against Chrome.</p>
<p>The other dependencies you can install by adding them to your Gemfile. The gems you'll need for testing are jasmine (currently tracking the edge version from GitHub), cucumber-rails, rspec-rails, and capybara. You'll want to add RSpec, Cucumber, and Jasmine to both the test and development groups so that you can run generators. With all our testing dependencies in place, the <code>Gemfile</code> in our sample application looks like this:</p>
<p>` Gemfile@f478197</p>
<p>If you haven't already, bootstrap your application for Cucumber and Capybara:</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">rails</span> generate cucumber:install</code></pre>
<p>Next, bootstrap the application for Jasmine:</p>
<pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">rails</span> generate jasmine:install</code></pre>
<p>With this configuration, you can run Cucumber scenarios with the Cucumber command and you can run Jasmine tests by running <code>bundle exec rake jasmine</code> and visiting http://localhost:8888, or by running <code>bundle exec rake jasmine:ci</code>, which uses Selenium to verify the Jasmine results.</p>
<p>One final helpful configuration change is to include the <code>jasmine:ci</code> task in the default rake task. This way, running <code>rake</code> will run all your specs, including Jasmine specs:</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="co"># Rakefile</span>
<span class="co"># ...</span>
task <span class="st">:default</span> =&gt; [<span class="st">'spec'</span>, <span class="st">'jasmine:ci'</span>, <span class="st">'cucumber'</span>]</code></pre>
</section>
<section id="step-by-step" class="level3">
<h3><a href="#step-by-step">Step by step</a></h3>
<p>We'll go outside in: Cucumber first, then RSpec or Jasmine as needed.</p>
<p>TIP: For an in-depth explanation of outside-in test-driven development, see <a href="http://pragprog.com/book/achbd/the-rspec-book"><em>The RSpec Book</em></a>.</p>
<p>We'd like to be able to add items to a todo list. We know this will involve two parts: a list of existing tasks, and an interface for adding new items to the list. We'll start with the list of items, and create fixture data with <a href="https://github.com/thoughtbot/factory_girl/blob/v2.1.0/GETTING_STARTED.md">Factory Girl Cucumber steps</a>:</p>
<pre><code># features/users/view_tasks.feature
Feature: Viewing Tasks
  As a user
  So that I can see what I have to do
  I want to be able to see all my tasks

  @javascript
  Scenario: View tasks
    Given the following tasks exist:
      | Title                                | user                     |
      | Purchase the Backbone on Rails ebook | email: email@example.com |
      | Master Backbone                      | email: email@example.com |
    When I sign in as &quot;email@example.com&quot;
    And I am on the home page
    Then I should see &quot;Master Backbone&quot; within the tasks list
    And I should see &quot;Purchase the Backbone on Rails ebook&quot; within the tasks list</code></pre>
<p>Running this, we see a failure:</p>
<pre class="text"><code>Then I should see &quot;Master Backbone&quot; within the tasks list
  Unable to find css &quot;#tasks table&quot; (Capybara::ElementNotFound)
  (eval):2:in `find'
  ./features/step_definitions/web_steps.rb:29:in `with_scope'
  ./features/step_definitions/web_steps.rb:36:in `/^(.*) within (.*[^:])$/'
  features/view_tasks.feature:13:in `Then I should see &quot;Master Backbone&quot; \\
  within the tasks list'</code></pre>
<p>A common mis-step when testing Rails apps with our structure is seeing false positives in bootstrapped data. Consider that, if we had just written the step <code>Then I should see &quot;Master Backbone&quot;</code> instead of scoping it with <code>within the tasks list</code>, then some test drivers would count the JSON that is used to bootstrap Backbone collections as visible text on the page, and the test would pass without us actually rendering the text to the page.</p>
<p>Since this we are doing outside-in development and testing for user interface, we will need to outline the UI first. To do this, first we'll need a page to host our code. Let's create and route a Rails <code>TasksController</code>. We'll bootstrap the Backbone app on <code>tasks#index</code>.</p>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="co"># config/routes.rb</span>
<span class="dt">ExampleApp</span>::<span class="dt">Application</span>.routes.draw <span class="kw">do</span>
  resources <span class="st">:tasks</span>, <span class="st">:only</span> =&gt; [<span class="st">:show</span>, <span class="st">:create</span>, <span class="st">:update</span>, <span class="st">:index</span>] <span class="kw">do</span>
    resources <span class="st">:attachments</span>, <span class="st">:only</span> =&gt; [<span class="st">:show</span>, <span class="st">:create</span>]
  <span class="kw">end</span>

  root <span class="st">:to</span> =&gt; <span class="st">'tasks#index'</span>
<span class="kw">end</span></code></pre>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="co"># app/controllers/tasks_controller.rb</span>
<span class="kw">class</span> <span class="dt">TasksController</span> &lt; <span class="dt">ApplicationController</span>
  before_filter <span class="st">:authorize</span>
  respond_to <span class="st">:html</span>, <span class="st">:json</span>

  wrap_parameters <span class="st">:task</span>, <span class="st">:include</span> =&gt; [<span class="st">:assignments_attributes</span>, <span class="st">:title</span>, <span class="st">:complete</span>]

  <span class="kw">def</span> index
    <span class="ot">@tasks</span> = tasks_visible_to_current_user
    <span class="ot">@users</span> = user_id_and_email_attributes
  <span class="kw">end</span>

  <span class="kw">def</span> show
    <span class="ot">@task</span> = current_user.tasks.find(params[<span class="st">:id</span>])
  <span class="kw">end</span>

  <span class="kw">def</span> create
    respond_with(current_user.tasks.create(params[<span class="st">:task</span>]))
  <span class="kw">end</span>

  <span class="kw">def</span> update
    task = current_user.tasks.find(params[<span class="st">:id</span>])
    task.update_attributes(params[<span class="st">:task</span>])
    respond_with(task)
  <span class="kw">end</span>

  <span class="kw">private</span>

  <span class="kw">def</span> user_id_and_email_attributes
    <span class="dt">User</span>.all.map { |user| { <span class="st">:id</span> =&gt; user.id, <span class="st">:email</span> =&gt; user.email } }
  <span class="kw">end</span>

  <span class="kw">def</span> tasks_visible_to_current_user
    (current_user.tasks + current_user.assigned_tasks).uniq
  <span class="kw">end</span>
<span class="kw">end</span></code></pre>
<p>To render our tasks, we'll want a TasksIndex Backbone view class. But before we write this class, we'll motivate it with a Jasmine isolation spec:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// spec/javascripts/views/tasks_index_spec.js</span>
<span class="fu">describe</span>(<span class="st">&quot;ExampleApp.Views.TasksIndex&quot;</span>, <span class="kw">function</span>() {
  <span class="fu">it</span>(<span class="st">&quot;renders a task table&quot;</span>, <span class="kw">function</span>() {
    <span class="kw">var</span> view = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Views</span>.<span class="fu">TasksIndex</span>();
    <span class="ot">view</span>.<span class="fu">render</span>();

    <span class="fu">expect</span>(<span class="ot">view</span>.<span class="fu">$el</span>).<span class="fu">toBe</span>(<span class="st">&quot;#tasks&quot;</span>);
    <span class="fu">expect</span>(<span class="ot">view</span>.<span class="fu">$el</span>).<span class="fu">toContain</span>(<span class="st">&quot;table&quot;</span>);
  });
});</code></pre>
<p>We use the <a href="https://github.com/velesin/jasmine-jquery">jasmine-jquery</a> library to provide DOM matchers for Jasmine like <code>toContain()</code>.</p>
<p>To run the Jasmine spec, run <code>bundle exec rake jasmine</code> and visit http://localhost:8888.</p>
<p>To make this test pass, we'll add a small template and make the <code>TasksIndex</code> view render it:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// app/assets/javascripts/views/tasks_index.js</span>
<span class="ot">ExampleApp</span>.<span class="ot">Views</span>.<span class="fu">TasksIndex</span> = <span class="ot">Backbone</span>.<span class="ot">View</span>.<span class="fu">extend</span>({
  <span class="dt">tagName</span>: <span class="st">'div'</span>,
  <span class="dt">id</span>: <span class="st">'tasks'</span>,

  <span class="dt">initialize</span>: <span class="kw">function</span>() {
  },

  <span class="dt">render</span>: <span class="kw">function</span> () {
    <span class="kw">this</span>.<span class="ot">$el</span>.<span class="fu">html</span>(JST[<span class="st">'tasks/index'</span>]({}));
    <span class="kw">return</span> <span class="kw">this</span>;
  }
});</code></pre>
<p>The <code>app/assets/templates/tasks/index.jst.ejs</code> template:</p>
<pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;table&gt;&lt;/table&gt;</span></code></pre>
<p>Now our Jasmine specs pass:</p>
<figure>
<img src="data:image/png;base64,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" alt="Passing Jasmine spec" /><figcaption>Passing Jasmine spec</figcaption>
</figure>
<p>Since the Jasmine specs pass, we'll pop back up a level and run the Cucumber story. Running it again, the failure is slightly different. The <code>&quot;#tasks table&quot;</code> element is present on the page, but doesn't contain the content we want:</p>
<pre class="text"><code>@javascript
Scenario: View tasks
  Given the following tasks exist:
    | Title                                |
    | Purchase the Backbone on Rails ebook |
    | Master Backbone                      |
  And I am on the home page
  Then I should see &quot;Master Backbone&quot; within the tasks list
    expected there to be content &quot;Master Backbone&quot; in &quot;Title Completed&quot; \\
(RSpec::Expectations::ExpectationNotMetError)
    ./features/step_definitions/web_steps.rb:107:in \\
`/^(?:|I )should see &quot;([^&quot;]*)&quot;$/'
    features/view_tasks.feature:13:in `Then I should see &quot;Master Backbone&quot; \\
within the tasks list'</code></pre>
<p>Drop back down to Jasmine and write a spec motivating the <code>TasksIndex</code> view to accept a collection and render it. We'll rewrite our existing spec, since we are changing the <code>TasksIndex</code> interface to require that a collection be passed in:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"># spec/javascripts/views/<span class="ot">tasks_index_spec</span>.<span class="fu">js</span>
<span class="co">//= require application</span>

<span class="fu">describe</span>(<span class="st">&quot;ExampleApp.Views.TasksIndex&quot;</span>, <span class="kw">function</span>() {
  <span class="fu">it</span>(<span class="st">&quot;renders a collection of tasks&quot;</span>, <span class="kw">function</span>() {
    <span class="kw">var</span> tasksCollection = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Collections</span>.<span class="fu">Tasks</span>();
    <span class="ot">_</span>.<span class="fu">extend</span>(tasksCollection, FilterableCollectionMixin);
    <span class="ot">tasksCollection</span>.<span class="fu">reset</span>([
      { <span class="dt">title</span>: <span class="st">&quot;Wake up&quot;</span> },
      { <span class="dt">title</span>: <span class="st">&quot;Brush your teeth&quot;</span> }
    ]);

    <span class="kw">var</span> view = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Views</span>.<span class="fu">TasksIndex</span>({<span class="dt">collection</span>: tasksCollection});
    <span class="kw">var</span> $el = <span class="fu">$</span>(<span class="ot">view</span>.<span class="fu">render</span>().<span class="fu">el</span>);

    <span class="fu">expect</span>($el).<span class="fu">toHaveText</span>(<span class="ot">/Wake up/</span>);
    <span class="fu">expect</span>($el).<span class="fu">toHaveText</span>(<span class="ot">/Brush your teeth/</span>);
  });
});</code></pre>
<p>This spec fails:</p>
<pre class="text"><code>1 spec, 1 failure in 0.008s
Finished at Thu Sep 22 2011 18:10:26 GMT-0400 (EDT)
ExampleApp.Views.TasksIndex
renders a collection of tasks
TypeError: undefined is not a function
TypeError: undefined is not a function
    at [object Object].&lt;anonymous&gt; \\
(http://localhost:8888/assets/views/tasks_index_spec.js?body=1:4:27)</code></pre>
<p>It's failing because we haven't defined <code>ExampleApp.Collections.Tasks</code> yet. We need to define a task model and tasks collection. We'll define the model:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"># app/assets/javascripts/models/<span class="ot">task</span>.<span class="fu">js</span>
<span class="ot">ExampleApp</span>.<span class="ot">Models</span>.<span class="fu">Task</span> = <span class="ot">Backbone</span>.<span class="ot">Model</span>.<span class="fu">extend</span>({
  <span class="dt">initialize</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="fu">on</span>(<span class="st">&quot;change:attachments&quot;</span>, <span class="kw">this</span>.<span class="fu">parseAttachments</span>);
    <span class="kw">this</span>.<span class="fu">parseAttachments</span>();

    <span class="kw">this</span>.<span class="fu">on</span>(<span class="st">&quot;change:assigned_users&quot;</span>, <span class="kw">this</span>.<span class="fu">parseAssignedUsers</span>);
    <span class="kw">this</span>.<span class="fu">parseAssignedUsers</span>();
  },

  <span class="dt">parseAttachments</span>: <span class="kw">function</span>() {
    <span class="kw">var</span> attachmentsAttr = <span class="kw">this</span>.<span class="fu">get</span>(<span class="st">'attachments'</span>);
    <span class="kw">this</span>.<span class="fu">attachments</span> = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Collections</span>.<span class="fu">Attachments</span>(attachmentsAttr);
  },

  <span class="dt">parseAssignedUsers</span>: <span class="kw">function</span>() {
    <span class="kw">var</span> usersAttr = <span class="kw">this</span>.<span class="fu">get</span>(<span class="st">'assigned_users'</span>);
    <span class="kw">this</span>.<span class="fu">assignedUsers</span> = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Collections</span>.<span class="fu">Users</span>(usersAttr);
  },

  <span class="dt">urlRoot</span>: <span class="st">'/tasks'</span>,

  <span class="dt">isComplete</span>: <span class="kw">function</span>() {
    <span class="kw">return</span> <span class="kw">this</span>.<span class="fu">get</span>(<span class="st">'complete'</span>);
  },

  <span class="dt">toJSON</span>: <span class="kw">function</span>() {
    <span class="kw">var</span> json = <span class="ot">_</span>.<span class="fu">clone</span>(<span class="kw">this</span>.<span class="fu">attributes</span>);
    <span class="ot">json</span>.<span class="fu">assignments_attributes</span> = <span class="kw">this</span>.<span class="ot">assignedUsers</span>.<span class="fu">map</span>(<span class="kw">function</span>(user) {
      <span class="kw">return</span> { <span class="dt">user_id</span>: <span class="ot">user</span>.<span class="fu">id</span> };
    });
    <span class="kw">return</span> json;
  }
});</code></pre>
<p>...write a test to motivate the collection:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"># spec/javascripts/collections/<span class="ot">tasks_spec</span>.<span class="fu">js</span>
<span class="fu">describe</span>(<span class="st">&quot;ExampleApp.Collections.Tasks&quot;</span>, <span class="kw">function</span>() {
  <span class="fu">it</span>(<span class="st">&quot;contains instances of ExampleApp.Models.Task&quot;</span>, <span class="kw">function</span>() {
    <span class="kw">var</span> collection = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Collections</span>.<span class="fu">Tasks</span>();
    <span class="fu">expect</span>(<span class="ot">collection</span>.<span class="fu">model</span>).<span class="fu">toEqual</span>(<span class="ot">ExampleApp</span>.<span class="ot">Models</span>.<span class="fu">Task</span>);
  });

  <span class="fu">it</span>(<span class="st">&quot;is persisted at /tasks&quot;</span>, <span class="kw">function</span>() {
    <span class="kw">var</span> collection = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Collections</span>.<span class="fu">Tasks</span>();
    <span class="fu">expect</span>(<span class="ot">collection</span>.<span class="fu">url</span>).<span class="fu">toEqual</span>(<span class="st">&quot;/tasks&quot;</span>);
  });
});</code></pre>
<p>...and pass the test by implementing the collection:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"># app/assets/javascripts/collections/<span class="ot">tasks</span>.<span class="fu">js</span>
<span class="ot">ExampleApp</span>.<span class="ot">Collections</span>.<span class="fu">Tasks</span> = <span class="ot">Backbone</span>.<span class="ot">Collection</span>.<span class="fu">extend</span>({ 
  <span class="dt">model</span>: <span class="ot">ExampleApp</span>.<span class="ot">Models</span>.<span class="fu">Task</span>, 
  <span class="dt">url</span>: <span class="st">'/tasks'</span>
});</code></pre>
<p>Running the Jasmine specs again, we're making progress. The <code>TasksIndex</code> view is accepting a collection of tasks, and now we have to render it:</p>
<pre class="text"><code>Expected '&lt;div id=&quot;tasks&quot;&gt;&lt;table&gt; &lt;tbody&gt;&lt;tr&gt; &lt;th&gt;Title&lt;/th&gt; \\
&lt;th&gt;Completed&lt;/th&gt; &lt;/tr&gt; &lt;/tbody&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;/table&gt; &lt;/div&gt;' to \\
have text 'Wake up'.</code></pre>
<p>The simplest thing we can do to get the spec passing is to pass the <code>tasks</code> collection into the template, and iterate over it there:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"># app/assets/javascripts/views/<span class="ot">tasks_index</span>.<span class="fu">js</span>
<span class="ot">ExampleApp</span>.<span class="ot">Views</span>.<span class="fu">TasksIndex</span> = <span class="ot">Support</span>.<span class="ot">CompositeView</span>.<span class="fu">extend</span>({
  <span class="dt">initialize</span>: <span class="kw">function</span>() {
    <span class="ot">_</span>.<span class="fu">bindAll</span>(<span class="kw">this</span>, <span class="st">&quot;render&quot;</span>);

    <span class="kw">this</span>.<span class="fu">taskSearch</span> = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="fu">TaskSearch</span>(<span class="kw">this</span>.<span class="fu">collection</span>);
    <span class="kw">this</span>.<span class="fu">bindTo</span>(<span class="kw">this</span>.<span class="ot">taskSearch</span>.<span class="fu">filteredCollection</span>, <span class="st">&quot;add&quot;</span>, <span class="kw">this</span>.<span class="fu">renderTasks</span>);
    <span class="kw">this</span>.<span class="fu">bindTo</span>(<span class="kw">this</span>.<span class="ot">taskSearch</span>.<span class="fu">filteredCollection</span>, <span class="st">&quot;remove&quot;</span>, <span class="kw">this</span>.<span class="fu">renderTasks</span>);
    <span class="kw">this</span>.<span class="fu">bindTo</span>(<span class="kw">this</span>.<span class="ot">taskSearch</span>.<span class="fu">filteredCollection</span>, <span class="st">&quot;reset&quot;</span>, <span class="kw">this</span>.<span class="fu">renderTasks</span>);
  },

  <span class="dt">render</span>: <span class="kw">function</span> () {
    <span class="kw">this</span>.<span class="fu">renderTemplate</span>();
    <span class="kw">this</span>.<span class="fu">attachVisualSearch</span>();
    <span class="kw">this</span>.<span class="fu">renderTasks</span>();
    <span class="kw">return</span> <span class="kw">this</span>;
  },

  <span class="dt">renderTemplate</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="ot">$el</span>.<span class="fu">html</span>(JST[<span class="st">'tasks/index'</span>]({ <span class="dt">tasks</span>: <span class="kw">this</span>.<span class="fu">collection</span> }));
  },

  <span class="dt">attachVisualSearch</span>: <span class="kw">function</span>() {
    <span class="kw">this</span>.<span class="ot">taskSearch</span>.<span class="fu">attach</span>(<span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'.visual-search'</span>));
  },

  <span class="dt">renderTasks</span>: <span class="kw">function</span>() {
    <span class="kw">var</span> self = <span class="kw">this</span>;
    <span class="ot">self</span>.<span class="fu">$</span>(<span class="st">'tbody'</span>).<span class="fu">empty</span>();

    <span class="kw">this</span>.<span class="ot">taskSearch</span>.<span class="ot">filteredCollection</span>.<span class="fu">each</span>(<span class="kw">function</span>(task) {
      <span class="kw">var</span> row = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Views</span>.<span class="fu">TaskItem</span>({ <span class="dt">model</span>: task });
      <span class="ot">self</span>.<span class="fu">renderChild</span>(row);
      <span class="ot">self</span>.<span class="fu">$</span>(<span class="st">'tbody'</span>).<span class="fu">append</span>(<span class="ot">row</span>.<span class="fu">el</span>);
    });
  }
});</code></pre>
<pre><code># app/assets/templates/tasks/index.jst.ejs
&lt;div class=&quot;visual-search&quot;&gt;&lt;/div&gt;

&lt;table id=&quot;tasks-list&quot;&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Title&lt;/th&gt;
      &lt;th&gt;Assignees&lt;/th&gt;
      &lt;th&gt;Completed&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;a class=&quot;create&quot; href=&quot;#new&quot;&gt;Add task&lt;/a&gt;</code></pre>
<p>Now, Jasmine passes, but the Cucumber story is still failing:</p>
<pre class="text"><code>Then I should see &quot;Master Backbone&quot; within the tasks list
Unable to find css &quot;#tasks table&quot; (Capybara::ElementNotFound)</code></pre>
<p>This is because the Jasmine spec is an isolation spec, and verifies that the <code>TasksIndex</code> view works in isolation. There is additional code we need to write to hook up the data in the Rails test database to the Backbone view. Adding this code to bootstrap the Backbone application should wrap up our exercise and get the tests passing.</p>
<p>We'll motivate writing a top-level Backbone application object with a spec. Note the use of a <code>sinon.spy</code> for verifying the router instantiation:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"># spec/javascripts/<span class="ot">example_app_spec</span>.<span class="fu">js</span>
<span class="fu">describe</span>(<span class="st">&quot;ExampleApp&quot;</span>, <span class="kw">function</span>(){
  <span class="fu">it</span>(<span class="st">&quot;has a namespace for Models&quot;</span>, <span class="kw">function</span>() {
    <span class="fu">expect</span>(<span class="ot">ExampleApp</span>.<span class="fu">Models</span>).<span class="fu">toBeTruthy</span>();
  });

  <span class="fu">it</span>(<span class="st">&quot;has a namespace for Collections&quot;</span>, <span class="kw">function</span>() {
    <span class="fu">expect</span>(<span class="ot">ExampleApp</span>.<span class="fu">Collections</span>).<span class="fu">toBeTruthy</span>();
  });

  <span class="fu">it</span>(<span class="st">&quot;has a namespace for Views&quot;</span>, <span class="kw">function</span>() {
    <span class="fu">expect</span>(<span class="ot">ExampleApp</span>.<span class="fu">Views</span>).<span class="fu">toBeTruthy</span>();
  });

  <span class="fu">it</span>(<span class="st">&quot;has a namespace for Routers&quot;</span>, <span class="kw">function</span>() {
    <span class="fu">expect</span>(<span class="ot">ExampleApp</span>.<span class="fu">Routers</span>).<span class="fu">toBeTruthy</span>();
  });

  <span class="fu">describe</span>(<span class="st">&quot;initialize()&quot;</span>, <span class="kw">function</span>() {
    <span class="fu">it</span>(<span class="st">&quot;accepts data JSON and instantiates a collection from it&quot;</span>, <span class="kw">function</span>() {
      <span class="kw">var</span> data = {
        <span class="st">&quot;tasks&quot;</span>: [{<span class="st">&quot;title&quot;</span>:<span class="st">&quot;thing to do&quot;</span>}, {<span class="st">&quot;title&quot;</span>:<span class="st">&quot;another thing&quot;</span>}],
        <span class="st">&quot;users&quot;</span>: [{<span class="st">&quot;id&quot;</span>:<span class="st">&quot;1&quot;</span>,<span class="st">&quot;email&quot;</span>:<span class="st">&quot;alice@example.com&quot;</span>}]
      };
      <span class="ot">ExampleApp</span>.<span class="fu">initialize</span>(data);

      <span class="fu">expect</span>(<span class="ot">ExampleApp</span>.<span class="fu">tasks</span>).<span class="ot">not</span>.<span class="fu">toEqual</span>(<span class="kw">undefined</span>);
      <span class="fu">expect</span>(<span class="ot">ExampleApp</span>.<span class="ot">tasks</span>.<span class="fu">length</span>).<span class="fu">toEqual</span>(<span class="dv">2</span>);
      <span class="fu">expect</span>(<span class="ot">ExampleApp</span>.<span class="ot">tasks</span>.<span class="fu">models</span>[<span class="dv">0</span>].<span class="fu">get</span>(<span class="st">'title'</span>)).<span class="fu">toEqual</span>(<span class="st">&quot;thing to do&quot;</span>);
      <span class="fu">expect</span>(<span class="ot">ExampleApp</span>.<span class="ot">tasks</span>.<span class="fu">models</span>[<span class="dv">1</span>].<span class="fu">get</span>(<span class="st">'title'</span>)).<span class="fu">toEqual</span>(<span class="st">&quot;another thing&quot;</span>);

      <span class="fu">expect</span>(<span class="ot">ExampleApp</span>.<span class="ot">users</span>.<span class="fu">length</span>).<span class="fu">toEqual</span>(<span class="dv">1</span>);
    });

    <span class="fu">it</span>(<span class="st">&quot;instantiates a Tasks router&quot;</span>, <span class="kw">function</span>() {
      <span class="ot">sinon</span>.<span class="fu">spy</span>(<span class="ot">ExampleApp</span>.<span class="fu">Routers</span>, <span class="st">'Tasks'</span>);
      <span class="ot">ExampleApp</span>.<span class="fu">initialize</span>({});
      <span class="fu">expect</span>(<span class="ot">ExampleApp</span>.<span class="ot">Routers</span>.<span class="fu">Tasks</span>).<span class="fu">toHaveBeenCalled</span>();
      <span class="ot">ExampleApp</span>.<span class="ot">Routers</span>.<span class="ot">Tasks</span>.<span class="fu">restore</span>();
    });

    <span class="fu">it</span>(<span class="st">&quot;starts Backbone.history&quot;</span>, <span class="kw">function</span>() {
      <span class="ot">Backbone</span>.<span class="ot">history</span>.<span class="fu">started</span> = <span class="kw">null</span>;
      <span class="ot">Backbone</span>.<span class="ot">history</span>.<span class="fu">stop</span>();
      <span class="ot">sinon</span>.<span class="fu">spy</span>(<span class="ot">Backbone</span>.<span class="fu">history</span>, <span class="st">'start'</span>);
      <span class="ot">ExampleApp</span>.<span class="fu">initialize</span>({});

      <span class="fu">expect</span>(<span class="ot">Backbone</span>.<span class="ot">history</span>.<span class="fu">start</span>).<span class="fu">toHaveBeenCalled</span>();

      <span class="ot">Backbone</span>.<span class="ot">history</span>.<span class="ot">start</span>.<span class="fu">restore</span>();
    });
  });
});</code></pre>
<p>Get it to green:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"># app/assets/javascripts/<span class="ot">example_app</span>.<span class="fu">js</span>
<span class="ot">window</span>.<span class="fu">ExampleApp</span> = {
  <span class="dt">Models</span>: {},
  <span class="dt">Collections</span>: {},
  <span class="dt">Views</span>: {},
  <span class="dt">Routers</span>: {},
  <span class="dt">initialize</span>: <span class="kw">function</span>(data) {
    <span class="kw">this</span>.<span class="fu">tasks</span> = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Collections</span>.<span class="fu">Tasks</span>(<span class="ot">data</span>.<span class="fu">tasks</span>);
    <span class="kw">this</span>.<span class="fu">users</span> = <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Collections</span>.<span class="fu">Users</span>(<span class="ot">data</span>.<span class="fu">users</span>);

    <span class="kw">new</span> <span class="ot">ExampleApp</span>.<span class="ot">Routers</span>.<span class="fu">Tasks</span>({ <span class="dt">collection</span>: <span class="kw">this</span>.<span class="fu">tasks</span>, <span class="dt">users</span>: <span class="kw">this</span>.<span class="fu">users</span> });
    <span class="kw">if</span> (!<span class="ot">Backbone</span>.<span class="ot">history</span>.<span class="fu">started</span>) {
      <span class="ot">Backbone</span>.<span class="ot">history</span>.<span class="fu">start</span>();
      <span class="ot">Backbone</span>.<span class="ot">history</span>.<span class="fu">started</span> = <span class="kw">true</span>;
    }
  }
};</code></pre>
<p>Then we bootstrap the app from the Rails view:</p>
<pre class="sourceCode rhtml"><code class="sourceCode rhtml"># app/views/tasks/index.html.erb
<span class="kw">&lt;h1&gt;</span>Tasks<span class="kw">&lt;/h1&gt;</span>

<span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">&quot;tasks&quot;</span><span class="kw">&gt;</span>
<span class="kw">&lt;/div&gt;</span>

<span class="kw">&lt;script</span><span class="ot"> type=</span><span class="st">&quot;text/json&quot;</span><span class="ot"> id=</span><span class="st">&quot;bootstrap&quot;</span><span class="kw">&gt;</span>
  {
    <span class="st">&quot;tasks&quot;</span>: &lt;%= @<span class="ot">tasks</span>.<span class="fu">to_json</span>(<span class="dt">include</span>: 
                                { <span class="dt">assigned_users</span>: { <span class="dt">only</span>: [:id, :email] } }) %&gt;,
    <span class="st">&quot;users&quot;</span>: &lt;%= @<span class="ot">users</span>.<span class="fu">to_json</span> %&gt;
  }
<span class="kw">&lt;/script&gt;</span>

<span class="kw">&lt;%=</span> content_for <span class="st">:javascript</span> <span class="kw">do</span> <span class="kw">-%&gt;</span>
  <span class="kw">&lt;script</span><span class="ot"> type=</span><span class="st">&quot;text/javascript&quot;</span><span class="kw">&gt;</span>
<span class="er">    $(function () {</span>
<span class="er">      var div = $('&lt;div&gt;&lt;/div&gt;');</span>
<span class="er">      div.html($('#bootstrap').text());</span>
<span class="er">      var data = JSON.parse(div.text());</span>

<span class="er">      ExampleApp.initialize(data);</span>
    });
  <span class="kw">&lt;/script&gt;</span>
<span class="kw">&lt;%</span> <span class="kw">end</span> <span class="kw">%&gt;</span></code></pre>
<p>And the integration test passes!</p>
<pre class="text"><code>Feature: Viewing Tasks
  As a user
  So that I can see what I have to do
  I want to be able to see all my tasks

  @javascript
  Scenario: View tasks
    Given the following tasks exist:
      | Title                                |
      | Purchase the Backbone on Rails ebook |
      | Master Backbone                      |
    And I am on the home page
    Then I should see &quot;Master Backbone&quot; within the tasks list
    And I should see &quot;Purchase the Backbone on Rails ebook&quot; within the tasks list

1 scenario (1 passed)
5 steps (5 passed)</code></pre>
<p></p>
</section>
</section>
</section>
<section id="security" class="level1">
<h1><a href="#security">Security</a></h1>
<section id="encoding-data-when-bootstrapping-json-data" class="level2">
<h2><a href="#encoding-data-when-bootstrapping-json-data">Encoding data when bootstrapping JSON data</a></h2>
<p>As it turns out, bootstrapping JSON data in your ERB templates can introduce a security vulnerability. Consider the case when a user enters a malicious <code>&lt;script&gt;</code> as the title of a task. When the <code>tasks#index</code> page is reloaded, and we naively bootstrap task data on the page, the browser will interpret and execute the script. Since it's possible for this script to run on another user's session, it can be quite damaging if it goes on to, for example, edit or destroy the user's data.</p>
<p>To protect against this, we make use of the fact that on HTML5 documents, script tags that do not have a type of <code>text/javascript</code> won't be automatically evaluated by the browser. Therefore, we can create an element with the HTML-encoded bootstrapped data enclosed in a script of type <code>text/json</code>, fetch it using a simple jquery selector, and parse it ourselves.</p>
<p>Here's an example:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript">&lt;script type=<span class="st">&quot;text/json&quot;</span> id=<span class="st">&quot;bootstrap&quot;</span>&gt;
  { <span class="st">&quot;tasks&quot;</span>: &lt;%= @<span class="ot">tasks</span>.<span class="fu">to_json</span> %&gt; }
&lt;<span class="ot">/script&gt;</span>

<span class="ot">&lt;script type=&quot;text/javascript</span><span class="st">&quot;&gt;</span>
  <span class="fu">$</span>(<span class="kw">function</span> () {
    <span class="kw">var</span> div, data;

    div = <span class="fu">$</span>(<span class="st">'&lt;div&gt;&lt;/div&gt;'</span>);
    <span class="ot">div</span>.<span class="fu">html</span>(<span class="fu">$</span>(<span class="st">'#bootstrap'</span>).<span class="fu">text</span>());

    data = <span class="ot">JSON</span>.<span class="fu">parse</span>(<span class="ot">div</span>.<span class="fu">text</span>());

    <span class="ot">ExampleApp</span>.<span class="fu">initialize</span>(data);
  });
&lt;<span class="ot">/script&gt;</span></code></pre>
<p>A reliable way to unencode the HTML-encoded JSON string is to use the browser's native functionality by setting an element's <code>innerHTML</code>. So in the above script, we create a <code>json_div</code> var, assign its <code>innerHTML</code> to the bootstrap script's text, and retrieve the innerText back out, unencoded. The final result is the <code>data</code> variable containing proper JSON with no HTML escaping that can be parsed and passed along to your app's <code>initialize</code> function.</p>
<p>This approach can be seen on the example app on the <code>app/views/tasks/index.html.erb</code> template.</p>
<p>Now, the application's models, populated by the bootstrap data structure, contain raw data that is not HTML-escaped. When you render this data into the DOM, make sure you escape the HTML at that point:</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">// From app/assets/javascripts/views/task_item.js:</span>

<span class="kw">this</span>.<span class="fu">$</span>(<span class="st">'label'</span>).<span class="fu">html</span>(<span class="kw">this</span>.<span class="ot">model</span>.<span class="fu">escape</span>(<span class="st">'title'</span>)); <span class="co">// not model.get</span></code></pre>
</section>
</section>
<section id="application-structure" class="level1">
<h1><a href="#application-structure">Application Structure</a></h1>
<section id="structuring-larger-backbone-applications" class="level2">
<h2><a href="#structuring-larger-backbone-applications">Structuring larger Backbone applications</a></h2>
<p>One of the selling points of Backbone is how lightweight and non-prescriptive it is. This makes it easy to learn, and a quick win for adding some structure to client-side applications. However, as your application grows, most developers find benefit in additional structure in the form of support for typical nesting structures, event aggregation or buses, and conventions that help reduce boilerplate code and avoid resource leaks.</p>
<p>In this book, we have covered a couple of cases where establishing a layer of abstraction like CompositeView or SwappingRouter helps in these areas. As your application grows, you may find yourself refactoring the application to extract even more shared abstractions out for reuse. Or worse - you don't, and start to accumulate technical debt in the form of tightly coupled components that are difficult to pull apart for reuse, or perhaps a high degree of repetition in view code.</p>
<p>Some areas that you might consider using plugins or writing your own reusable classes to improve include:</p>
<ul>
<li>Conventions around view composition and layout management</li>
<li>Higher levels of abstraction for model and collection relationships</li>
<li>Convention-based construction of form markup from models</li>
<li>Single- or bi-directional binding of models to views</li>
<li>More finely-grained control over serialization, particularly for dates and times</li>
<li>Producing subset views of a collection, for filtering and sorting</li>
</ul>
<p>Another one of the selling points of Backbone is its rich ecosystem of addons and plugins. Several of these are worth reading about and employing in your own systems. There is a full list on <a href="https://github.com/documentcloud/backbone/wiki/Extensions,-Plugins,-Resources">the Backbone wiki</a>.</p>
</section>
</section>
<section class="footnotes">
<hr />
<ol>
<li id="fn1"><p>At least, we have a guarantee at the application level; database integrity and the possibility of skew between Rails models and DB content is another discussion entirely.<a href="#fnref1">↩</a></p></li>
</ol>
</section>
</body>
</html>
